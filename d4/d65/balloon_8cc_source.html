<!-- HTML header for doxygen 1.8.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=9"/>
    <meta name="generator" content="Doxygen 1.8.11"/>
    <title>ANITA Software: components/icemc/balloon.cc Source File</title>
    <link href="../../tabs.css" rel="stylesheet" type="text/css"/>
    <script type="text/javascript" src="../../jquery.js"></script>
    <script type="text/javascript" src="../../dynsections.js"></script>
    <link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
    <link href="../../doxygen.css" rel="stylesheet" type="text/css" />
    <link href="../../customdoxygen.css" rel="stylesheet" type="text/css"/>
  </head>
  <body>
    <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
      <div id="titlearea">
	<table cellspacing="0" cellpadding="0">
	  <tbody>	    
	    <tr style="height: 56px;">
	      <td id="projectlogo"><img width="960" alt="Logo" src="../../anitaSoftware.png"/></td>
	    </tr>
	  </tbody>
	</table>
      </div>
      <!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Introduction</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_409f97388efe006bc3438b95e9edef48.html">components</a></li><li class="navelem"><a class="el" href="../../dir_de1961011fa38df2c6d5e9e49bef1e29.html">icemc</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">balloon.cc</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &quot;TChain.h&quot;</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#include &quot;TFile.h&quot;</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &quot;Constants.h&quot;</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &quot;Settings.h&quot;</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &quot;earthmodel.hh&quot;</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &quot;icemodel.hh&quot;</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &quot;vector.hh&quot;</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &quot;TF1.h&quot;</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &quot;TH1F.h&quot;</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &quot;TGraph.h&quot;</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &quot;TMath.h&quot;</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &quot;position.hh&quot;</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;anita.hh&quot;</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;ray.hh&quot;</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;balloon.hh&quot;</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;Settings.h&quot;</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;Primaries.h&quot;</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;EnvironmentVariable.h&quot;</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;icemc_random.h&quot;</span> </div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#if defined(ANITA_UTIL_EXISTS) and defined(VECTORIZE)</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;vectormath_trig.h&quot;</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="keyword">using</span> std::ifstream;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="keyword">const</span> <span class="keywordtype">string</span> ICEMC_SRC_DIR=<a class="code" href="../../d4/d7f/namespace_environment_variable.html#a064f876067320b15e34beb8c29c8ffdc">EnvironmentVariable::ICEMC_SRC_DIR</a>();</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="keyword">const</span> <span class="keywordtype">string</span> ICEMC_DATA_DIR=ICEMC_SRC_DIR+<span class="stringliteral">&quot;/data/&quot;</span>;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="keyword">const</span> <span class="keywordtype">string</span> anitaliteflight=ICEMC_DATA_DIR+<span class="stringliteral">&quot;/BalloonGPS.txt&quot;</span>; <span class="comment">// the gps path of the anita-lite flight</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="keyword">const</span> <span class="keywordtype">string</span> anitaflight=ICEMC_DATA_DIR+<span class="stringliteral">&quot;/anitagps.txt&quot;</span>;<span class="comment">// gps path of anita flight</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;Balloon::Balloon() {</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <a class="code" href="../../d2/d24/class_balloon.html#a96a9419e73f0188979bdec29c4597d67">MAXHORIZON</a>=800000.;                <span class="comment">// pick the interaction within this distance from the balloon so that it is within the horizon</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  ibnposition=0;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <a class="code" href="../../d2/d24/class_balloon.html#a4067df26bb03b68f35e99d9012e67525">igps</a>=0;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <a class="code" href="../../d2/d24/class_balloon.html#aa66ff5dc8a3812aaf4e18300021adc15">horizcoord_bn</a>=0; <span class="comment">// x component of balloon position</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <a class="code" href="../../d2/d24/class_balloon.html#a8dff2cae99ba8661c69438e604aebe00">vertcoord_bn</a>=0; <span class="comment">// y component of balloon position</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <a class="code" href="../../d2/d24/class_balloon.html#a3fb3960c3971912072c734c3df055f87">BN_LONGITUDE</a>=999; <span class="comment">//balloon longitude for fixed balloon location</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <a class="code" href="../../d2/d24/class_balloon.html#a51eebf6b41e338b52dff8844dff87d56">BN_LATITUDE</a>=999; <span class="comment">//balloon latitude for fixed balloon location</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;}</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div><div class="line"><a name="l00046"></a><span class="lineno"><a class="line" href="../../d2/d24/class_balloon.html#ace5f5d47d1e1c7842db8076f492d6fcf">   46</a></span>&#160;<span class="keywordtype">void</span>  <a class="code" href="../../d2/d24/class_balloon.html#ace5f5d47d1e1c7842db8076f492d6fcf">Balloon::setObservationLocation</a>(<a class="code" href="../../d3/d8e/class_interaction.html">Interaction</a> *interaction1,<span class="keywordtype">int</span> inu,<a class="code" href="../../de/d63/class_ice_model.html">IceModel</a> *antarctica,<a class="code" href="../../db/d2b/class_settings.html">Settings</a> *settings1) {</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  interaction1-&gt;<a class="code" href="../../d3/d8e/class_interaction.html#a97f88ca0a1c9e906203aa5ce618221e0">banana_volts</a> = 0; <span class="comment">//Zero the variable</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  interaction1-&gt;<a class="code" href="../../d3/d8e/class_interaction.html#acedcf047fba72945f603c907294352a8">banana_obs</a> = <a class="code" href="../../d5/db2/class_vector.html">Vector</a>(0,0,<a class="code" href="../../d3/d8e/class_interaction.html#a8f9f2b7b7495ddf5218ebfdb9bbb053e">Interaction::banana_observation_distance</a>);</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    </div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <span class="comment">// First pick theta of the obs vector from nu vector</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  interaction1-&gt;banana_theta_obs = -0.5*PI/settings1-&gt;vertical_banana_points * ((int)(inu/settings1-&gt;horizontal_banana_points));</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  interaction1-&gt;banana_phi_obs = 2*PI/settings1-&gt;horizontal_banana_points * (inu%settings1-&gt;horizontal_banana_points);</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  interaction1-&gt;<a class="code" href="../../d3/d8e/class_interaction.html#a645204fe8e7608c32ddaaa23069fa017">banana_weight</a> = (double)fabs(sin(interaction1-&gt;banana_theta_obs)); <span class="comment">//Set &quot;weight&quot; - purely a phase factor</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  interaction1-&gt;<a class="code" href="../../d3/d8e/class_interaction.html#acedcf047fba72945f603c907294352a8">banana_obs</a> = interaction1-&gt;<a class="code" href="../../d3/d8e/class_interaction.html#acedcf047fba72945f603c907294352a8">banana_obs</a>.RotateY(interaction1-&gt;banana_theta_obs);</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    </div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="comment">// Now the phi of the obs vector relative to the nu vector</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  interaction1-&gt;<a class="code" href="../../d3/d8e/class_interaction.html#acedcf047fba72945f603c907294352a8">banana_obs</a> = interaction1-&gt;<a class="code" href="../../d3/d8e/class_interaction.html#acedcf047fba72945f603c907294352a8">banana_obs</a>.RotateZ(interaction1-&gt;banana_phi_obs);</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    </div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <span class="comment">// Finally rotate the obs vector to the nu vector&#39;s orientation (change coordinate systems, in effect)</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  interaction1-&gt;<a class="code" href="../../d3/d8e/class_interaction.html#acedcf047fba72945f603c907294352a8">banana_obs</a> = interaction1-&gt;<a class="code" href="../../d3/d8e/class_interaction.html#acedcf047fba72945f603c907294352a8">banana_obs</a>.RotateY(PI-<a class="code" href="../../d3/d8e/class_interaction.html#a9c96b836f1c5df216eebc4021a041e83">Interaction::theta_nu_banana</a>);</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  interaction1-&gt;<a class="code" href="../../d3/d8e/class_interaction.html#acedcf047fba72945f603c907294352a8">banana_obs</a> = interaction1-&gt;<a class="code" href="../../d3/d8e/class_interaction.html#acedcf047fba72945f603c907294352a8">banana_obs</a>.RotateZ(<a class="code" href="../../d3/d8e/class_interaction.html#adcd5f9195ba605c86eaa83f216088bf2">Interaction::phi_nu_banana</a>);</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    </div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <span class="comment">//Finally, set the balloon position to the location which we would like to observe</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <a class="code" href="../../d2/d24/class_balloon.html#a69f284427712f451a4c1c3756f168093">r_bn</a> = interaction1-&gt;<a class="code" href="../../d3/d8e/class_interaction.html#a1e6c2d93ac3db39b513394477c69aafb">nu_banana_surface</a> + interaction1-&gt;<a class="code" href="../../d3/d8e/class_interaction.html#acedcf047fba72945f603c907294352a8">banana_obs</a>;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    </div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  theta_bn = <a class="code" href="../../d2/d24/class_balloon.html#a69f284427712f451a4c1c3756f168093">r_bn</a>.Theta();</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <a class="code" href="../../d2/d24/class_balloon.html#a6bf058d1320831ad733db4c5f9ce3cbe">phi_bn</a> = <a class="code" href="../../d2/d24/class_balloon.html#a69f284427712f451a4c1c3756f168093">r_bn</a>.Phi();</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <a class="code" href="../../d2/d24/class_balloon.html#a82033268c70493ca7c6e850e82e8c49d">surface_under_balloon</a> = antarctica-&gt;Surface(<a class="code" href="../../d2/d24/class_balloon.html#a69f284427712f451a4c1c3756f168093">r_bn</a>);</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <span class="comment">// position of balloon at earth&#39;s surface (the shadow it would cast with the sun overhead)</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <a class="code" href="../../d2/d24/class_balloon.html#ae5a88658b80b1f027e5fe28a9d8144e8">r_bn_shadow</a> = <a class="code" href="../../d2/d24/class_balloon.html#a82033268c70493ca7c6e850e82e8c49d">surface_under_balloon</a> * <a class="code" href="../../d2/d24/class_balloon.html#a69f284427712f451a4c1c3756f168093">r_bn</a>.Unit();</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  altitude_bn = <a class="code" href="../../d2/d24/class_balloon.html#a69f284427712f451a4c1c3756f168093">r_bn</a>.Mag() - <a class="code" href="../../d2/d24/class_balloon.html#a82033268c70493ca7c6e850e82e8c49d">surface_under_balloon</a>;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    </div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="comment">//Finished setting observation location</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;}</div><div class="line"><a name="l00075"></a><span class="lineno"><a class="line" href="../../d2/d24/class_balloon.html#a5a7672a44eb85d425909a268ab53fbff">   75</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d2/d24/class_balloon.html#a5a7672a44eb85d425909a268ab53fbff">Balloon::SetDefaultBalloonPosition</a>(<a class="code" href="../../de/d63/class_ice_model.html">IceModel</a> *antarctica1) { <span class="comment">// position of surface of earth under balloon</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    </div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="comment">// set the default balloon position</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <span class="comment">// if you are an Anita path, these get overwritten for each event</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <span class="comment">//cout &lt;&lt; &quot;BN_LATITUDE is &quot; &lt;&lt; BN_LATITUDE &lt;&lt; &quot;\n&quot;;</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <span class="comment">//cout &lt;&lt; &quot;BN_LONGITUDE is &quot; &lt;&lt; BN_LONGITUDE &lt;&lt; &quot;\n&quot;;</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    </div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <span class="keywordtype">int</span> BN_LATITUDE_SETTING = <a class="code" href="../../d2/d24/class_balloon.html#a51eebf6b41e338b52dff8844dff87d56">BN_LATITUDE</a>;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="keywordtype">int</span> BN_LONGITUDE_SETTING = <a class="code" href="../../d2/d24/class_balloon.html#a3fb3960c3971912072c734c3df055f87">BN_LONGITUDE</a>;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    </div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="keywordflow">if</span>(BN_LATITUDE_SETTING==999)</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    theta_bn=10*RADDEG; <span class="comment">// wrt south pole</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    theta_bn=(90-BN_LATITUDE_SETTING)*RADDEG;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    </div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="keywordflow">if</span>(BN_LONGITUDE_SETTING==999)</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <a class="code" href="../../d2/d24/class_balloon.html#a6bf058d1320831ad733db4c5f9ce3cbe">phi_bn</a>=PI/4; <span class="comment">//wrt 90E longitude</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <a class="code" href="../../d2/d24/class_balloon.html#a6bf058d1320831ad733db4c5f9ce3cbe">phi_bn</a>=EarthModel::LongtoPhi_0isPrimeMeridian(BN_LONGITUDE_SETTING); <span class="comment">//remember input of LongtoPhi is between -180 and 180</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    </div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    </div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <a class="code" href="../../d2/d24/class_balloon.html#a69f284427712f451a4c1c3756f168093">r_bn</a> = <a class="code" href="../../d7/d3b/class_position.html">Position</a>(theta_bn,<a class="code" href="../../d2/d24/class_balloon.html#a6bf058d1320831ad733db4c5f9ce3cbe">phi_bn</a>); <span class="comment">// direction of balloon- right now this is a unit vector</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    </div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d2/d24/class_balloon.html#aae0a6056476d43b3e44bc9ddf3d66afd">BN_ALTITUDE</a>==0) <span class="comment">// if the altitude isn&#39;t set in the input file</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    altitude_bn=37000.; <span class="comment">// 37000 m.</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    altitude_bn=<a class="code" href="../../d2/d24/class_balloon.html#aae0a6056476d43b3e44bc9ddf3d66afd">BN_ALTITUDE</a>; <span class="comment">// altitude in meters</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    </div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <a class="code" href="../../d2/d24/class_balloon.html#a82033268c70493ca7c6e850e82e8c49d">surface_under_balloon</a> = antarctica1-&gt;Surface(<a class="code" href="../../d2/d24/class_balloon.html#a69f284427712f451a4c1c3756f168093">r_bn</a>); <span class="comment">// distance between center of earth and surface under balloon</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    </div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <a class="code" href="../../d2/d24/class_balloon.html#ae5a88658b80b1f027e5fe28a9d8144e8">r_bn_shadow</a> = <a class="code" href="../../d2/d24/class_balloon.html#a82033268c70493ca7c6e850e82e8c49d">surface_under_balloon</a> * <a class="code" href="../../d2/d24/class_balloon.html#a69f284427712f451a4c1c3756f168093">r_bn</a>.Unit(); <span class="comment">// position of surface under balloon</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    </div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <a class="code" href="../../d2/d24/class_balloon.html#a69f284427712f451a4c1c3756f168093">r_bn</a> = (antarctica1-&gt;Geoid(<a class="code" href="../../d2/d24/class_balloon.html#a69f284427712f451a4c1c3756f168093">r_bn</a>)+altitude_bn) * <a class="code" href="../../d2/d24/class_balloon.html#a69f284427712f451a4c1c3756f168093">r_bn</a>; <span class="comment">// position of balloon</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    </div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;} <span class="comment">// set default balloon position</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div><div class="line"><a name="l00112"></a><span class="lineno"><a class="line" href="../../d2/d24/class_balloon.html#a538038f8fa2bfcb35677e30ac871f87a">  112</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d2/d24/class_balloon.html#a538038f8fa2bfcb35677e30ac871f87a">Balloon::ReadAnitaliteFlight</a>() {</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    </div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    </div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    </div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    </div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  ifstream flightfile(anitaliteflight.c_str()); <span class="comment">//set file to the right one</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <span class="keywordflow">if</span> (!flightfile) {</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;Flight file not found.\n&quot;</span>;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    exit(1);</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  }</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    </div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    </div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    </div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <span class="keywordtype">string</span> slatitude; <span class="comment">// latitude in string format</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <span class="keywordtype">string</span> slongitude; <span class="comment">//longitude in string format</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <span class="keywordtype">string</span> saltitude; <span class="comment">// altitude in string format</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <span class="keywordtype">string</span> sheading; <span class="comment">// heading in string format</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <span class="keywordtype">string</span> srealtime; <span class="comment">// real life unix time in string format</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <span class="keywordtype">string</span> junk; <span class="comment">// string not used for anything</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    </div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <span class="keywordtype">string</span> line; <span class="comment">// for reading a whole line</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <span class="keywordtype">double</span> latitude; <span class="comment">// same quantities as above but in double format</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <span class="keywordtype">double</span> longitude;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <span class="keywordtype">double</span> altitude;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <span class="keywordtype">double</span> heading;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <span class="keywordtype">double</span> realtime;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    </div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  getline(flightfile,junk); <span class="comment">// first few lines are junk</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  getline(flightfile,junk);</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  getline(flightfile,junk);</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  getline(flightfile,junk);</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    </div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <a class="code" href="../../d2/d24/class_balloon.html#aa11b7c8d8fca6acb9c5789a85974ad92">NPOINTS</a>=0; <span class="comment">// number of points we have for the flight path</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    </div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    </div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    </div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <span class="keywordflow">while</span> (!flightfile.eof()) {</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        </div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        </div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    flightfile &gt;&gt; srealtime &gt;&gt; junk &gt;&gt; slatitude &gt;&gt; slongitude &gt;&gt; saltitude &gt;&gt; sheading &gt;&gt; junk &gt;&gt; junk &gt;&gt; junk;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        </div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        </div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="comment">//cout &lt;&lt; &quot;they are &quot; &lt;&lt; NPOINTS &lt;&lt; &quot; &quot; &lt;&lt; srealtime &lt;&lt; &quot; &quot; &lt;&lt; junk &lt;&lt; &quot; &quot; &lt;&lt; slatitude &lt;&lt; &quot; &quot; &lt;&lt; slongitude &lt;&lt; &quot; &quot; &lt;&lt; saltitude &lt;&lt; &quot; &quot; &lt;&lt; sheading &lt;&lt; &quot;\n&quot;;</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="comment">//cout &lt;&lt; &quot;slatitude is &quot; &lt;&lt; slatitude &lt;&lt; &quot;\n&quot;;</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    latitude=(double)atof(slatitude.c_str());</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    longitude=(double)atof(slongitude.c_str());</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    altitude=(double)atof(saltitude.c_str());</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    heading=(double)atof(sheading.c_str());</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    realtime=(double)atof(srealtime.c_str());</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        </div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        </div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="comment">// latitude and longitude of each balloon position</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <a class="code" href="../../d2/d24/class_balloon.html#a89cfc8cfa44410227aba08d70cbfc2bd">latitude_bn_anitalite</a>[<a class="code" href="../../d2/d24/class_balloon.html#aa11b7c8d8fca6acb9c5789a85974ad92">NPOINTS</a>]=latitude;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <a class="code" href="../../d2/d24/class_balloon.html#a4bf2d1dbe9b6c6b98f3d507fa7d1002e">longitude_bn_anitalite</a>[<a class="code" href="../../d2/d24/class_balloon.html#aa11b7c8d8fca6acb9c5789a85974ad92">NPOINTS</a>]=longitude;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <a class="code" href="../../d2/d24/class_balloon.html#a356923e58f8c56224ff6995537146491">altitude_bn_anitalite</a>[<a class="code" href="../../d2/d24/class_balloon.html#aa11b7c8d8fca6acb9c5789a85974ad92">NPOINTS</a>]=altitude;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <a class="code" href="../../d2/d24/class_balloon.html#a1abf252a4e4d375db5821822c5225aea">heading_bn_anitalite</a>[<a class="code" href="../../d2/d24/class_balloon.html#aa11b7c8d8fca6acb9c5789a85974ad92">NPOINTS</a>]=heading;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <a class="code" href="../../d2/d24/class_balloon.html#a9f24af1ced17aa2d3ee33558e54d2d06">realtime_bn_anitalite</a>[<a class="code" href="../../d2/d24/class_balloon.html#aa11b7c8d8fca6acb9c5789a85974ad92">NPOINTS</a>]=realtime;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        </div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        </div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <a class="code" href="../../d2/d24/class_balloon.html#aa11b7c8d8fca6acb9c5789a85974ad92">NPOINTS</a>++;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        </div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        </div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="comment">//    cout &lt;&lt; &quot;NPOINTS, altitude are &quot; &lt;&lt; NPOINTS &lt;&lt; &quot; &quot; &lt;&lt; altitude &lt;&lt; &quot;\n&quot;;</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        </div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    getline(flightfile,junk);</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        </div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  }<span class="comment">//while</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    </div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    </div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    </div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  NPOINTS_MAX=<a class="code" href="../../d2/d24/class_balloon.html#aa11b7c8d8fca6acb9c5789a85974ad92">NPOINTS</a>-140; <span class="comment">// exclude the fall</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <a class="code" href="../../d2/d24/class_balloon.html#a83af0cc214fdafe44fd492d7dbbaca51">NPOINTS_MIN</a>=0;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    </div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    </div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    </div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;}<span class="comment">//ReadAnitaliteFlight</span></div><div class="line"><a name="l00188"></a><span class="lineno"><a class="line" href="../../d2/d24/class_balloon.html#a1ddbf318da23992fe38ab54c80c45d84">  188</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d2/d24/class_balloon.html#a1ddbf318da23992fe38ab54c80c45d84">Balloon::InitializeBalloon</a>() {</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    </div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    </div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  <span class="comment">// GPS positions of Anita or Anita-lite balloon flight</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d2/d24/class_balloon.html#a81c68a6d332881cf4759a4bcca7dc48c">WHICHPATH</a>==2)</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <a class="code" href="../../d2/d24/class_balloon.html#a538038f8fa2bfcb35677e30ac871f87a">ReadAnitaliteFlight</a>();</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    </div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    </div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  <a class="code" href="../../d2/d24/class_balloon.html#afa3d16030232d03d5986d340b8f562c2">MINALTITUDE</a>=30000; <span class="comment">// balloon has to be 30 km altitude at least for us to read the event from the flight data file</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    </div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <span class="comment">// initialisation of igps_previous</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d2/d24/class_balloon.html#a81c68a6d332881cf4759a4bcca7dc48c">WHICHPATH</a>==6 || <a class="code" href="../../d2/d24/class_balloon.html#a81c68a6d332881cf4759a4bcca7dc48c">WHICHPATH</a>==7 || <a class="code" href="../../d2/d24/class_balloon.html#a81c68a6d332881cf4759a4bcca7dc48c">WHICHPATH</a>==8 || <a class="code" href="../../d2/d24/class_balloon.html#a81c68a6d332881cf4759a4bcca7dc48c">WHICHPATH</a>==9)</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <a class="code" href="../../d2/d24/class_balloon.html#a3a090dc24bdfdf84bdddc308de7d20e0">igps_previous</a>=0; <span class="comment">// which entry from the flight data file the previous event was</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d2/d24/class_balloon.html#a81c68a6d332881cf4759a4bcca7dc48c">WHICHPATH</a>==2)</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <a class="code" href="../../d2/d24/class_balloon.html#a3a090dc24bdfdf84bdddc308de7d20e0">igps_previous</a>=<a class="code" href="../../d2/d24/class_balloon.html#a83af0cc214fdafe44fd492d7dbbaca51">NPOINTS_MIN</a>; <span class="comment">// initialise here to avoid times during launch</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    </div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  flightdatachain = 0; </div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  <span class="comment">// This for Anita 1 flight</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d2/d24/class_balloon.html#a81c68a6d332881cf4759a4bcca7dc48c">WHICHPATH</a>==6) {</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        </div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    flightdatachain = <span class="keyword">new</span> TChain(<span class="stringliteral">&quot;foricemc&quot;</span>);</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    flightdatachain-&gt;Add((ICEMC_DATA_DIR+<span class="stringliteral">&quot;/anita1flightdata.root&quot;</span>).c_str());</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        </div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    flightdatachain-&gt;SetBranchAddress(<span class="stringliteral">&quot;surfTrigBandMask&quot;</span>,<a class="code" href="../../d2/d24/class_balloon.html#a155811c7b07a72024a4c21ece1aa311c">surfTrigBandMask</a>);</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    flightdatachain-&gt;SetBranchAddress(<span class="stringliteral">&quot;powerthresh&quot;</span>,<a class="code" href="../../d2/d24/class_balloon.html#ab961c4c09983ae291b1feedb1f98b786">powerthresh</a>);</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    flightdatachain-&gt;SetBranchAddress(<span class="stringliteral">&quot;meanp&quot;</span>,<a class="code" href="../../d2/d24/class_balloon.html#a83699275fd0ec62469cfcde3d5f0656d">meanp</a>);</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    flightdatachain-&gt;SetBranchAddress(<span class="stringliteral">&quot;longitude&quot;</span>,&amp;flongitude);</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    flightdatachain-&gt;SetBranchAddress(<span class="stringliteral">&quot;latitude&quot;</span>,&amp;flatitude);</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    flightdatachain-&gt;SetBranchAddress(<span class="stringliteral">&quot;altitude&quot;</span>,&amp;faltitude);</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    flightdatachain-&gt;SetBranchAddress(<span class="stringliteral">&quot;realTime_surfhk&quot;</span>,&amp;<a class="code" href="../../d2/d24/class_balloon.html#aefb79f91cdee782d62e724b2c50c64b2">realTime_flightdata</a>);</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    flightdatachain-&gt;SetBranchAddress(<span class="stringliteral">&quot;heading&quot;</span>,&amp;fheading);</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  }</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    </div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  <span class="comment">// This for Anita 2 flight</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d2/d24/class_balloon.html#a81c68a6d332881cf4759a4bcca7dc48c">WHICHPATH</a>==7) {</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        </div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    flightdatachain = <span class="keyword">new</span> TChain(<span class="stringliteral">&quot;adu5PatTree&quot;</span>);</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    flightdatachain-&gt;SetMakeClass(1);</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    flightdatachain-&gt;Add((ICEMC_DATA_DIR+<span class="stringliteral">&quot;/anita2gps_pitchandroll.root&quot;</span>).c_str());<span class="comment">//created to include pitch and roll.</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    flightdatachain-&gt;SetBranchAddress(<span class="stringliteral">&quot;longitude&quot;</span>,&amp;flongitude);</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    flightdatachain-&gt;SetBranchAddress(<span class="stringliteral">&quot;latitude&quot;</span>,&amp;flatitude);</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    flightdatachain-&gt;SetBranchAddress(<span class="stringliteral">&quot;altitude&quot;</span>,&amp;faltitude);</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    flightdatachain-&gt;SetBranchAddress(<span class="stringliteral">&quot;heading&quot;</span>,&amp;fheading);</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    flightdatachain-&gt;SetBranchAddress(<span class="stringliteral">&quot;realTime&quot;</span>,&amp;<a class="code" href="../../d2/d24/class_balloon.html#a9ab8f966d754641c2ccd78099ba55b33">realTime_flightdata_temp</a>);</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    flightdatachain-&gt;SetBranchAddress(<span class="stringliteral">&quot;pitch&quot;</span>,&amp;fpitch);</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    flightdatachain-&gt;SetBranchAddress(<span class="stringliteral">&quot;roll&quot;</span>,&amp;froll);</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="comment">//cout &lt;&lt; &quot;Loading file.  n events is &quot; &lt;&lt; flightdatachain-&gt;GetEntries() &lt;&lt; &quot;\n&quot;;</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        </div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d2/d24/class_balloon.html#a81c68a6d332881cf4759a4bcca7dc48c">WHICHPATH</a>==8 || <a class="code" href="../../d2/d24/class_balloon.html#a81c68a6d332881cf4759a4bcca7dc48c">WHICHPATH</a>==9) { <span class="comment">// for anita-3 and 4 flights</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="keywordtype">string</span> balloonFile=<span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d2/d24/class_balloon.html#a81c68a6d332881cf4759a4bcca7dc48c">WHICHPATH</a>==8) balloonFile+=ICEMC_DATA_DIR+<span class="stringliteral">&quot;/anita3gps_pitchroll.root&quot;</span>;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="keywordflow">else</span> balloonFile+=ICEMC_DATA_DIR+<span class="stringliteral">&quot;/anita4gps_pitchroll.root&quot;</span>;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    </div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    flightdatachain = <span class="keyword">new</span> TChain(<span class="stringliteral">&quot;adu5PatTree&quot;</span>);</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    flightdatachain-&gt;SetMakeClass(1);</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    flightdatachain-&gt;Add(balloonFile.c_str());<span class="comment">//created to include pitch and roll.</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    flightdatachain-&gt;SetBranchAddress(<span class="stringliteral">&quot;longitude&quot;</span>,&amp;flongitude);</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    flightdatachain-&gt;SetBranchAddress(<span class="stringliteral">&quot;latitude&quot;</span>,&amp;flatitude);</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    flightdatachain-&gt;SetBranchAddress(<span class="stringliteral">&quot;altitude&quot;</span>,&amp;faltitude);</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    flightdatachain-&gt;SetBranchAddress(<span class="stringliteral">&quot;heading&quot;</span>,&amp;fheading);</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    flightdatachain-&gt;SetBranchAddress(<span class="stringliteral">&quot;realTime&quot;</span>,&amp;<a class="code" href="../../d2/d24/class_balloon.html#a9ab8f966d754641c2ccd78099ba55b33">realTime_flightdata_temp</a>);</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    flightdatachain-&gt;SetBranchAddress(<span class="stringliteral">&quot;pitch&quot;</span>,&amp;fpitch);</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    flightdatachain-&gt;SetBranchAddress(<span class="stringliteral">&quot;roll&quot;</span>,&amp;froll);</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        </div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  }</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    </div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  min_time = flightdatachain ? flightdatachain-&gt;GetMinimum(<a class="code" href="../../d2/d24/class_balloon.html#a81c68a6d332881cf4759a4bcca7dc48c">WHICHPATH</a> == 6 ? <span class="stringliteral">&quot;realTime_surfhk&quot;</span>:  <span class="stringliteral">&quot;realTime&quot;</span>) : 0; </div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  max_time = flightdatachain ? flightdatachain-&gt;GetMaximum(<a class="code" href="../../d2/d24/class_balloon.html#a81c68a6d332881cf4759a4bcca7dc48c">WHICHPATH</a> == 6 ? <span class="stringliteral">&quot;realTime_surfhk&quot;</span>:  <span class="stringliteral">&quot;realTime&quot;</span>) : 0; </div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        </div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;10000;i++) {</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <a class="code" href="../../d2/d24/class_balloon.html#a89cfc8cfa44410227aba08d70cbfc2bd">latitude_bn_anitalite</a>[i]=0;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <a class="code" href="../../d2/d24/class_balloon.html#a4bf2d1dbe9b6c6b98f3d507fa7d1002e">longitude_bn_anitalite</a>[i]=0;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <a class="code" href="../../d2/d24/class_balloon.html#a356923e58f8c56224ff6995537146491">altitude_bn_anitalite</a>[i]=0;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  }</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  <a class="code" href="../../d2/d24/class_balloon.html#aa11b7c8d8fca6acb9c5789a85974ad92">NPOINTS</a>=0;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  <a class="code" href="../../d2/d24/class_balloon.html#a3a82e49e805b9070cf0684b519e20a6f">REDUCEBALLOONPOSITIONS</a>=100;</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    </div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    </div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    </div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d2/d24/class_balloon.html#a81c68a6d332881cf4759a4bcca7dc48c">WHICHPATH</a>!=6) {</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="comment">// if it&#39;s not the anita path, you won&#39;t be able to read in thresholds and masks</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;9;i++) {</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0;j&lt;2;j++) {</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <a class="code" href="../../d2/d24/class_balloon.html#a155811c7b07a72024a4c21ece1aa311c">surfTrigBandMask</a>[i][j]=0;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      }</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0;j&lt;32;j++) {</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <a class="code" href="../../d2/d24/class_balloon.html#ab961c4c09983ae291b1feedb1f98b786">powerthresh</a>[i][j]=3.E-12;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <a class="code" href="../../d2/d24/class_balloon.html#a83699275fd0ec62469cfcde3d5f0656d">meanp</a>[i][j]=1.E-12;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      }</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;            </div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    }</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        </div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        </div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  }</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;}</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;</div><div class="line"><a name="l00287"></a><span class="lineno"><a class="line" href="../../d2/d24/class_balloon.html#a3c333ec0bbf10e678cd86ee3bdad0f0d">  287</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="../../d2/d24/class_balloon.html#a3c333ec0bbf10e678cd86ee3bdad0f0d">Balloon::GetBalloonSpin</a>(<span class="keywordtype">double</span> heading) { <span class="comment">// get the azimuth of the balloon</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;      </div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d2/d24/class_balloon.html#a72ef197fc6e4a463e7b066081ddc7527">phi_spin</a>;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d2/d24/class_balloon.html#a81c68a6d332881cf4759a4bcca7dc48c">WHICHPATH</a>==2 || <a class="code" href="../../d2/d24/class_balloon.html#a81c68a6d332881cf4759a4bcca7dc48c">WHICHPATH</a>==6 || <a class="code" href="../../d2/d24/class_balloon.html#a81c68a6d332881cf4759a4bcca7dc48c">WHICHPATH</a>==7 || <a class="code" href="../../d2/d24/class_balloon.html#a81c68a6d332881cf4759a4bcca7dc48c">WHICHPATH</a>==8 || <a class="code" href="../../d2/d24/class_balloon.html#a81c68a6d332881cf4759a4bcca7dc48c">WHICHPATH</a>==9)</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    phi_spin=heading*RADDEG;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d2/d24/class_balloon.html#a80dccd66445722dd1bb5f8d386aa5d0f">RANDOMIZE_BN_ORIENTATION</a>==1)</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      phi_spin=getRNG(RNG_BALLOON_POSITION)-&gt;Rndm()*2*PI;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;      phi_spin=0.;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  }</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  </div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d2/d24/class_balloon.html#a72ef197fc6e4a463e7b066081ddc7527">phi_spin</a>;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;}</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;</div><div class="line"><a name="l00303"></a><span class="lineno"><a class="line" href="../../d2/d24/class_balloon.html#a9d7ad805352db5a11ecd3acfddc27d44">  303</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d2/d24/class_balloon.html#a9d7ad805352db5a11ecd3acfddc27d44">Balloon::Getibnposition</a>() {</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  <span class="keywordtype">int</span> ibnposition_tmp;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d2/d24/class_balloon.html#a81c68a6d332881cf4759a4bcca7dc48c">WHICHPATH</a>==1)</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    ibnposition_tmp = (int)(<a class="code" href="../../d2/d24/class_balloon.html#a69f284427712f451a4c1c3756f168093">r_bn</a>.<a class="code" href="../../d7/d3b/class_position.html#a736146228c802ee9b3f0953349c4410a">Lon</a>() / 2);</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d2/d24/class_balloon.html#a81c68a6d332881cf4759a4bcca7dc48c">WHICHPATH</a>==2 || <a class="code" href="../../d2/d24/class_balloon.html#a81c68a6d332881cf4759a4bcca7dc48c">WHICHPATH</a>==6 || <a class="code" href="../../d2/d24/class_balloon.html#a81c68a6d332881cf4759a4bcca7dc48c">WHICHPATH</a>==7 || <a class="code" href="../../d2/d24/class_balloon.html#a81c68a6d332881cf4759a4bcca7dc48c">WHICHPATH</a>==8 || <a class="code" href="../../d2/d24/class_balloon.html#a81c68a6d332881cf4759a4bcca7dc48c">WHICHPATH</a>==9){</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    ibnposition_tmp=(int)((<span class="keywordtype">double</span>)<a class="code" href="../../d2/d24/class_balloon.html#a4067df26bb03b68f35e99d9012e67525">igps</a>/(double)<a class="code" href="../../d2/d24/class_balloon.html#a3a82e49e805b9070cf0684b519e20a6f">REDUCEBALLOONPOSITIONS</a>);</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="comment">// std::cout &lt;&lt; __FUNCTION__ &lt;&lt; &quot; &quot; &lt;&lt; igps &lt;&lt; &quot; &quot; &lt;&lt; REDUCEBALLOONPOSITIONS &lt;&lt; &quot; &quot; &lt;&lt; ibnposition_tmp &lt;&lt; std::endl;</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    ibnposition_tmp=0;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    </div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  <span class="keywordflow">return</span> ibnposition_tmp;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    </div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;}</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;</div><div class="line"><a name="l00317"></a><span class="lineno"><a class="line" href="../../d2/d24/class_balloon.html#a6dba9060a33b1755d6609ff2de0b8a49">  317</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d2/d24/class_balloon.html#a6dba9060a33b1755d6609ff2de0b8a49">Balloon::PickBalloonPosition</a>(<a class="code" href="../../d5/db2/class_vector.html">Vector</a> straightup,<a class="code" href="../../de/d63/class_ice_model.html">IceModel</a> *antarctica1,<a class="code" href="../../db/d2b/class_settings.html">Settings</a> *settings1,<a class="code" href="../../df/da2/class_anita.html">Anita</a> *anita1) {</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <span class="comment">// takes a 3d vector pointing along the z axis</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  <a class="code" href="../../d5/db2/class_vector.html">Vector</a> thetazero(0.,0.,1.);</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  <a class="code" href="../../d5/db2/class_vector.html">Vector</a> phizero(1.,0.,0.);</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  <a class="code" href="../../d2/d24/class_balloon.html#a4067df26bb03b68f35e99d9012e67525">igps</a>=0;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  theta_bn=acos(straightup.Dot(thetazero)); <span class="comment">// 1deg</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160; </div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  <span class="keywordflow">if</span> (straightup.GetX()==0 &amp;&amp; straightup.GetY()==0)</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <a class="code" href="../../d2/d24/class_balloon.html#a6bf058d1320831ad733db4c5f9ce3cbe">phi_bn</a>=0.;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <a class="code" href="../../d2/d24/class_balloon.html#a6bf058d1320831ad733db4c5f9ce3cbe">phi_bn</a>=acos((straightup.Cross(thetazero)).Dot(phizero)); <span class="comment">// 1deg</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  <span class="comment">// cout &lt;&lt; &quot;theta_bn, phi_bn are &quot; &lt;&lt; theta_bn &lt;&lt; &quot; &quot; &lt;&lt; phi_bn &lt;&lt; &quot;\n&quot;;</span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  <a class="code" href="../../d2/d24/class_balloon.html#a69f284427712f451a4c1c3756f168093">r_bn</a>=<a class="code" href="../../d7/d3b/class_position.html">Position</a>(theta_bn,<a class="code" href="../../d2/d24/class_balloon.html#a6bf058d1320831ad733db4c5f9ce3cbe">phi_bn</a>); <span class="comment">// sets r_bn</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <span class="comment">//cout &lt;&lt; &quot;r_bn is &quot;;</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  <span class="comment">//r_bn.Print();</span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d2/d24/class_balloon.html#aae0a6056476d43b3e44bc9ddf3d66afd">BN_ALTITUDE</a>!=0)</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    altitude_bn=<a class="code" href="../../d2/d24/class_balloon.html#aae0a6056476d43b3e44bc9ddf3d66afd">BN_ALTITUDE</a>; <span class="comment">// set the altitude of the balloon to be what you pick.  This isn&#39;t in time for CreateHorizons though!</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  <span class="comment">//cout &lt;&lt; &quot;altitude_bn is &quot; &lt;&lt; altitude_bn &lt;&lt; &quot;\n&quot;;</span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  <a class="code" href="../../d2/d24/class_balloon.html#a82033268c70493ca7c6e850e82e8c49d">surface_under_balloon</a> = antarctica1-&gt;Surface(r_bn);</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  <span class="comment">//cout &lt;&lt; &quot;surface_under_balloon is &quot; &lt;&lt; surface_under_balloon &lt;&lt; &quot;\n&quot;;</span></div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  <a class="code" href="../../d2/d24/class_balloon.html#ae5a88658b80b1f027e5fe28a9d8144e8">r_bn_shadow</a> = <a class="code" href="../../d2/d24/class_balloon.html#a82033268c70493ca7c6e850e82e8c49d">surface_under_balloon</a> * r_bn.Unit();</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  <span class="comment">//cout &lt;&lt; &quot;r_bn_shadow is &quot; &lt;&lt; r_bn_shadow &lt;&lt; &quot;\n&quot;;</span></div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  <span class="comment">//    r_bn = (antarctica-&gt;Geoid(r_bn)+altitude_bn) * r_bn.Unit();</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  </div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  r_bn = (antarctica1-&gt;Surface(r_bn)+altitude_bn) * r_bn.Unit();</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  <span class="comment">//cout &lt;&lt; &quot;r_bn is &quot;;</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  <span class="comment">// r_bn.Print();</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  ibnposition=<a class="code" href="../../d2/d24/class_balloon.html#a9d7ad805352db5a11ecd3acfddc27d44">Getibnposition</a>();</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  </div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  <a class="code" href="../../d2/d24/class_balloon.html#a7542eed41dafcc761205c51a18e6eddf">dtryingposition</a>=1.;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  </div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  <a class="code" href="../../d2/d24/class_balloon.html#a72ef197fc6e4a463e7b066081ddc7527">phi_spin</a>=0.; <span class="comment">// get the azimuth of the balloon.</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    </div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  <span class="comment">// normalized balloon position</span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  <a class="code" href="../../d2/d24/class_balloon.html#ad62ec9ecbb5e88b701b6f38de01240c3">n_bn</a> = r_bn.Unit();</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  </div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  <span class="comment">// finding which direction is east under the balloon</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  <a class="code" href="../../d2/d24/class_balloon.html#aadaf722446282e6a5022146ccafb8c4a">n_east</a> = <a class="code" href="../../d5/db2/class_vector.html">Vector</a>(sin(<a class="code" href="../../d2/d24/class_balloon.html#a6bf058d1320831ad733db4c5f9ce3cbe">phi_bn</a>), -1*cos(<a class="code" href="../../d2/d24/class_balloon.html#a6bf058d1320831ad733db4c5f9ce3cbe">phi_bn</a>), 0.);</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  </div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  <span class="comment">// find position of each antenna boresight</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  </div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  <span class="comment">// now finding north</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  <a class="code" href="../../d2/d24/class_balloon.html#a379114e2cc17de2246dd14f5cb6febdf">n_north</a> = <a class="code" href="../../d2/d24/class_balloon.html#ad62ec9ecbb5e88b701b6f38de01240c3">n_bn</a>.Cross(<a class="code" href="../../d2/d24/class_balloon.html#aadaf722446282e6a5022146ccafb8c4a">n_east</a>);</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  </div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  <span class="comment">// these coordinates are for filling ntuples.</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  <a class="code" href="../../d2/d24/class_balloon.html#aa66ff5dc8a3812aaf4e18300021adc15">horizcoord_bn</a>=r_bn[0]/1000.; <span class="comment">//m to km</span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;  <a class="code" href="../../d2/d24/class_balloon.html#a8dff2cae99ba8661c69438e604aebe00">vertcoord_bn</a>=r_bn[1]/1000.;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  </div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  </div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  <a class="code" href="../../d2/d24/class_balloon.html#a86fdedefec1f2925bb92c905c0952ede">calculate_antenna_positions</a>(settings1,anita1);</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  <span class="comment">//  cout &lt;&lt; &quot;calculated antenna positions.\n&quot;;</span></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  <span class="keywordflow">if</span> (settings1-&gt;BORESIGHTS)</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <a class="code" href="../../d2/d24/class_balloon.html#a78e22e4ce293cabeaa2a249d9932e772">GetBoresights</a>(settings1,anita1);</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    </div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;}</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment">// for tuffs for anita-4</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="keywordtype">int</span> getTuffIndex(<span class="keywordtype">int</span> Curr_time) {</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  <span class="keywordflow">if</span>((TUFFconfig_B_end_3 &lt; Curr_time) &amp;&amp; (Curr_time &lt;= TUFFconfig_A_end_1)) {<span class="comment">// config A trigconfigA.imp</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  }</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(((0 &lt; Curr_time) &amp;&amp; (Curr_time &lt;= TUFFconfig_B_end_1)) || ((TUFFconfig_P_end_3 &lt; Curr_time) &amp;&amp; (Curr_time &lt;= TUFFconfig_B_end_2)) || ((TUFFconfig_P_end_4 &lt; Curr_time) &amp;&amp; (Curr_time &lt;= TUFFconfig_B_end_3)) || ((TUFFconfig_A_end_1 &lt; Curr_time) &amp;&amp; (Curr_time &lt;= TUFFconfig_B_end_4)) || ((TUFFconfig_P_end_5 &lt; Curr_time) &amp;&amp; (Curr_time &lt;= TUFFconfig_B_end_5)) || ((TUFFconfig_P_end_6 &lt; Curr_time) &amp;&amp; (Curr_time &lt;= TUFFconfig_B_end_6)) || (TUFFconfig_P_end_7 &lt; Curr_time) ) { <span class="comment">// config B trigconfigB.imp</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  }</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>((TUFFconfig_P_end_1 &lt; Curr_time) &amp;&amp; (Curr_time &lt;= TUFFconfig_C_end_1)) { <span class="comment">// config C trigconfigC.imp</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="keywordflow">return</span> 2;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  }</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>( ((TUFFconfig_P_end_2 &lt; Curr_time) &amp;&amp; (Curr_time &lt;= TUFFconfig_G_end_1)) || ((TUFFconfig_O_end_1 &lt; Curr_time) &amp;&amp; (Curr_time &lt;= TUFFconfig_G_end_2)) ) { <span class="comment">// config G trigconfigG.imp</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="keywordflow">return</span> 3;</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  }</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>( ((TUFFconfig_G_end_1 &lt; Curr_time) &amp;&amp; (Curr_time &lt;= TUFFconfig_O_end_1)) || ((TUFFconfig_G_end_2 &lt; Curr_time) &amp;&amp; (Curr_time &lt;= TUFFconfig_O_end_2)) ) { <span class="comment">// config O trigconfigO.imp</span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <span class="keywordflow">return</span> 4;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  }</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>( ((TUFFconfig_B_end_1 &lt; Curr_time) &amp;&amp; (Curr_time &lt;= TUFFconfig_P_end_1)) || ((TUFFconfig_C_end_1 &lt; Curr_time) &amp;&amp; (Curr_time &lt;= TUFFconfig_P_end_2)) || ((TUFFconfig_O_end_2 &lt; Curr_time) &amp;&amp; (Curr_time &lt;= TUFFconfig_P_end_3)) || ((TUFFconfig_B_end_2 &lt; Curr_time) &amp;&amp; (Curr_time &lt;= TUFFconfig_P_end_4)) || ((TUFFconfig_B_end_4 &lt; Curr_time) &amp;&amp; (Curr_time &lt;= TUFFconfig_P_end_5)) || ((TUFFconfig_B_end_5 &lt; Curr_time) &amp;&amp; (Curr_time &lt;= TUFFconfig_P_end_6)) || ((TUFFconfig_B_end_6 &lt; Curr_time) &amp;&amp; (Curr_time &lt;= TUFFconfig_P_end_7)) ) { <span class="comment">// config P trigconfigP.imp</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <span class="keywordflow">return</span> 5;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  }</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  <span class="keywordflow">return</span> -1; </div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;}</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment">// this is called for each neutrino</span></div><div class="line"><a name="l00400"></a><span class="lineno"><a class="line" href="../../d2/d24/class_balloon.html#aa2cbb90f86949695c91278cdb7cc225c">  400</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d2/d24/class_balloon.html#a6dba9060a33b1755d6609ff2de0b8a49">Balloon::PickBalloonPosition</a>(<a class="code" href="../../de/d63/class_ice_model.html">IceModel</a> *antarctica1,<a class="code" href="../../db/d2b/class_settings.html">Settings</a> *settings1,<span class="keywordtype">int</span> inu,<a class="code" href="../../df/da2/class_anita.html">Anita</a> *anita1, <span class="keywordtype">double</span> randomNumber) { <span class="comment">// r_bn_shadow=position of spot under the balloon on earth&#39;s surface</span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  <span class="comment">//cout &lt;&lt; &quot;calling pickballoonposition.\n&quot;;</span></div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  pitch=0.;</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  roll=0.;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  <a class="code" href="../../d2/d24/class_balloon.html#a72ef197fc6e4a463e7b066081ddc7527">phi_spin</a>=0.;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  <span class="comment">//flightdatatree-&gt;SetBranchAddress(&quot;surfTrigBandMask&quot;,&amp;surfTrigBandMask);</span></div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  <span class="comment">//unsigned short test[9][2];</span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    </div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  <span class="comment">//double latitude,longitude,altitude;</span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    </div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  <span class="comment">//  cout &lt;&lt; &quot;I&#39;m in pickballoonposition. whichpath is &quot; &lt;&lt; WHICHPATH &lt;&lt; &quot;\n&quot;;</span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  <span class="comment">//Pick balloon position</span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d2/d24/class_balloon.html#a81c68a6d332881cf4759a4bcca7dc48c">WHICHPATH</a>==2 || <a class="code" href="../../d2/d24/class_balloon.html#a81c68a6d332881cf4759a4bcca7dc48c">WHICHPATH</a>==6 || <a class="code" href="../../d2/d24/class_balloon.html#a81c68a6d332881cf4759a4bcca7dc48c">WHICHPATH</a>==7 || <a class="code" href="../../d2/d24/class_balloon.html#a81c68a6d332881cf4759a4bcca7dc48c">WHICHPATH</a>==8 || <a class="code" href="../../d2/d24/class_balloon.html#a81c68a6d332881cf4759a4bcca7dc48c">WHICHPATH</a>==9) { <span class="comment">// anita-lite or anita-I or -II path</span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        </div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d2/d24/class_balloon.html#a81c68a6d332881cf4759a4bcca7dc48c">WHICHPATH</a>==2) {</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;      <a class="code" href="../../d2/d24/class_balloon.html#a4067df26bb03b68f35e99d9012e67525">igps</a>=<a class="code" href="../../d2/d24/class_balloon.html#a83af0cc214fdafe44fd492d7dbbaca51">NPOINTS_MIN</a>+(<a class="code" href="../../d2/d24/class_balloon.html#a3a090dc24bdfdf84bdddc308de7d20e0">igps_previous</a>+1-<a class="code" href="../../d2/d24/class_balloon.html#a83af0cc214fdafe44fd492d7dbbaca51">NPOINTS_MIN</a>)%(NPOINTS_MAX-<a class="code" href="../../d2/d24/class_balloon.html#a83af0cc214fdafe44fd492d7dbbaca51">NPOINTS_MIN</a>); <span class="comment">//Note: ignore last 140 points, where balloon is falling - Stephen</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;      flatitude=(float)<a class="code" href="../../d2/d24/class_balloon.html#a89cfc8cfa44410227aba08d70cbfc2bd">latitude_bn_anitalite</a>[<a class="code" href="../../d2/d24/class_balloon.html#a4067df26bb03b68f35e99d9012e67525">igps</a>];</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;      flongitude=(float)<a class="code" href="../../d2/d24/class_balloon.html#a4bf2d1dbe9b6c6b98f3d507fa7d1002e">longitude_bn_anitalite</a>[<a class="code" href="../../d2/d24/class_balloon.html#a4067df26bb03b68f35e99d9012e67525">igps</a>];</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;      faltitude=(float)<a class="code" href="../../d2/d24/class_balloon.html#a356923e58f8c56224ff6995537146491">altitude_bn_anitalite</a>[<a class="code" href="../../d2/d24/class_balloon.html#a4067df26bb03b68f35e99d9012e67525">igps</a>];</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;      fheading=(float)<a class="code" href="../../d2/d24/class_balloon.html#a1abf252a4e4d375db5821822c5225aea">heading_bn_anitalite</a>[<a class="code" href="../../d2/d24/class_balloon.html#a4067df26bb03b68f35e99d9012e67525">igps</a>];</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;            </div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;            </div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    }</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d2/d24/class_balloon.html#a81c68a6d332881cf4759a4bcca7dc48c">WHICHPATH</a>==6 || <a class="code" href="../../d2/d24/class_balloon.html#a81c68a6d332881cf4759a4bcca7dc48c">WHICHPATH</a>==7 || <a class="code" href="../../d2/d24/class_balloon.html#a81c68a6d332881cf4759a4bcca7dc48c">WHICHPATH</a>==8 || <a class="code" href="../../d2/d24/class_balloon.html#a81c68a6d332881cf4759a4bcca7dc48c">WHICHPATH</a>==9) {  <span class="comment">// For Anita 1 and Anita 2 and Anita 3:</span></div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;      <span class="comment">//igps=(igps_previous+1)%flightdatachain-&gt;GetEntries(); // pick which event in the tree we want</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;      </div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;      <span class="keyword">static</span> <span class="keywordtype">int</span> start_igps = 0; </div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;      <span class="keyword">static</span> <span class="keywordtype">int</span> ngps = flightdatachain-&gt;GetEntries(); </div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;      <span class="keyword">static</span> <span class="keywordtype">int</span> init_best = 0;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;      <span class="keywordflow">if</span> (settings1-&gt;PAYLOAD_USE_SPECIFIC_TIME &amp;&amp; !init_best) </div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;      {</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;         <span class="keywordtype">int</span> N = flightdatachain-&gt;Draw(<span class="stringliteral">&quot;realTime&quot;</span>,<span class="stringliteral">&quot;&quot;</span>,<span class="stringliteral">&quot;goff&quot;</span>); </div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;         <span class="keywordtype">double</span> * times = flightdatachain-&gt;GetV1(); </div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;         <span class="keywordtype">int</span> best_igps =  TMath::BinarySearch(N, times, (<span class="keywordtype">double</span>) settings1-&gt;PAYLOAD_USE_SPECIFIC_TIME); </div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;         start_igps = best_igps;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;         <span class="keywordtype">int</span> end_igps = best_igps;</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;         </div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;         <span class="keywordflow">while</span> (times[start_igps] &gt; settings1-&gt;PAYLOAD_USE_SPECIFIC_TIME - settings1-&gt;PAYLOAD_USE_SPECIFIC_TIME_DELTA)</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;         {</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;           start_igps--; </div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;         }</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;         <span class="keywordflow">while</span> (times[end_igps] &lt; settings1-&gt;PAYLOAD_USE_SPECIFIC_TIME + settings1-&gt;PAYLOAD_USE_SPECIFIC_TIME_DELTA)</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;         {</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;           end_igps++; </div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;         }</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;         ngps = end_igps - start_igps + 1; </div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;         init_best = 1; </div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;      }</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;      <a class="code" href="../../d2/d24/class_balloon.html#a4067df26bb03b68f35e99d9012e67525">igps</a> = start_igps + int(randomNumber*ngps); <span class="comment">// use random position </span></div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;      <span class="keywordtype">bool</span> adjustedTime = <span class="keyword">false</span>; </div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d2/d24/class_balloon.html#a81c68a6d332881cf4759a4bcca7dc48c">WHICHPATH</a>==9 &amp;&amp; ((<a class="code" href="../../d2/d24/class_balloon.html#a4067df26bb03b68f35e99d9012e67525">igps</a>&gt;870 &amp;&amp; <a class="code" href="../../d2/d24/class_balloon.html#a4067df26bb03b68f35e99d9012e67525">igps</a>&lt;880) || (<a class="code" href="../../d2/d24/class_balloon.html#a4067df26bb03b68f35e99d9012e67525">igps</a>&gt;7730 &amp;&amp; <a class="code" href="../../d2/d24/class_balloon.html#a4067df26bb03b68f35e99d9012e67525">igps</a>&lt;7740) || (<a class="code" href="../../d2/d24/class_balloon.html#a4067df26bb03b68f35e99d9012e67525">igps</a>&gt;23810 &amp;&amp; <a class="code" href="../../d2/d24/class_balloon.html#a4067df26bb03b68f35e99d9012e67525">igps</a>&lt;23820) || (<a class="code" href="../../d2/d24/class_balloon.html#a4067df26bb03b68f35e99d9012e67525">igps</a>&gt;31630 &amp;&amp; <a class="code" href="../../d2/d24/class_balloon.html#a4067df26bb03b68f35e99d9012e67525">igps</a>&lt;31660) || (<a class="code" href="../../d2/d24/class_balloon.html#a4067df26bb03b68f35e99d9012e67525">igps</a>==17862) ) )</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        {</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;          <a class="code" href="../../d2/d24/class_balloon.html#a4067df26bb03b68f35e99d9012e67525">igps</a>+=30;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;          <a class="code" href="../../d2/d24/class_balloon.html#a4067df26bb03b68f35e99d9012e67525">igps</a>=<a class="code" href="../../d2/d24/class_balloon.html#a4067df26bb03b68f35e99d9012e67525">igps</a>%flightdatachain-&gt;GetEntries(); <span class="comment">// make sure it&#39;s not beyond the maximum entry number</span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        }</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;      </div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;      flightdatachain-&gt;GetEvent(<a class="code" href="../../d2/d24/class_balloon.html#a4067df26bb03b68f35e99d9012e67525">igps</a>); <span class="comment">// this grabs the balloon position data for this event</span></div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;      <a class="code" href="../../d2/d24/class_balloon.html#aefb79f91cdee782d62e724b2c50c64b2">realTime_flightdata</a> = <a class="code" href="../../d2/d24/class_balloon.html#a9ab8f966d754641c2ccd78099ba55b33">realTime_flightdata_temp</a>;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="../../d2/d24/class_balloon.html#a81c68a6d332881cf4759a4bcca7dc48c">WHICHPATH</a>==9)</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        {</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;          <span class="comment">//std::cout &lt;&lt; &quot;realTime_flightdata  = &quot; &lt;&lt; realTime_flightdata &lt;&lt; std::endl;</span></div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;          <span class="comment">// Small portion of flight, so shouldn&#39;t cause slowdown</span></div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;            <span class="keywordflow">while</span>( (<a class="code" href="../../d2/d24/class_balloon.html#aefb79f91cdee782d62e724b2c50c64b2">realTime_flightdata</a> &gt;= 1480725528 &amp;&amp; <a class="code" href="../../d2/d24/class_balloon.html#aefb79f91cdee782d62e724b2c50c64b2">realTime_flightdata</a> &lt;= 1480730678) || (<a class="code" href="../../d2/d24/class_balloon.html#aefb79f91cdee782d62e724b2c50c64b2">realTime_flightdata</a> &gt;= 1480796516 &amp;&amp; <a class="code" href="../../d2/d24/class_balloon.html#aefb79f91cdee782d62e724b2c50c64b2">realTime_flightdata</a> &lt;= 1480804184) )</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;            {</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;              adjustedTime = <span class="keyword">true</span>;</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;              <span class="comment">//std::cout &lt;&lt; &quot;BAD TIME DETECTED: &quot; &lt;&lt; realTime_flightdata &lt;&lt; std::endl;</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;              <a class="code" href="../../d2/d24/class_balloon.html#a4067df26bb03b68f35e99d9012e67525">igps</a>+=30; <span class="comment">// pick another time, out range</span></div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;              <a class="code" href="../../d2/d24/class_balloon.html#a4067df26bb03b68f35e99d9012e67525">igps</a>=<a class="code" href="../../d2/d24/class_balloon.html#a4067df26bb03b68f35e99d9012e67525">igps</a>%flightdatachain-&gt;GetEntries(); <span class="comment">// make sure it&#39;s not beyond the maximum entry number</span></div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;              flightdatachain-&gt;GetEvent(<a class="code" href="../../d2/d24/class_balloon.html#a4067df26bb03b68f35e99d9012e67525">igps</a>);    <span class="comment">// get new event</span></div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;              <a class="code" href="../../d2/d24/class_balloon.html#aefb79f91cdee782d62e724b2c50c64b2">realTime_flightdata</a> = <a class="code" href="../../d2/d24/class_balloon.html#a9ab8f966d754641c2ccd78099ba55b33">realTime_flightdata_temp</a>; <span class="comment">// recalculate fight time with new igps</span></div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;            }</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;            <span class="comment">//if(adjustedTime==true){std::cout &lt;&lt; &quot;GOOD TIME DETECTED = &quot; &lt;&lt; realTime_flightdata &lt;&lt; std::endl;}</span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;        }</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;      </div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;      <span class="keywordflow">if</span>(settings1-&gt;TUFFSTATUS==1){</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        anita1-&gt;tuffIndex = getTuffIndex(<a class="code" href="../../d2/d24/class_balloon.html#aefb79f91cdee782d62e724b2c50c64b2">realTime_flightdata</a>);</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        <span class="keywordflow">if</span>(settings1-&gt;TRIGGEREFFSCAN){</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;          anita1-&gt;tuffIndex = 6;</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        }</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d2/d24/class_balloon.html#a81c68a6d332881cf4759a4bcca7dc48c">WHICHPATH</a>==9 &amp;&amp; settings1-&gt;TUFFSTATUS==2) anita1-&gt;tuffIndex = 6; </div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;      </div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;      <span class="keywordflow">while</span> (faltitude&lt;<a class="code" href="../../d2/d24/class_balloon.html#afa3d16030232d03d5986d340b8f562c2">MINALTITUDE</a> || fheading&lt;0) { <span class="comment">// if the altitude is too low, pick another event.</span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;            </div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  (void) adjustedTime; </div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <a class="code" href="../../d2/d24/class_balloon.html#a4067df26bb03b68f35e99d9012e67525">igps</a>++; <span class="comment">// increment by 1</span></div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <a class="code" href="../../d2/d24/class_balloon.html#a4067df26bb03b68f35e99d9012e67525">igps</a>=<a class="code" href="../../d2/d24/class_balloon.html#a4067df26bb03b68f35e99d9012e67525">igps</a>%flightdatachain-&gt;GetEntries(); <span class="comment">// make sure it&#39;s not beyond the maximum entry number</span></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;            </div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    flightdatachain-&gt;GetEvent(<a class="code" href="../../d2/d24/class_balloon.html#a4067df26bb03b68f35e99d9012e67525">igps</a>);      <span class="comment">// get new event</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;      }</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;      <span class="comment">// set phi Masking for Anita 2 or Anita 3</span></div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;      <span class="comment">// the deadtime is read from the same tree</span></div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="../../d2/d24/class_balloon.html#a81c68a6d332881cf4759a4bcca7dc48c">WHICHPATH</a>==7 || <a class="code" href="../../d2/d24/class_balloon.html#a81c68a6d332881cf4759a4bcca7dc48c">WHICHPATH</a>==8 || <a class="code" href="../../d2/d24/class_balloon.html#a81c68a6d332881cf4759a4bcca7dc48c">WHICHPATH</a>==9) &amp;&amp; (settings1-&gt;PHIMASKING==1 || settings1-&gt;USEDEADTIME))  </div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    anita1-&gt;setphiTrigMask(<a class="code" href="../../d2/d24/class_balloon.html#aefb79f91cdee782d62e724b2c50c64b2">realTime_flightdata</a>);</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="../../d2/d24/class_balloon.html#a81c68a6d332881cf4759a4bcca7dc48c">WHICHPATH</a>==8 || <a class="code" href="../../d2/d24/class_balloon.html#a81c68a6d332881cf4759a4bcca7dc48c">WHICHPATH</a>==9) &amp;&amp; settings1-&gt;USETIMEDEPENDENTTHRESHOLDS==1) <span class="comment">// set time-dependent thresholds</span></div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    anita1-&gt;setTimeDependentThresholds(<a class="code" href="../../d2/d24/class_balloon.html#aefb79f91cdee782d62e724b2c50c64b2">realTime_flightdata</a>);</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;          </div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    }</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <a class="code" href="../../d2/d24/class_balloon.html#a3a090dc24bdfdf84bdddc308de7d20e0">igps_previous</a>=<a class="code" href="../../d2/d24/class_balloon.html#a4067df26bb03b68f35e99d9012e67525">igps</a>;</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    latitude=(double)flatitude;</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    longitude=(double)flongitude;</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    altitude=(double)faltitude;</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    heading=(double)fheading;</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    roll=(double)froll;</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    pitch=(double)fpitch;</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    <a class="code" href="../../d2/d24/class_balloon.html#a1298f31799a3b6a8e29ebe709dfe4e05">setr_bn</a>(latitude,longitude); <span class="comment">// sets theta_bn, phi_bn and r_bn.  r_bn is a unit vector pointing in the right direction</span></div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        </div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        </div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        </div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d2/d24/class_balloon.html#a81c68a6d332881cf4759a4bcca7dc48c">WHICHPATH</a>==2)</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;      altitude_bn=altitude*12.*CMINCH/100.;  <span class="comment">// ANITA-lite flight input is in feet </span></div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d2/d24/class_balloon.html#a81c68a6d332881cf4759a4bcca7dc48c">WHICHPATH</a>==6 || <a class="code" href="../../d2/d24/class_balloon.html#a81c68a6d332881cf4759a4bcca7dc48c">WHICHPATH</a>==7 || <a class="code" href="../../d2/d24/class_balloon.html#a81c68a6d332881cf4759a4bcca7dc48c">WHICHPATH</a>==8 || <a class="code" href="../../d2/d24/class_balloon.html#a81c68a6d332881cf4759a4bcca7dc48c">WHICHPATH</a>==9)</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;      altitude_bn=altitude; <span class="comment">// get the altitude of the balloon in the right units</span></div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        </div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    <a class="code" href="../../d2/d24/class_balloon.html#a82033268c70493ca7c6e850e82e8c49d">surface_under_balloon</a> = antarctica1-&gt;Surface(<a class="code" href="../../d2/d24/class_balloon.html#a69f284427712f451a4c1c3756f168093">r_bn</a>); <span class="comment">// get altitude of the surface under the balloon</span></div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;        </div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <a class="code" href="../../d2/d24/class_balloon.html#ae5a88658b80b1f027e5fe28a9d8144e8">r_bn_shadow</a> = <a class="code" href="../../d2/d24/class_balloon.html#a82033268c70493ca7c6e850e82e8c49d">surface_under_balloon</a> * <a class="code" href="../../d2/d24/class_balloon.html#a69f284427712f451a4c1c3756f168093">r_bn</a>.Unit(); <span class="comment">// this is a vector pointing to spot just under the balloon on the surface (its shadow at high noon)</span></div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <a class="code" href="../../d2/d24/class_balloon.html#a69f284427712f451a4c1c3756f168093">r_bn</a> = (antarctica1-&gt;Geoid(<a class="code" href="../../d2/d24/class_balloon.html#a69f284427712f451a4c1c3756f168093">r_bn</a>)+altitude_bn) * <a class="code" href="../../d2/d24/class_balloon.html#a69f284427712f451a4c1c3756f168093">r_bn</a>.Unit();</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <span class="comment">//r_bn = (antarctica-&gt;Surface(r_bn)+altitude_bn) * r_bn.Unit(); //this points to balloon position (not a unit vector)</span></div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;  } <span class="comment">//if (ANITA-lite path) or anita 1 or anita 2</span></div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    </div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    </div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    </div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d2/d24/class_balloon.html#a81c68a6d332881cf4759a4bcca7dc48c">WHICHPATH</a>==1){ <span class="comment">// pick random phi at 80 deg S</span></div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    <a class="code" href="../../d2/d24/class_balloon.html#a6bf058d1320831ad733db4c5f9ce3cbe">phi_bn</a>=getRNG(RNG_BALLOON_POSITION)-&gt;Rndm()*TWOPI;</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        </div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <a class="code" href="../../d2/d24/class_balloon.html#a69f284427712f451a4c1c3756f168093">r_bn</a> = <a class="code" href="../../d7/d3b/class_position.html">Position</a>(theta_bn,<a class="code" href="../../d2/d24/class_balloon.html#a6bf058d1320831ad733db4c5f9ce3cbe">phi_bn</a>);</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <a class="code" href="../../d2/d24/class_balloon.html#a82033268c70493ca7c6e850e82e8c49d">surface_under_balloon</a> = antarctica1-&gt;Surface(<a class="code" href="../../d2/d24/class_balloon.html#a69f284427712f451a4c1c3756f168093">r_bn</a>);</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        </div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <a class="code" href="../../d2/d24/class_balloon.html#ae5a88658b80b1f027e5fe28a9d8144e8">r_bn_shadow</a> = <a class="code" href="../../d2/d24/class_balloon.html#a82033268c70493ca7c6e850e82e8c49d">surface_under_balloon</a> * <a class="code" href="../../d2/d24/class_balloon.html#a69f284427712f451a4c1c3756f168093">r_bn</a>.Unit();</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    <span class="comment">//    r_bn = (antarctica-&gt;Geoid(r_bn)+altitude_bn) * r_bn.Unit();</span></div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <a class="code" href="../../d2/d24/class_balloon.html#a69f284427712f451a4c1c3756f168093">r_bn</a> = (antarctica1-&gt;Surface(<a class="code" href="../../d2/d24/class_balloon.html#a69f284427712f451a4c1c3756f168093">r_bn</a>)+altitude_bn) * <a class="code" href="../../d2/d24/class_balloon.html#a69f284427712f451a4c1c3756f168093">r_bn</a>.Unit();</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    <a class="code" href="../../d2/d24/class_balloon.html#a4067df26bb03b68f35e99d9012e67525">igps</a>=0;</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;  } <span class="comment">//else if(random position at 80 deg S)</span></div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d2/d24/class_balloon.html#a81c68a6d332881cf4759a4bcca7dc48c">WHICHPATH</a>==0){</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;        </div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    <a class="code" href="../../d2/d24/class_balloon.html#a4067df26bb03b68f35e99d9012e67525">igps</a>=0; <span class="comment">// set gps position to be zero - we&#39;re at a fixed balloon position</span></div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        </div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;  }</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d2/d24/class_balloon.html#a81c68a6d332881cf4759a4bcca7dc48c">WHICHPATH</a>==5) { <span class="comment">// for slac?</span></div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    <a class="code" href="../../d2/d24/class_balloon.html#a4067df26bb03b68f35e99d9012e67525">igps</a>=0;</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    theta_bn=1.*RADDEG; <span class="comment">// 1deg</span></div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <a class="code" href="../../d2/d24/class_balloon.html#a6bf058d1320831ad733db4c5f9ce3cbe">phi_bn</a>=1.*RADDEG; <span class="comment">// 1deg</span></div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    <a class="code" href="../../d2/d24/class_balloon.html#a69f284427712f451a4c1c3756f168093">r_bn</a>=<a class="code" href="../../d7/d3b/class_position.html">Position</a>(theta_bn,<a class="code" href="../../d2/d24/class_balloon.html#a6bf058d1320831ad733db4c5f9ce3cbe">phi_bn</a>); <span class="comment">// sets r_bn</span></div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d2/d24/class_balloon.html#aae0a6056476d43b3e44bc9ddf3d66afd">BN_ALTITUDE</a>!=0)</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;      altitude_bn=<a class="code" href="../../d2/d24/class_balloon.html#aae0a6056476d43b3e44bc9ddf3d66afd">BN_ALTITUDE</a>; <span class="comment">// set the altitude of the balloon to be what you pick.  This isn&#39;t in time for CreateHorizons though!</span></div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    <a class="code" href="../../d2/d24/class_balloon.html#a82033268c70493ca7c6e850e82e8c49d">surface_under_balloon</a> = antarctica1-&gt;Surface(<a class="code" href="../../d2/d24/class_balloon.html#a69f284427712f451a4c1c3756f168093">r_bn</a>);</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    <a class="code" href="../../d2/d24/class_balloon.html#ae5a88658b80b1f027e5fe28a9d8144e8">r_bn_shadow</a> = <a class="code" href="../../d2/d24/class_balloon.html#a82033268c70493ca7c6e850e82e8c49d">surface_under_balloon</a> * <a class="code" href="../../d2/d24/class_balloon.html#a69f284427712f451a4c1c3756f168093">r_bn</a>.Unit();</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    <span class="comment">//    r_bn = (antarctica-&gt;Geoid(r_bn)+altitude_bn) * r_bn.Unit();</span></div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;        </div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    <a class="code" href="../../d2/d24/class_balloon.html#a69f284427712f451a4c1c3756f168093">r_bn</a> = (antarctica1-&gt;Surface(<a class="code" href="../../d2/d24/class_balloon.html#a69f284427712f451a4c1c3756f168093">r_bn</a>)+altitude_bn) * <a class="code" href="../../d2/d24/class_balloon.html#a69f284427712f451a4c1c3756f168093">r_bn</a>.Unit();</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;  } <span class="comment">// you pick it</span></div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d2/d24/class_balloon.html#a81c68a6d332881cf4759a4bcca7dc48c">WHICHPATH</a>==4){ <span class="comment">// for making comparison with Peter&#39;s event</span></div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    <span class="comment">//phi_bn=0.767945;</span></div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    <span class="comment">// phi_bn=0.95993;</span></div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    <span class="comment">//166.73 longitude</span></div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    <span class="comment">//    phi_bn=-1.339;// this is McM phi</span></div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    <span class="comment">// 156.73</span></div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    <a class="code" href="../../d2/d24/class_balloon.html#a6bf058d1320831ad733db4c5f9ce3cbe">phi_bn</a>=-1.1646;<span class="comment">// this is McM phi</span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    <span class="comment">//phi_bn=-0.523;</span></div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <span class="comment">// theta_bn has been set to 10 degrees in setdefaultballoonposition</span></div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    <span class="comment">// we want theta_bn to be on a path along same longitude as</span></div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    <span class="comment">// McM but up to 10 deg further south in latitude</span></div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    <span class="comment">// 12.12 deg. is McM</span></div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    <span class="keywordtype">double</span> theta_max=0.2115; <span class="comment">// this is McM theta</span></div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <span class="keywordtype">double</span> theta_min=0.2115-0.110; <span class="comment">// this approximately one horizon north of McM</span></div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    <span class="comment">//This is 701.59 km along the surface of the earth</span></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    <span class="keywordtype">int</span> npositions=1000; <span class="comment">// number of possible positions between those two bounds</span></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    theta_bn=theta_min+(theta_max-theta_min)*(<span class="keywordtype">double</span>)(inu%npositions)/(<span class="keywordtype">double</span>)npositions;</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        </div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    <a class="code" href="../../d2/d24/class_balloon.html#a69f284427712f451a4c1c3756f168093">r_bn</a> = <a class="code" href="../../d7/d3b/class_position.html">Position</a>(theta_bn,<a class="code" href="../../d2/d24/class_balloon.html#a6bf058d1320831ad733db4c5f9ce3cbe">phi_bn</a>);</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    <a class="code" href="../../d2/d24/class_balloon.html#a82033268c70493ca7c6e850e82e8c49d">surface_under_balloon</a> = antarctica1-&gt;Surface(<a class="code" href="../../d2/d24/class_balloon.html#a69f284427712f451a4c1c3756f168093">r_bn</a>);</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        </div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    <a class="code" href="../../d2/d24/class_balloon.html#ae5a88658b80b1f027e5fe28a9d8144e8">r_bn_shadow</a> = <a class="code" href="../../d2/d24/class_balloon.html#a82033268c70493ca7c6e850e82e8c49d">surface_under_balloon</a> * <a class="code" href="../../d2/d24/class_balloon.html#a69f284427712f451a4c1c3756f168093">r_bn</a>.Unit();</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    <span class="comment">//    r_bn = (antarctica-&gt;Geoid(r_bn)+altitude_bn) * r_bn.Unit();</span></div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        </div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    <a class="code" href="../../d2/d24/class_balloon.html#a69f284427712f451a4c1c3756f168093">r_bn</a> = (antarctica1-&gt;Surface(<a class="code" href="../../d2/d24/class_balloon.html#a69f284427712f451a4c1c3756f168093">r_bn</a>)+altitude_bn) * <a class="code" href="../../d2/d24/class_balloon.html#a69f284427712f451a4c1c3756f168093">r_bn</a>.Unit();</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    <a class="code" href="../../d2/d24/class_balloon.html#a4067df26bb03b68f35e99d9012e67525">igps</a>=0;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;  } <span class="comment">// comparing with Peter&#39;s event</span></div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    </div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    </div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    </div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;  ibnposition=<a class="code" href="../../d2/d24/class_balloon.html#a9d7ad805352db5a11ecd3acfddc27d44">Getibnposition</a>();</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    </div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;  <span class="keywordflow">if</span> (!settings1-&gt;UNBIASED_SELECTION &amp;&amp; <a class="code" href="../../d2/d24/class_balloon.html#a7542eed41dafcc761205c51a18e6eddf">dtryingposition</a>!=-999)</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    <a class="code" href="../../d2/d24/class_balloon.html#a7542eed41dafcc761205c51a18e6eddf">dtryingposition</a>=antarctica1-&gt;GetBalloonPositionWeight(ibnposition);</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (settings1-&gt;UNBIASED_SELECTION == 2)</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    <a class="code" href="../../d2/d24/class_balloon.html#a7542eed41dafcc761205c51a18e6eddf">dtryingposition</a>=1.;</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    </div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;  <a class="code" href="../../d2/d24/class_balloon.html#a72ef197fc6e4a463e7b066081ddc7527">phi_spin</a>=<a class="code" href="../../d2/d24/class_balloon.html#a3c333ec0bbf10e678cd86ee3bdad0f0d">GetBalloonSpin</a>(heading); <span class="comment">// get the azimuth of the balloon.</span></div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    </div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  <span class="comment">// normalized balloon position</span></div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;  <a class="code" href="../../d2/d24/class_balloon.html#ad62ec9ecbb5e88b701b6f38de01240c3">n_bn</a> = <a class="code" href="../../d2/d24/class_balloon.html#a69f284427712f451a4c1c3756f168093">r_bn</a>.Unit();</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    </div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;  <span class="comment">// finding which direction is east under the balloon</span></div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;  <a class="code" href="../../d2/d24/class_balloon.html#aadaf722446282e6a5022146ccafb8c4a">n_east</a> = <a class="code" href="../../d5/db2/class_vector.html">Vector</a>(sin(<a class="code" href="../../d2/d24/class_balloon.html#a6bf058d1320831ad733db4c5f9ce3cbe">phi_bn</a>), -1*cos(<a class="code" href="../../d2/d24/class_balloon.html#a6bf058d1320831ad733db4c5f9ce3cbe">phi_bn</a>), 0.);</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    </div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;  <span class="keywordflow">if</span> (settings1-&gt;SLAC)</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    <a class="code" href="../../d2/d24/class_balloon.html#a82787639a749dc17dee91fdf539f9deb">AdjustSlacBalloonPosition</a>(inu); <span class="comment">// move payload around like we did at slac</span></div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  <span class="comment">// find position of each antenna boresight</span></div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;   </div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;  <span class="comment">// now finding north</span></div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;  <a class="code" href="../../d2/d24/class_balloon.html#a379114e2cc17de2246dd14f5cb6febdf">n_north</a> = <a class="code" href="../../d2/d24/class_balloon.html#ad62ec9ecbb5e88b701b6f38de01240c3">n_bn</a>.Cross(<a class="code" href="../../d2/d24/class_balloon.html#aadaf722446282e6a5022146ccafb8c4a">n_east</a>);</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    </div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;  <span class="comment">// these coordinates are for filling ntuples.</span></div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;  <a class="code" href="../../d2/d24/class_balloon.html#aa66ff5dc8a3812aaf4e18300021adc15">horizcoord_bn</a>=<a class="code" href="../../d2/d24/class_balloon.html#a69f284427712f451a4c1c3756f168093">r_bn</a>[0]/1000.; <span class="comment">//m to km</span></div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;  <a class="code" href="../../d2/d24/class_balloon.html#a8dff2cae99ba8661c69438e604aebe00">vertcoord_bn</a>=<a class="code" href="../../d2/d24/class_balloon.html#a69f284427712f451a4c1c3756f168093">r_bn</a>[1]/1000.;</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    </div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;  <a class="code" href="../../d2/d24/class_balloon.html#a86fdedefec1f2925bb92c905c0952ede">calculate_antenna_positions</a>(settings1,anita1);</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;  <span class="keywordflow">if</span> (settings1-&gt;BORESIGHTS)</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    <a class="code" href="../../d2/d24/class_balloon.html#a78e22e4ce293cabeaa2a249d9932e772">GetBoresights</a>(settings1,anita1);</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    </div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    </div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;} <span class="comment">// end PickBalloonPosition</span></div><div class="line"><a name="l00627"></a><span class="lineno"><a class="line" href="../../d2/d24/class_balloon.html#a82787639a749dc17dee91fdf539f9deb">  627</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d2/d24/class_balloon.html#a82787639a749dc17dee91fdf539f9deb">Balloon::AdjustSlacBalloonPosition</a>(<span class="keywordtype">int</span> inu) { <span class="comment">// move payload around like we did at slac</span></div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    </div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;  <span class="keywordflow">if</span> (inu&lt;=<a class="code" href="../../d2/d24/class_balloon.html#a785d36ec34b42251921dfaf971a62cd5">MAX_POSITIONS</a>)  <span class="comment">// use the event number for the position if we c an</span></div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    islacposition=inu;</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    islacposition=0; <span class="comment">// otherwise just use the first positions</span></div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;  <span class="comment">// adjust the payload position</span></div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;  <a class="code" href="../../d2/d24/class_balloon.html#a69f284427712f451a4c1c3756f168093">r_bn</a>+=slacpositions[islacposition].GetX()*<a class="code" href="../../d2/d24/class_balloon.html#aadaf722446282e6a5022146ccafb8c4a">n_east</a></div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    +slacpositions[islacposition].GetY()*<a class="code" href="../../d2/d24/class_balloon.html#ad62ec9ecbb5e88b701b6f38de01240c3">n_bn</a>;</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    </div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;}</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;</div><div class="line"><a name="l00639"></a><span class="lineno"><a class="line" href="../../d2/d24/class_balloon.html#a30995e682b03d7ec9fba2d6f3f7e5529">  639</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d2/d24/class_balloon.html#a30995e682b03d7ec9fba2d6f3f7e5529">Balloon::CenterPayload</a>(<span class="keywordtype">double</span>&amp; hitangle_e) {</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    </div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;  <span class="comment">// allow an option to rotate the payload so the signal is</span></div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;  <span class="comment">// always on the boresight of one phi sector</span></div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    </div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;  <a class="code" href="../../d2/d24/class_balloon.html#a72ef197fc6e4a463e7b066081ddc7527">phi_spin</a>-=hitangle_e;</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    </div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;}</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;</div><div class="line"><a name="l00649"></a><span class="lineno"><a class="line" href="../../d2/d24/class_balloon.html#a9b958aae728e342a3e448b55b9d530b7">  649</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d2/d24/class_balloon.html#a9b958aae728e342a3e448b55b9d530b7">Balloon::GetAntennaOrientation</a>(<a class="code" href="../../db/d2b/class_settings.html">Settings</a> *settings1, <a class="code" href="../../df/da2/class_anita.html">Anita</a> *anita1, <span class="keywordtype">int</span> ilayer, <span class="keywordtype">int</span> ifold, <a class="code" href="../../d5/db2/class_vector.html">Vector</a>&amp; n_eplane, <a class="code" href="../../d5/db2/class_vector.html">Vector</a>&amp; n_hplane, <a class="code" href="../../d5/db2/class_vector.html">Vector</a>&amp; n_normal){</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  <span class="comment">// rotate for antenna&#39;s orientation on payload</span></div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;  <span class="comment">// face of antenna starts out relative to +x because phi is relative to +x</span></div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;  <span class="comment">// n_normal points northwards for antenna 0 (0-31)</span></div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;  <span class="comment">// const vectors const_z (n_eplane), const_y (-n_hplane), const_x (n_normal) defined under Constants.h   -- oindree</span></div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;  <span class="keywordflow">if</span>(settings1-&gt;WHICH==6 || settings1-&gt;WHICH==8 || settings1-&gt;WHICH==9 || settings1-&gt;WHICH==10) {</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    n_eplane = const_z.RotateY(anita1-&gt;<a class="code" href="../../df/da2/class_anita.html#a0ba1b8d8c13ed0540efe34c51f04ffd4">ANTENNA_DOWN</a>[ilayer][ifold]);</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    n_hplane = (-const_y).RotateY(anita1-&gt;<a class="code" href="../../df/da2/class_anita.html#a0ba1b8d8c13ed0540efe34c51f04ffd4">ANTENNA_DOWN</a>[ilayer][ifold]);</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    n_normal = const_x.RotateY(anita1-&gt;<a class="code" href="../../df/da2/class_anita.html#a0ba1b8d8c13ed0540efe34c51f04ffd4">ANTENNA_DOWN</a>[ilayer][ifold]);</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;  }</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    n_eplane = const_z.RotateY(anita1-&gt;<a class="code" href="../../df/da2/class_anita.html#a7c3129627c6e17ad7cd6b3481dd5d205">THETA_ZENITH</a>[ilayer] - PI/2);</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    n_hplane = (-const_y).RotateY(anita1-&gt;<a class="code" href="../../df/da2/class_anita.html#a7c3129627c6e17ad7cd6b3481dd5d205">THETA_ZENITH</a>[ilayer] - PI/2);</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    n_normal = const_x.RotateY(anita1-&gt;<a class="code" href="../../df/da2/class_anita.html#a7c3129627c6e17ad7cd6b3481dd5d205">THETA_ZENITH</a>[ilayer] - PI/2);</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;  }</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;     </div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    </div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;  <span class="keywordtype">double</span> phi;</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;  <span class="comment">// rotate about z axis for phi</span></div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;  <span class="keywordflow">if</span> (settings1-&gt;CYLINDRICALSYMMETRY==1) {</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    phi=(double)ifold/(<span class="keywordtype">double</span>)anita1-&gt;<a class="code" href="../../df/da2/class_anita.html#a470613ae9031d09fd76c7af393dbd556">NRX_PHI</a>[ilayer]*2*PI + anita1-&gt;<a class="code" href="../../df/da2/class_anita.html#a6d3e7a6c08dd0f1d3f493b2f879aacc9">PHI_OFFSET</a>[ilayer] + <a class="code" href="../../d2/d24/class_balloon.html#a72ef197fc6e4a463e7b066081ddc7527">phi_spin</a>;</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;  }</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;  <span class="keywordflow">else</span>{</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    <span class="comment">//phi=anita1-&gt;PHI_EACHLAYER[ilayer][ifold] + anita1-&gt;PHI_OFFSET[ilayer] +phi_spin;</span></div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    phi=anita1-&gt;<a class="code" href="../../df/da2/class_anita.html#a77fd97662b6459c8e96d04d7554e93f8">PHI_EACHLAYER</a>[ilayer][ifold];</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;  }</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;        </div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;  n_eplane = n_eplane.RotateZ(phi);</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;  n_hplane = n_hplane.RotateZ(phi);</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;  n_normal = n_normal.RotateZ(phi);</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;   </div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;  n_eplane = <a class="code" href="../../d2/d24/class_balloon.html#ab9fd0ffce4b8bbb8dc23f8636d741e4d">RotatePayload</a>(n_eplane); </div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;  n_hplane = <a class="code" href="../../d2/d24/class_balloon.html#ab9fd0ffce4b8bbb8dc23f8636d741e4d">RotatePayload</a>(n_hplane);</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;  n_normal = <a class="code" href="../../d2/d24/class_balloon.html#ab9fd0ffce4b8bbb8dc23f8636d741e4d">RotatePayload</a>(n_normal);</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;} <span class="comment">//end void GetAntennaOrientation</span></div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;</div><div class="line"><a name="l00690"></a><span class="lineno"><a class="line" href="../../d2/d24/class_balloon.html#ac3081c89e7f41389590e683659a69fc5">  690</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d2/d24/class_balloon.html#ac3081c89e7f41389590e683659a69fc5">Balloon::GetEcompHcompkvector</a>(<a class="code" href="../../d5/db2/class_vector.html">Vector</a> n_eplane, <a class="code" href="../../d5/db2/class_vector.html">Vector</a> n_hplane, <a class="code" href="../../d5/db2/class_vector.html">Vector</a> n_normal, <span class="keyword">const</span> <a class="code" href="../../d5/db2/class_vector.html">Vector</a> n_exit2bn, <span class="keywordtype">double</span>&amp; e_component_kvector, <span class="keywordtype">double</span>&amp; h_component_kvector, <span class="keywordtype">double</span>&amp; n_component_kvector){</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    </div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;     </div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;  <span class="comment">// find component along e-plane for the purpose of finding hit angles, that is, in direction of k vector, direction of radio wave)</span></div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;  e_component_kvector = -(n_exit2bn * n_eplane);</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;  <span class="comment">// find component along h-plane for the purpose of finding hit angles, that is, in direction of k vector, direction of radio wave)</span></div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;  h_component_kvector = -(n_exit2bn * n_hplane);</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;  <span class="comment">// find the component normal</span></div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;  n_component_kvector = -(n_exit2bn * n_normal);</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;} <span class="comment">// end GetEcompHcompkvector</span></div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;</div><div class="line"><a name="l00704"></a><span class="lineno"><a class="line" href="../../d2/d24/class_balloon.html#adbfe896855ef550c9a3c5c1fecc1b502">  704</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d2/d24/class_balloon.html#adbfe896855ef550c9a3c5c1fecc1b502">Balloon::GetEcompHcompEvector</a>(<a class="code" href="../../db/d2b/class_settings.html">Settings</a> *settings1, <a class="code" href="../../d5/db2/class_vector.html">Vector</a> n_eplane, <a class="code" href="../../d5/db2/class_vector.html">Vector</a> n_hplane, <span class="keyword">const</span> <a class="code" href="../../d5/db2/class_vector.html">Vector</a> n_pol, <span class="keywordtype">double</span>&amp; e_component, <span class="keywordtype">double</span>&amp; h_component, <span class="keywordtype">double</span>&amp; n_component){</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;  <span class="comment">// find component along e-plane in direction of polarization, that is in direction of the E field   </span></div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;  e_component = n_pol*n_eplane;</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;  <span class="comment">//    std::cout &lt;&lt; &quot;n_component : &quot; &lt;&lt; n_exit2bn &lt;&lt; &quot; &quot; &lt;&lt; n_normal &lt;&lt; &quot; &quot; &lt;&lt; n_component &lt;&lt; std::endl;</span></div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    </div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;  <span class="comment">// find component along h-plane in direction of polarization, that is in direction of the E field </span></div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;  h_component = n_pol*n_hplane;</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;  <span class="keywordflow">if</span> (settings1-&gt;REMOVEPOLARIZATION) {</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    <span class="comment">//Trying to remove effects of polarization at antenna. Stephen</span></div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    e_component = n_pol * n_pol;</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    h_component = 0.001;</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    n_component = 0.001;</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;  } <span class="comment">//if</span></div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;} <span class="comment">// end GetEcompHcompEvector</span></div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;</div><div class="line"><a name="l00726"></a><span class="lineno"><a class="line" href="../../d2/d24/class_balloon.html#a84fdc4c1b807ce01c41c0fb5a40ba4c5">  726</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d2/d24/class_balloon.html#a84fdc4c1b807ce01c41c0fb5a40ba4c5">Balloon::GetHitAngles</a>(<span class="keywordtype">double</span> e_component_kvector, <span class="keywordtype">double</span> h_component_kvector, <span class="keywordtype">double</span> n_component_kvector, <span class="keywordtype">double</span>&amp; hitangle_e, <span class="keywordtype">double</span>&amp; hitangle_h) {</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;<span class="preprocessor">#if defined(ANITA_UTIL_EXISTS) and defined(VECTORIZE)</span></div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;  Vec2d y(e_component_kvector, h_component_kvector); </div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;  Vec2d x(n_component_kvector, n_component_kvector); </div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;  Vec2d answer = atan2(y,x); </div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;  hitangle_h = answer[0]; </div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;  hitangle_e = answer[1]; </div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;  hitangle_e=atan2(h_component_kvector,n_component_kvector);</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;  hitangle_h=atan2(e_component_kvector,n_component_kvector);</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;        </div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;} <span class="comment">//end void GetHitAngles</span></div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;</div><div class="line"><a name="l00742"></a><span class="lineno"><a class="line" href="../../d2/d24/class_balloon.html#a1298f31799a3b6a8e29ebe709dfe4e05">  742</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d2/d24/class_balloon.html#a1298f31799a3b6a8e29ebe709dfe4e05">Balloon::setr_bn</a>(<span class="keywordtype">double</span> latitude,<span class="keywordtype">double</span> longitude) {</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    </div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;  <span class="comment">// latitude is between -90 and 0.</span></div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;  <span class="comment">// theta_bn measured from the SP and is between 0 and PI/2.</span></div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;  theta_bn=(90+latitude)*RADDEG;</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    </div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;  <span class="comment">// this is the payload&#39;s longitude, not the azimuth of the balloon like it sounds.</span></div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;  <span class="comment">// longitude is between -180 to 180 with 0 at prime meridian</span></div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;  <span class="comment">// phi is from 0 to 360 with 0 at +90 longitude</span></div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;  <a class="code" href="../../d2/d24/class_balloon.html#a6bf058d1320831ad733db4c5f9ce3cbe">phi_bn</a>=(-1*longitude+90.);</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    </div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d2/d24/class_balloon.html#a6bf058d1320831ad733db4c5f9ce3cbe">phi_bn</a>&lt;0)</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;    <a class="code" href="../../d2/d24/class_balloon.html#a6bf058d1320831ad733db4c5f9ce3cbe">phi_bn</a>+=360.;</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    </div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;  <a class="code" href="../../d2/d24/class_balloon.html#a6bf058d1320831ad733db4c5f9ce3cbe">phi_bn</a>*=RADDEG;</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    </div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;  <a class="code" href="../../d2/d24/class_balloon.html#a69f284427712f451a4c1c3756f168093">r_bn</a> = <a class="code" href="../../d7/d3b/class_position.html">Position</a>(theta_bn,<a class="code" href="../../d2/d24/class_balloon.html#a6bf058d1320831ad733db4c5f9ce3cbe">phi_bn</a>);  <span class="comment">//r_bn is a unit vector pointing in the right direction</span></div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;}</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;</div><div class="line"><a name="l00762"></a><span class="lineno"><a class="line" href="../../d2/d24/class_balloon.html#a694b260dc39659a04bc32d92cad72ad8">  762</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d2/d24/class_balloon.html#a694b260dc39659a04bc32d92cad72ad8">Balloon::PickDownwardInteractionPoint</a>(<a class="code" href="../../d3/d8e/class_interaction.html">Interaction</a> *interaction1, <a class="code" href="../../df/da2/class_anita.html">Anita</a> *anita1, <a class="code" href="../../db/d2b/class_settings.html">Settings</a> *settings1, <a class="code" href="../../de/d63/class_ice_model.html">IceModel</a> *antarctica1, <a class="code" href="../../d2/d1f/class_ray.html">Ray</a> *ray1, <span class="keywordtype">int</span> &amp;beyondhorizon, <span class="keywordtype">double</span> len_int_kgm2, <a class="code" href="../../d5/db2/class_vector.html">Vector</a> * force_dir) {</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    </div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;  <span class="comment">// double distance=1.E7;</span></div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;  <span class="keywordtype">double</span> phi=0,theta=0;</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;  <span class="keywordtype">double</span> lon=0;</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;  <span class="keywordtype">double</span> latfromSP=0;</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;  </div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;  </div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;  <span class="keywordflow">if</span> (settings1-&gt;UNBIASED_SELECTION&gt;=1) {</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    <span class="keywordflow">if</span> ( (settings1-&gt;UNBIASED_SELECTION == 1 &amp;&amp; antarctica1-&gt;PickUnbiased(interaction1,len_int_kgm2,<a class="code" href="../../d2/d24/class_balloon.html#a7542eed41dafcc761205c51a18e6eddf">dtryingposition</a>,settings1-&gt;UNBIASED_CHORD_STEP_M, force_dir)) ||</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;         (settings1-&gt;UNBIASED_SELECTION == 2 &amp;&amp; antarctica1-&gt;PickUnbiasedPointSourceNearBalloon(interaction1,&amp;<a class="code" href="../../d2/d24/class_balloon.html#a69f284427712f451a4c1c3756f168093">r_bn</a>, </div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                                                                                     settings1-&gt;UNBIASED_PS_MAX_DISTANCE_KM,</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;                                                                                     settings1-&gt;UNBIASED_CHORD_STEP_M, </div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;                                                                                     len_int_kgm2,force_dir))  )</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    { <span class="comment">// pick neutrino direction and interaction point</span></div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;          interaction1-&gt;<a class="code" href="../../d3/d8e/class_interaction.html#a442362e66d0fe0fe0bc6f1d8807aa4e5">dtryingdirection</a>=1.;</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;          interaction1-&gt;<a class="code" href="../../d3/d8e/class_interaction.html#ab558b148fa334b3b1522a68f6273b954">iceinteraction</a>=1;</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    }</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    {</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;       interaction1-&gt;<a class="code" href="../../d3/d8e/class_interaction.html#ab558b148fa334b3b1522a68f6273b954">iceinteraction</a>=0;</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;       interaction1-&gt;<a class="code" href="../../d3/d8e/class_interaction.html#a1c6e9aa72103431cd124bdce1fcad885">d_effective_area</a> = 0; </div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    }</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    interaction1-&gt;<a class="code" href="../../d3/d8e/class_interaction.html#a1c6e9aa72103431cd124bdce1fcad885">d_effective_area</a> = 0;</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    interaction1-&gt;<a class="code" href="../../d3/d8e/class_interaction.html#ab558b148fa334b3b1522a68f6273b954">iceinteraction</a>=1;</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d2/d24/class_balloon.html#a81c68a6d332881cf4759a4bcca7dc48c">WHICHPATH</a>==3) { <span class="comment">//Force interaction point if we want to make a banana plot</span></div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;      interaction1-&gt;posnu = interaction1-&gt;<a class="code" href="../../d3/d8e/class_interaction.html#aa2dcd4c8539fa3ef312c54090682eb82">nu_banana</a>;</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    } <span class="comment">//if (making banana plot)</span></div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d2/d24/class_balloon.html#a81c68a6d332881cf4759a4bcca7dc48c">WHICHPATH</a>==4) {<span class="comment">// Force interaction point for comparison with Peter.</span></div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;      </div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;      <span class="comment">// want interaction location at Taylor Dome</span></div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;      <span class="comment">// According to lab book it&#39;s 77 deg, 52.818&#39; S=77.8803</span></div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;      <span class="comment">// 158 deg, 27.555&#39; east=158.45925</span></div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;      latfromSP=12.1197; <span class="comment">// this is degrees latitude from the south pole</span></div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;      <span class="comment">//lon=180.+166.73;</span></div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;      lon=180.+158.45925;</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;      <span class="comment">//lon=180.+120.</span></div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;      phi=EarthModel::LongtoPhi_0is180thMeridian(lon);</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;      </div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;      theta = latfromSP*RADDEG;</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;      </div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;      <span class="keywordtype">double</span> elevation=antarctica1-&gt;SurfaceAboveGeoid(lon,latfromSP)-500.;</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;      </div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;      interaction1-&gt;posnu = <a class="code" href="../../d5/db2/class_vector.html">Vector</a>((elevation+antarctica1-&gt;Geoid(latfromSP))*sin(theta)*cos(phi),(elevation+antarctica1-&gt;Geoid(latfromSP))*sin(theta)*sin(phi),(elevation+antarctica1-&gt;Geoid(latfromSP))*cos(theta));</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;            </div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;      </div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;      </div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    } <span class="comment">//if (WHICHPATH==4)</span></div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    </div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (settings1-&gt;SLAC) {</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;      </div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;      <a class="code" href="../../d5/db2/class_vector.html">Vector</a> zaxis(0.,0.,1.); <span class="comment">// start with vector pointing in the +z direction</span></div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;      </div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;      interaction1-&gt;posnu=zaxis.RotateY(<a class="code" href="../../d2/d24/class_balloon.html#a69f284427712f451a4c1c3756f168093">r_bn</a>.Theta()-settings1-&gt;SLAC_HORIZDIST/EarthModel::R_EARTH); <span class="comment">// rotate to theta of balloon, less the distance from the interaction to the balloon</span></div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;      </div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;      interaction1-&gt;posnu=interaction1-&gt;posnu.RotateZ(<a class="code" href="../../d2/d24/class_balloon.html#a69f284427712f451a4c1c3756f168093">r_bn</a>.Phi()); <span class="comment">// rotate to phi of the balloon</span></div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;      </div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;      interaction1-&gt;posnu=(antarctica1-&gt;Surface(interaction1-&gt;posnu)-settings1-&gt;SLAC_DEPTH)*interaction1-&gt;posnu; <span class="comment">// put the interaction position at depth settings1-&gt;SLAC_DEPTH in the ice</span></div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;      </div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    }</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    <span class="keywordflow">else</span>{</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;      <span class="comment">// If we require neutrinos from a particular position</span></div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;      <span class="comment">// we generate that cartesian position here</span></div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;      <span class="keyword">static</span> <a class="code" href="../../d7/d3b/class_position.html">Position</a> specific_position(settings1-&gt;SPECIFIC_NU_POSITION_LONGITUDE, 90 + settings1-&gt;SPECIFIC_NU_POSITION_LATITUDE, settings1-&gt;SPECIFIC_NU_POSITION_ALTITUDE + antarctica1-&gt;Geoid(settings1-&gt;SPECIFIC_NU_POSITION_LATITUDE)); </div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;        </div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;      <span class="keywordtype">int</span> nattempts = 0; </div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;      <span class="keywordflow">do</span></div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;      {</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;        interaction1-&gt;posnu = antarctica1-&gt;PickInteractionLocation(ibnposition, settings1, <a class="code" href="../../d2/d24/class_balloon.html#a69f284427712f451a4c1c3756f168093">r_bn</a>, interaction1);</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;    <span class="comment">//  std::cout &lt;&lt; nattempts &lt;&lt;&quot;:&quot; &lt;&lt; specific_position &lt;&lt; &quot; / &quot; &lt;&lt;  interaction1-&gt;posnu &lt;&lt; &quot; | &quot; &lt;&lt;  interaction1-&gt;posnu.Distance(specific_position) &lt;&lt; std::endl; </span></div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;        nattempts++; </div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;      } <span class="keywordflow">while</span>(settings1-&gt;SPECIFIC_NU_POSITION &amp;&amp;  interaction1-&gt;posnu.<a class="code" href="../../d7/d3b/class_position.html#a68bbe0fdc40d3d380f633a88735f212e">Distance</a>(specific_position) &gt; settings1-&gt;SPECIFIC_NU_POSITION_DISTANCE  &amp;&amp; nattempts&lt;100000000); </div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;      <span class="comment">// printf(&quot;====Took %d attempts to find a position====\n&quot;, nattempts); </span></div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    }</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;  }</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;  </div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;  <span class="comment">//cout&lt;&lt;interaction1-&gt;posnu&lt;&lt;&quot;  &quot;&lt;&lt;r_bn&lt;&lt;&quot; :: &quot;&lt;&lt;r_bn.Distance(interaction1-&gt;posnu)&lt;&lt;&quot;\n&quot;;</span></div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;  <span class="comment">// if (interaction1-&gt;iceinteraction) {</span></div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;  <span class="comment">//   //cout &lt;&lt; &quot;posnu is &quot;;interaction1-&gt;posnu.Print();</span></div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;  <span class="comment">// }</span></div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;  <span class="comment">// first guess at the rf exit point is just the point on the surface directly above the interaction</span></div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;  ray1-&gt;rfexit[0] = antarctica1-&gt;Surface(interaction1-&gt;posnu) * interaction1-&gt;posnu.Unit();  </div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;  </div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;  <span class="comment">// unit vector pointing to antenna from exit point.</span></div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;  ray1-&gt;n_exit2bn[0] = (<a class="code" href="../../d2/d24/class_balloon.html#a69f284427712f451a4c1c3756f168093">r_bn</a> - ray1-&gt;rfexit[0]).Unit();</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;  </div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;  <span class="keywordflow">if</span> (settings1-&gt;BORESIGHTS) {</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ilayer=0;ilayer&lt;settings1-&gt;NLAYERS;ilayer++) {</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ifold=0;ifold&lt;anita1-&gt;<a class="code" href="../../df/da2/class_anita.html#a470613ae9031d09fd76c7af393dbd556">NRX_PHI</a>[ilayer];ifold++) {</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    ray1-&gt;rfexit_eachboresight[0][ilayer][ifold]=antarctica1-&gt;Surface(interaction1-&gt;posnu) * interaction1-&gt;posnu.Unit();<span class="comment">// this first guess rfexit is the same for all antennas too</span></div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    ray1-&gt;n_exit2bn_eachboresight[0][ilayer][ifold]=(<a class="code" href="../../d2/d24/class_balloon.html#a27d12f9572a932f50bc87069697fe63f">r_boresights</a>[ilayer][ifold]- ray1-&gt;rfexit_eachboresight[0][ilayer][ifold]).Unit();</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    <span class="comment">// cout &lt;&lt; &quot;ilayer, ifold, n_exit2bn are &quot; &lt;&lt; ilayer &lt;&lt; &quot;\t&quot; &lt;&lt; ifold &lt;&lt; &quot; &quot;;</span></div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;      }</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    }</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;  }</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;  </div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;  <span class="comment">// first pass at direction of vector from interaction to exit point</span></div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;  <span class="comment">// just make the ray go radially outward away from center of earth.</span></div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;  <span class="comment">// still for first guess</span></div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;  <span class="comment">// should incorporate this into PickInteractionPoint</span></div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;  ray1-&gt;nrf_iceside[0] = interaction1-&gt;posnu.Unit();</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;  </div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;  <span class="keywordflow">if</span> (settings1-&gt;BORESIGHTS) {</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    <span class="comment">// this is the same for all of the antennas too</span></div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ilayer=0;ilayer&lt;settings1-&gt;NLAYERS;ilayer++) { <span class="comment">// loop over layers on the payload</span></div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ifold=0;ifold&lt;anita1-&gt;<a class="code" href="../../df/da2/class_anita.html#a470613ae9031d09fd76c7af393dbd556">NRX_PHI</a>[ilayer];ifold++) {</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    </div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    ray1-&gt;nrf_iceside_eachboresight[0][ilayer][ifold]=interaction1-&gt;posnu.Unit();</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;      } <span class="comment">// end loop over fold</span></div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    } <span class="comment">// end loop over payload layers</span></div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;  } <span class="comment">// end if boresights</span></div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;  </div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;  </div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;  </div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;  </div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;  <span class="keywordtype">double</span> r_down = 2*(antarctica1-&gt;Surface(interaction1-&gt;posnu)-antarctica1-&gt;IceThickness(interaction1-&gt;posnu))-interaction1-&gt;posnu.Mag();</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;  interaction1-&gt;posnu_down = r_down * interaction1-&gt;posnu.Unit();</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;  <span class="comment">//position of the mirror point of interaction</span></div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;  </div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;  <span class="comment">//interaction1-&gt;posnu is downward interaction1-&gt;posnu.</span></div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;  <span class="comment">// distance=interaction1-&gt;posnu.Distance(r_bn);</span></div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;  </div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;  </div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;  <span class="comment">// depth of interaction</span></div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;  <span class="comment">// gets distance between interaction and exit point, this time it&#39;s same as depth</span></div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;  <span class="comment">// because our first guess at exit point is radially outward from interaction.</span></div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;  <span class="comment">// negative means below surface</span></div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;  interaction1-&gt;<a class="code" href="../../d3/d8e/class_interaction.html#a0df23bdc40b2d92b95b0d6029f374edc">altitude_int</a>=-1*ray1-&gt;rfexit[0].<a class="code" href="../../d7/d3b/class_position.html#a68bbe0fdc40d3d380f633a88735f212e">Distance</a>(interaction1-&gt;posnu);</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;  interaction1-&gt;<a class="code" href="../../d3/d8e/class_interaction.html#a6e9ad2ed02dd253db92aa8bd344f057e">altitude_int_mirror</a>=-1*ray1-&gt;rfexit[0].<a class="code" href="../../d7/d3b/class_position.html#a68bbe0fdc40d3d380f633a88735f212e">Distance</a>(interaction1-&gt;posnu_down);<span class="comment">//get depth of mirror point</span></div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;  </div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;  </div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;  interaction1-&gt;<a class="code" href="../../d3/d8e/class_interaction.html#a15b1f5258dcfc709bfc401f293e5d12a">r_fromballoon</a>[0]=<a class="code" href="../../d2/d24/class_balloon.html#a69f284427712f451a4c1c3756f168093">r_bn</a>.<a class="code" href="../../d7/d3b/class_position.html#a68bbe0fdc40d3d380f633a88735f212e">Distance</a>(interaction1-&gt;posnu);</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;  </div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;  <span class="comment">//distance from the mirror point to the balloon because it is equal to the path that signals pass</span></div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;  interaction1-&gt;<a class="code" href="../../d3/d8e/class_interaction.html#a15b1f5258dcfc709bfc401f293e5d12a">r_fromballoon</a>[1]=<a class="code" href="../../d2/d24/class_balloon.html#a69f284427712f451a4c1c3756f168093">r_bn</a>.<a class="code" href="../../d7/d3b/class_position.html#a68bbe0fdc40d3d380f633a88735f212e">Distance</a>(interaction1-&gt;posnu_down);</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;  </div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;  </div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;  <span class="comment">// std::cout &lt;&lt; (interaction1-&gt;posnu) &lt;&lt; std::endl;</span></div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;  <span class="keywordflow">if</span> (ray1-&gt;n_exit2bn[0].Angle(interaction1-&gt;posnu) &gt; PI/2  &amp;&amp; !(<a class="code" href="../../d2/d24/class_balloon.html#a81c68a6d332881cf4759a4bcca7dc48c">WHICHPATH</a>==3 || <a class="code" href="../../d2/d24/class_balloon.html#a81c68a6d332881cf4759a4bcca7dc48c">WHICHPATH</a>==4))</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    beyondhorizon = 1;</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;  </div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;  </div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;  <span class="keywordflow">return</span>;</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;}<span class="comment">//PickDownwardInteractionPoint</span></div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;</div><div class="line"><a name="l00917"></a><span class="lineno"><a class="line" href="../../d2/d24/class_balloon.html#a4dd01bbfe671c53d6286b6ca6a327354">  917</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d2/d24/class_balloon.html#a4dd01bbfe671c53d6286b6ca6a327354">Balloon::GetSlacPositions</a>(<a class="code" href="../../df/da2/class_anita.html">Anita</a> *anita1) {</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    </div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;  sslacpositions[0]=<span class="stringliteral">&quot;phi 4-5&quot;</span>;</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;  slacpositions[0]=<a class="code" href="../../d5/db2/class_vector.html">Vector</a>(0.3,179.7,223.8);</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    </div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;  sslacpositions[1]=<span class="stringliteral">&quot;phi 1, start location&quot;</span>;</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;  slacpositions[1]=<a class="code" href="../../d5/db2/class_vector.html">Vector</a>(3.1,158.8,222.3);</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    </div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;  sslacpositions[2]=<span class="stringliteral">&quot;phi 13, start location&quot;</span>;</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;  slacpositions[2]=<a class="code" href="../../d5/db2/class_vector.html">Vector</a>(3.5,158.4,226.2);</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    </div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;  sslacpositions[3]=<span class="stringliteral">&quot;phi 9, start location&quot;</span>;</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;  slacpositions[3]=<a class="code" href="../../d5/db2/class_vector.html">Vector</a>(8.9,158.2,225.6);</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    </div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;  sslacpositions[4]=<span class="stringliteral">&quot;phi 5, start location&quot;</span>;</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;  slacpositions[4]=<a class="code" href="../../d5/db2/class_vector.html">Vector</a>(6.0,157.2,219.6);</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    </div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;  sslacpositions[5]=<span class="stringliteral">&quot;phi 1, X=0, Y=2m&quot;</span>;</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;  slacpositions[5]=<a class="code" href="../../d5/db2/class_vector.html">Vector</a>(1.3,233.8,221.0);</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    </div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;  sslacpositions[6]=<span class="stringliteral">&quot;phi 13 X=0, Y=0&quot;</span>;</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;  slacpositions[6]=<a class="code" href="../../d5/db2/class_vector.html">Vector</a>(5.4,154.4,226.2);</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;    </div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;  sslacpositions[7]=<span class="stringliteral">&quot;phi 13, X=3m, Y=0&quot;</span>;</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;  slacpositions[7]=<a class="code" href="../../d5/db2/class_vector.html">Vector</a>(107.3,150.5,226.7);</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;    </div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;  sslacpositions[8]=<span class="stringliteral">&quot;phi 5, X=3m, Y=0&quot;</span>;</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;  slacpositions[8]=<a class="code" href="../../d5/db2/class_vector.html">Vector</a>(110.4,144.6,220.1);</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;    </div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;  sslacpositions[9]=<span class="stringliteral">&quot;phi 1, left ant. at X=0&quot;</span>;</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;  slacpositions[9]=<a class="code" href="../../d5/db2/class_vector.html">Vector</a>(104.7,147.8,223.2);</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    </div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;  sslacpositions[10]=<span class="stringliteral">&quot;phi 1, Y=2m, left ant at X=0&quot;</span>;</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;  slacpositions[10]=<a class="code" href="../../d5/db2/class_vector.html">Vector</a>(104.8,232.4,220.8);</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    </div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;  sslacpositions[11]=<span class="stringliteral">&quot;phi 13, Y=2m, left ant at X=0&quot;</span>;</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;  slacpositions[11]=<a class="code" href="../../d5/db2/class_vector.html">Vector</a>(104.1,233.1,225.5);</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    </div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;  sslacpositions[12]=<span class="stringliteral">&quot;phi 1, Y=0, right ant at X=0&quot;</span>;</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;  slacpositions[12]=<a class="code" href="../../d5/db2/class_vector.html">Vector</a>(-102.5,155.8,222.5);</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    </div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;  sslacpositions[13]=<span class="stringliteral">&quot;phi 13, right ant at X=0&quot;</span>;</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;  slacpositions[13]=<a class="code" href="../../d5/db2/class_vector.html">Vector</a>(-101.6,157.0,230.4);</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    </div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;  sslacpositions[14]=<span class="stringliteral">&quot;phi 13, X=0, Y=-2m&quot;</span>;</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;  slacpositions[14]=<a class="code" href="../../d5/db2/class_vector.html">Vector</a>(1.7,81.3,230.6);</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    </div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;  sslacpositions[15]=<span class="stringliteral">&quot;phi 13, X=3m, Y=-2m&quot;</span>;</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;  slacpositions[15]=<a class="code" href="../../d5/db2/class_vector.html">Vector</a>(103.1,82.4,231.2);</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;    </div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;  sslacpositions[16]=<span class="stringliteral">&quot;phi 3, X=0, Y=0&quot;</span>;</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;  slacpositions[16]=<a class="code" href="../../d5/db2/class_vector.html">Vector</a>(-0.5,156.1,225.8);</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;    </div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;  sslacpositions[17]=<span class="stringliteral">&quot;phi 7, X=0, Y=0&quot;</span>;</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;  slacpositions[17]=<a class="code" href="../../d5/db2/class_vector.html">Vector</a>(3.3,157.3,226.7);</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;    </div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;  sslacpositions[18]=<span class="stringliteral">&quot;phi 11, X=0, Y=0&quot;</span>;</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;  slacpositions[18]=<a class="code" href="../../d5/db2/class_vector.html">Vector</a>(2.2,159.2,230.0);</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    </div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;  sslacpositions[19]=<span class="stringliteral">&quot;phi 15, X=0, Y=0&quot;</span>;</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;  slacpositions[19]=<a class="code" href="../../d5/db2/class_vector.html">Vector</a>(-1.8,158.8,228.5);</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    </div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;  sslacpositions[20]=<span class="stringliteral">&quot;phi 13, X=0, Y=2m&quot;</span>;</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;  slacpositions[20]=<a class="code" href="../../d5/db2/class_vector.html">Vector</a>(-2.5,237.0,229.7);</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;    </div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;  sslacpositions[21]=<span class="stringliteral">&quot;phi 13, X=-3m, Y=2m&quot;</span>;</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;  slacpositions[21]=<a class="code" href="../../d5/db2/class_vector.html">Vector</a>(-109.8,237.4,229.2);</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;    </div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;  sslacpositions[22]=<span class="stringliteral">&quot;phi 13, X=-3m, Y=-2m&quot;</span>;</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;  slacpositions[22]=<a class="code" href="../../d5/db2/class_vector.html">Vector</a>(-101.8,88.7,231.4);</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    </div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;  sslacpositions[22]=<span class="stringliteral">&quot;phi 14, X=0m, Y=0m&quot;</span>;</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;  slacpositions[22]=<a class="code" href="../../d5/db2/class_vector.html">Vector</a>(-0.8,160.4,228.2);</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    </div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;  sslacpositions[23]=<span class="stringliteral">&quot;phi 2, X=0m, Y=0m&quot;</span>;</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;  slacpositions[23]=<a class="code" href="../../d5/db2/class_vector.html">Vector</a>(2.4,158.9,225.7);</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    </div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;  sslacpositions[24]=<span class="stringliteral">&quot;phi 6, X=0m, Y=0m&quot;</span>;</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;  slacpositions[24]=<a class="code" href="../../d5/db2/class_vector.html">Vector</a>(5.5,158.2,223.6);</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    </div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;  sslacpositions[25]=<span class="stringliteral">&quot;phi 10, X=0m, Y=0m&quot;</span>;</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;  slacpositions[25]=<a class="code" href="../../d5/db2/class_vector.html">Vector</a>(5.9,160.3,228.2);</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    </div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;  sslacpositions[26]=<span class="stringliteral">&quot;phi 12, X=0m, Y=0m&quot;</span>;</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;  slacpositions[26]=<a class="code" href="../../d5/db2/class_vector.html">Vector</a>(3.1,160.5,230.4);</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;    </div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;  sslacpositions[27]=<span class="stringliteral">&quot;phi 8, X=0m, Y=0m&quot;</span>;</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;  slacpositions[27]=<a class="code" href="../../d5/db2/class_vector.html">Vector</a>(6.7,159.7,226.7);</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;    </div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;  sslacpositions[28]=<span class="stringliteral">&quot;phi 4, X=0m, Y=0m&quot;</span>;</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;  slacpositions[28]=<a class="code" href="../../d5/db2/class_vector.html">Vector</a>(4.5,157.8,224.1);</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;    </div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;  sslacpositions[29]=<span class="stringliteral">&quot;phi 16, X=0m, Y=0m&quot;</span>;</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;  slacpositions[29]=<a class="code" href="../../d5/db2/class_vector.html">Vector</a>(1.4,159.4,227.3);</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;    </div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;  sslacpositions[30]=<span class="stringliteral">&quot;phi 13, X=0m, Y=-6m&quot;</span>;</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;  slacpositions[30]=<a class="code" href="../../d5/db2/class_vector.html">Vector</a>(3.5,21.1,231.1);</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;    </div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;  <span class="comment">// if you add any positions, be sure the change the number in the next line!!</span></div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;=30;i++) {</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;        </div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;    slacpositions[i]=<a class="code" href="../../d5/db2/class_vector.html">Vector</a>(slacpositions[i].GetX()*CMINCH/100.,</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;                slacpositions[i].GetY()*CMINCH/100.,</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;                slacpositions[i].GetZ()*CMINCH/100.);<span class="comment">// inches to meters</span></div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;    slacpositions[i].SetY(slacpositions[i].GetY()-<a class="code" href="../../d2/d24/class_balloon.html#aae0a6056476d43b3e44bc9ddf3d66afd">BN_ALTITUDE</a>-0.5584-anita1-&gt;<a class="code" href="../../df/da2/class_anita.html#abec80f2a6b3cec5a9912c5ada98f50e6">LAYER_VPOSITION</a>[2]+0.4); <span class="comment">// subtract balloon altitude, add depth of beam relative to surface.  Use 0.4 m for the height of an antenna.</span></div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;        </div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;  }</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    </div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;}</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d2/d24/class_balloon.html#a78e22e4ce293cabeaa2a249d9932e772">GetBoresights</a>(<a class="code" href="../../db/d2b/class_settings.html">Settings</a> *settings1,<a class="code" href="../../df/da2/class_anita.html">Anita</a> *anita1,<a class="code" href="../../d7/d3b/class_position.html">Position</a> <a class="code" href="../../d2/d24/class_balloon.html#a69f284427712f451a4c1c3756f168093">r_bn</a>,<span class="keywordtype">double</span> <a class="code" href="../../d2/d24/class_balloon.html#a72ef197fc6e4a463e7b066081ddc7527">phi_spin</a>,<a class="code" href="../../d7/d3b/class_position.html">Position</a> <a class="code" href="../../d2/d24/class_balloon.html#a27d12f9572a932f50bc87069697fe63f">r_boresights</a>[<a class="code" href="../../df/da2/class_anita.html#a6bc753f453f91e30ed38f3cc4c30fbc3">Anita::NLAYERS_MAX</a>][<a class="code" href="../../df/da2/class_anita.html#af367aa78f54d08086f0f9c283ee3105e">Anita::NPHI_MAX</a>],<a class="code" href="../../d5/db2/class_vector.html">Vector</a> <a class="code" href="../../d2/d24/class_balloon.html#a379114e2cc17de2246dd14f5cb6febdf">n_north</a>,<a class="code" href="../../d5/db2/class_vector.html">Vector</a> <a class="code" href="../../d2/d24/class_balloon.html#aadaf722446282e6a5022146ccafb8c4a">n_east</a>) {</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;    </div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;  <span class="comment">// this fills r_boresights with the position of the antenna boresights.</span></div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ilayer=0;ilayer&lt;settings1-&gt;NLAYERS;ilayer++) {</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ifold=0;ifold&lt;anita1-&gt;<a class="code" href="../../df/da2/class_anita.html#a470613ae9031d09fd76c7af393dbd556">NRX_PHI</a>[ilayer];ifold++) {</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;      </div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;      <a class="code" href="../../d5/db2/class_vector.html">Vector</a> n_boresight(1,0,0); <span class="comment">// this will be a unit vector that points from the center axis of the payload to the boresight on each level of the payload (it will stay in the x-y plane)</span></div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;      </div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;      <span class="keywordtype">double</span> phi;</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;      <span class="comment">// rotate about z axis for phi</span></div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;      <span class="keywordflow">if</span> (settings1-&gt;CYLINDRICALSYMMETRY==1) {</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;    phi=(double)ifold/(<span class="keywordtype">double</span>)anita1-&gt;<a class="code" href="../../df/da2/class_anita.html#a470613ae9031d09fd76c7af393dbd556">NRX_PHI</a>[ilayer]*2*PI + anita1-&gt;<a class="code" href="../../df/da2/class_anita.html#a6d3e7a6c08dd0f1d3f493b2f879aacc9">PHI_OFFSET</a>[ilayer]+<a class="code" href="../../d2/d24/class_balloon.html#a72ef197fc6e4a463e7b066081ddc7527">phi_spin</a>;</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;      }</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;      <span class="keywordflow">else</span>{</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;    phi=anita1-&gt;<a class="code" href="../../df/da2/class_anita.html#a77fd97662b6459c8e96d04d7554e93f8">PHI_EACHLAYER</a>[ilayer][ifold] + anita1-&gt;<a class="code" href="../../df/da2/class_anita.html#a6d3e7a6c08dd0f1d3f493b2f879aacc9">PHI_OFFSET</a>[ilayer] +<a class="code" href="../../d2/d24/class_balloon.html#a72ef197fc6e4a463e7b066081ddc7527">phi_spin</a>;</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;      }</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;      </div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;      </div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;      n_boresight = n_boresight.RotateZ(phi);</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;      </div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;      <span class="comment">// start with a vector that points in the +z direction but with the same length as r_bn</span></div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;      <a class="code" href="../../d2/d24/class_balloon.html#a27d12f9572a932f50bc87069697fe63f">r_boresights</a>[ilayer][ifold].SetX(0.); <span class="comment">// this will be a unit vector that points from the center axis of the payload to the boresight on each level of the payload (it will stay in the x-y plane)</span></div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;      <a class="code" href="../../d2/d24/class_balloon.html#a27d12f9572a932f50bc87069697fe63f">r_boresights</a>[ilayer][ifold].SetY(0.);</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;      <a class="code" href="../../d2/d24/class_balloon.html#a27d12f9572a932f50bc87069697fe63f">r_boresights</a>[ilayer][ifold].SetZ(r_bn.Mag());</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;      </div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;      <a class="code" href="../../d5/db2/class_vector.html">Vector</a> zaxis(0.,0.,1.);</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;      <a class="code" href="../../d5/db2/class_vector.html">Vector</a> xaxis(1.,0.,0.);</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;      <a class="code" href="../../d5/db2/class_vector.html">Vector</a> yaxis(0.,1.,0.);</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;      </div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;      <span class="comment">// Add the positions of the antennas relative to the center of the payload</span></div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;      <a class="code" href="../../d2/d24/class_balloon.html#a27d12f9572a932f50bc87069697fe63f">r_boresights</a>[ilayer][ifold]+=anita1-&gt;<a class="code" href="../../df/da2/class_anita.html#a8e6c9f19105aff0e2d2e1a29b743243c">RRX</a>[ilayer]*n_boresight</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;    + anita1-&gt;<a class="code" href="../../df/da2/class_anita.html#abec80f2a6b3cec5a9912c5ada98f50e6">LAYER_VPOSITION</a>[ilayer]*zaxis</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;    + anita1-&gt;<a class="code" href="../../df/da2/class_anita.html#a89a4c9d1469f67fcff979d09907165ac">LAYER_HPOSITION</a>[ilayer]*cos(anita1-&gt;<a class="code" href="../../df/da2/class_anita.html#aa4086768bd82bee20776062925a302f2">LAYER_PHIPOSITION</a>[ilayer])*xaxis</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;    + anita1-&gt;<a class="code" href="../../df/da2/class_anita.html#a89a4c9d1469f67fcff979d09907165ac">LAYER_HPOSITION</a>[ilayer]*sin(anita1-&gt;<a class="code" href="../../df/da2/class_anita.html#aa4086768bd82bee20776062925a302f2">LAYER_PHIPOSITION</a>[ilayer])*yaxis;</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;      </div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;      </div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;      <span class="comment">//   now rotate to balloon&#39;s position on the continent</span></div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;      <a class="code" href="../../d2/d24/class_balloon.html#a27d12f9572a932f50bc87069697fe63f">r_boresights</a>[ilayer][ifold] = <a class="code" href="../../d2/d24/class_balloon.html#a27d12f9572a932f50bc87069697fe63f">r_boresights</a>[ilayer][ifold].ChangeCoord(n_north,-1.*n_east);</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;      </div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;      </div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    }</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;  }</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;}</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;<span class="comment">  void Balloon::GetBoresights(Settings *settings1,Anita *anita1) {</span></div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;<span class="comment">    </span></div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;<span class="comment">  // this fills r_boresights with the position of the antenna boresights.</span></div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;<span class="comment">  for(int ilayer=0;ilayer&lt;settings1-&gt;NLAYERS;ilayer++) {</span></div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;<span class="comment">  for(int ifold=0;ifold&lt;anita1-&gt;NRX_PHI[ilayer];ifold++) {</span></div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;<span class="comment">      </span></div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;<span class="comment">  Vector n_boresight(1,0,0); // this will be a unit vector that points from the center axis of the payload to the boresight on each level of the payload (it will stay in the x-y plane)</span></div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;<span class="comment">      </span></div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;<span class="comment">  double phi;</span></div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;<span class="comment">  // rotate about z axis for phi</span></div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;<span class="comment">  if (settings1-&gt;CYLINDRICALSYMMETRY==1) {</span></div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;<span class="comment">  phi=(double)ifold/(double)anita1-&gt;NRX_PHI[ilayer]*2*PI + anita1-&gt;PHI_OFFSET[ilayer]+phi_spin;</span></div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;<span class="comment">  }</span></div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;<span class="comment">  else</span></div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;<span class="comment">  phi=anita1-&gt;PHI_EACHLAYER[ilayer][ifold] + anita1-&gt;PHI_OFFSET[ilayer]+phi_spin;</span></div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;<span class="comment">      </span></div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;<span class="comment">      </span></div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;<span class="comment">  n_boresight = n_boresight.RotateZ(phi);</span></div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;<span class="comment">      </span></div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;<span class="comment">  // start with a vector that points in the +z direction but with the same length as r_bn</span></div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;<span class="comment">  r_boresights[ilayer][ifold].SetX(0.); // this will be a unit vector that points from the center axis of the payload to the boresight on each level of the payload (it will stay in the x-y plane)</span></div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;<span class="comment">  r_boresights[ilayer][ifold].SetY(0.);</span></div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;<span class="comment">  r_boresights[ilayer][ifold].SetZ(r_bn.Mag());</span></div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;<span class="comment">      </span></div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;<span class="comment">  Vector zaxis(0.,0.,1.);</span></div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;<span class="comment">  Vector xaxis(1.,0.,0.);</span></div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;<span class="comment">  Vector yaxis(0.,1.,0.);</span></div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;<span class="comment">      </span></div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;<span class="comment">  // Add the positions of the antennas relative to the center of the payload</span></div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;<span class="comment">  r_boresights[ilayer][ifold]+=anita1-&gt;RRX[ilayer]*n_boresight</span></div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;<span class="comment">  + anita1-&gt;LAYER_VPOSITION[ilayer]*zaxis</span></div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;<span class="comment">  + anita1-&gt;LAYER_HPOSITION[ilayer]*cos(anita1-&gt;LAYER_PHIPOSITION[ilayer])*xaxis</span></div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;<span class="comment">  + anita1-&gt;LAYER_HPOSITION[ilayer]*sin(anita1-&gt;LAYER_PHIPOSITION[ilayer])*yaxis;</span></div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;<span class="comment">      </span></div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;<span class="comment">      </span></div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;<span class="comment">  //   now rotate to balloon&#39;s position on the continent</span></div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;<span class="comment">  r_boresights[ilayer][ifold] = r_boresights[ilayer][ifold].ChangeCoord(n_north,-1.*n_east);</span></div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;<span class="comment">      </span></div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;<span class="comment">      </span></div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;<span class="comment">  }</span></div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;<span class="comment">  }</span></div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;<span class="comment">  }</span></div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l01116"></a><span class="lineno"><a class="line" href="../../d2/d24/class_balloon.html#a1d29f16c9d191f35dfa9036316406617"> 1116</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d2/d24/class_balloon.html#a78e22e4ce293cabeaa2a249d9932e772">Balloon::GetBoresights</a>(<a class="code" href="../../db/d2b/class_settings.html">Settings</a> *settings1,<a class="code" href="../../df/da2/class_anita.html">Anita</a> *anita1) {</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;  <a class="code" href="../../d5/db2/class_vector.html">Vector</a> ant_pos;</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ilayer=0;ilayer&lt;settings1-&gt;NLAYERS;ilayer++) {</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ifold=0;ifold&lt;anita1-&gt;<a class="code" href="../../df/da2/class_anita.html#a470613ae9031d09fd76c7af393dbd556">NRX_PHI</a>[ilayer];ifold++) {</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;      ant_pos=anita1-&gt;<a class="code" href="../../df/da2/class_anita.html#ac42b4a4b4040473c7a473b1417b90a83">ANTENNA_POSITION_START</a>[0][ilayer][ifold];</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;      ant_pos=<a class="code" href="../../d2/d24/class_balloon.html#ab9fd0ffce4b8bbb8dc23f8636d741e4d">RotatePayload</a>(ant_pos);</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;      <a class="code" href="../../d2/d24/class_balloon.html#a27d12f9572a932f50bc87069697fe63f">r_boresights</a>[ilayer][ifold] = ant_pos+<a class="code" href="../../d2/d24/class_balloon.html#a69f284427712f451a4c1c3756f168093">r_bn</a>;</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;    }</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;  }</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;}</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;</div><div class="line"><a name="l01127"></a><span class="lineno"><a class="line" href="../../d2/d24/class_balloon.html#a86fdedefec1f2925bb92c905c0952ede"> 1127</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d2/d24/class_balloon.html#a86fdedefec1f2925bb92c905c0952ede">Balloon::calculate_antenna_positions</a>(<a class="code" href="../../db/d2b/class_settings.html">Settings</a> *settings1, <a class="code" href="../../df/da2/class_anita.html">Anita</a> *anita1){</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;  <span class="keywordtype">int</span> number_all_antennas = 0;</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;  <a class="code" href="../../d5/db2/class_vector.html">Vector</a> antenna_position;</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;   </div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ipol=0; ipol&lt;2; ipol++){</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;    number_all_antennas=0;</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ilayer = 0; ilayer &lt; settings1-&gt;NLAYERS; ilayer++){</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ifold = 0; ifold &lt; anita1-&gt;<a class="code" href="../../df/da2/class_anita.html#a470613ae9031d09fd76c7af393dbd556">NRX_PHI</a>[ilayer]; ifold++){</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;    <span class="keywordtype">double</span> phi = 0;</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;    <span class="keywordflow">if</span> (settings1-&gt;WHICH==6 || settings1-&gt;WHICH==8 || settings1-&gt;WHICH == 9 || settings1-&gt;WHICH == 10){ <span class="comment">//If payload is either</span></div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;      antenna_position = anita1-&gt;<a class="code" href="../../df/da2/class_anita.html#ac42b4a4b4040473c7a473b1417b90a83">ANTENNA_POSITION_START</a>[ipol][ilayer][ifold];</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;    }</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;      <span class="keywordflow">if</span> (settings1-&gt;CYLINDRICALSYMMETRY==1){ <span class="comment">// for timing code</span></div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;        <span class="comment">// phi is 0 for antenna 0 (0-31) and antenna 16 (0-31)</span></div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;        <span class="comment">// antenna 1 (1-32) and antenna 18 (1-32)</span></div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;        phi = (double) ifold / (<span class="keywordtype">double</span>) anita1-&gt;<a class="code" href="../../df/da2/class_anita.html#a470613ae9031d09fd76c7af393dbd556">NRX_PHI</a>[ilayer] * 2 * PI + anita1-&gt;<a class="code" href="../../df/da2/class_anita.html#a6d3e7a6c08dd0f1d3f493b2f879aacc9">PHI_OFFSET</a>[ilayer];</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;      }<span class="keywordflow">else</span>{</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;        phi = anita1-&gt;<a class="code" href="../../df/da2/class_anita.html#a77fd97662b6459c8e96d04d7554e93f8">PHI_EACHLAYER</a>[ilayer][ifold] + anita1-&gt;<a class="code" href="../../df/da2/class_anita.html#a6d3e7a6c08dd0f1d3f493b2f879aacc9">PHI_OFFSET</a>[ilayer];</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;      }</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;      antenna_position = <a class="code" href="../../d5/db2/class_vector.html">Vector</a>(anita1-&gt;<a class="code" href="../../df/da2/class_anita.html#a8e6c9f19105aff0e2d2e1a29b743243c">RRX</a>[ilayer]*cos(phi) + anita1-&gt;<a class="code" href="../../df/da2/class_anita.html#a89a4c9d1469f67fcff979d09907165ac">LAYER_HPOSITION</a>[ilayer]*cos(anita1-&gt;<a class="code" href="../../df/da2/class_anita.html#aa4086768bd82bee20776062925a302f2">LAYER_PHIPOSITION</a>[ilayer]), anita1-&gt;<a class="code" href="../../df/da2/class_anita.html#a8e6c9f19105aff0e2d2e1a29b743243c">RRX</a>[ilayer]*sin(phi)+anita1-&gt;<a class="code" href="../../df/da2/class_anita.html#a89a4c9d1469f67fcff979d09907165ac">LAYER_HPOSITION</a>[ilayer]*sin(anita1-&gt;<a class="code" href="../../df/da2/class_anita.html#aa4086768bd82bee20776062925a302f2">LAYER_PHIPOSITION</a>[ilayer]), anita1-&gt;<a class="code" href="../../df/da2/class_anita.html#abec80f2a6b3cec5a9912c5ada98f50e6">LAYER_VPOSITION</a>[ilayer]);</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;                </div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;    }<span class="comment">//else</span></div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;            </div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;    <span class="comment">//cout&lt;&lt;&quot;antenna_position start for &quot;&lt;&lt;number_all_antennas&lt;&lt;&quot; is  &quot;&lt;&lt;antenna_position&lt;&lt;&quot;\n&quot;;</span></div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;    antenna_position=<a class="code" href="../../d2/d24/class_balloon.html#ab9fd0ffce4b8bbb8dc23f8636d741e4d">RotatePayload</a>(antenna_position);</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;    </div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;    anita1-&gt;<a class="code" href="../../df/da2/class_anita.html#a4cd4b1d8f504ef45b8e59d16a77249c1">antenna_positions</a>[ipol][number_all_antennas] = antenna_position;</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;    <span class="comment">//cout&lt;&lt;&quot;antenna_position for &quot;&lt;&lt;number_all_antennas&lt;&lt;&quot; is  &quot;&lt;&lt;antenna_position&lt;&lt;&quot;\n&quot;;</span></div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;    number_all_antennas++;</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;      }</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;    }</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;  }</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;  <span class="keywordflow">return</span>;</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;}</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;</div><div class="line"><a name="l01164"></a><span class="lineno"><a class="line" href="../../d2/d24/class_balloon.html#ab9fd0ffce4b8bbb8dc23f8636d741e4d"> 1164</a></span>&#160;<a class="code" href="../../d5/db2/class_vector.html">Vector</a> <a class="code" href="../../d2/d24/class_balloon.html#ab9fd0ffce4b8bbb8dc23f8636d741e4d">Balloon::RotatePayload</a>(<a class="code" href="../../d5/db2/class_vector.html">Vector</a> ant_pos_pre) {</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../d2/d24/class_balloon.html#a81c68a6d332881cf4759a4bcca7dc48c">WHICHPATH</a>==7){</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;    <span class="comment">// ANITA-2 analysis fitted fixed pitch and roll</span></div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;    pitch=-0.29; </div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;    roll=0.89; </div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d2/d24/class_balloon.html#a81c68a6d332881cf4759a4bcca7dc48c">WHICHPATH</a>==8){</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;    <span class="comment">// ANITA-3 analysis forced pitch and roll to be 0</span></div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;    pitch=roll=0;</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;  }</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;   </div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;  <a class="code" href="../../d5/db2/class_vector.html">Vector</a> BalloonPos;</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;  BalloonPos=<a class="code" href="../../d2/d24/class_balloon.html#a69f284427712f451a4c1c3756f168093">r_bn</a>;</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;  <span class="keywordtype">double</span> BalloonTheta = BalloonPos.Theta();</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;  <span class="keywordtype">double</span> BalloonPhi = BalloonPos.Phi();</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;  </div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;  <span class="keywordflow">if</span>(BalloonPhi &gt; PI){</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;    BalloonPhi =BalloonPhi-TWOPI;</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;  }</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;  </div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;  <a class="code" href="../../d5/db2/class_vector.html">Vector</a> ant_pos = ant_pos_pre;</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;  <a class="code" href="../../d5/db2/class_vector.html">Vector</a> zaxis(0.,0.,-1.);</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;  <a class="code" href="../../d5/db2/class_vector.html">Vector</a> xaxis(1.,0.,0.);<span class="comment">//roll axis</span></div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;  <a class="code" href="../../d5/db2/class_vector.html">Vector</a> yaxis(0.,-1.,0.);<span class="comment">//pitch axis for positive rotation to the clockwise of roll</span></div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;  <a class="code" href="../../d5/db2/class_vector.html">Vector</a> northaxis(1,0,0);</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;  <a class="code" href="../../d5/db2/class_vector.html">Vector</a> eastaxis(0,-1,0);</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;  <span class="comment">//rotate to correct heading, roll and pitch</span></div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;  ant_pos=ant_pos.Rotate(heading*RADDEG,zaxis);</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;  xaxis=xaxis.Rotate(heading*RADDEG,zaxis);</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;  yaxis=yaxis.Rotate(heading*RADDEG,zaxis);</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;  </div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;  ant_pos=ant_pos.Rotate(pitch*RADDEG,yaxis);</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;  xaxis=xaxis.Rotate(pitch*RADDEG,yaxis);</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;  ant_pos=ant_pos.Rotate(roll*RADDEG,xaxis);<span class="comment">//roll and pitch</span></div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;  <span class="comment">// BalloonPhi =latitude*RADDEG;</span></div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;  ant_pos=ant_pos.RotateY(BalloonTheta);</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;  northaxis=northaxis.RotateY(BalloonTheta);</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;  eastaxis=eastaxis.RotateY(BalloonTheta);</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160; </div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;  ant_pos=ant_pos.RotateZ(BalloonPhi);</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;  northaxis = northaxis.RotateZ(BalloonPhi);</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;  eastaxis = eastaxis.RotateZ(BalloonPhi);</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;  </div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;  <span class="comment">// cout&lt;&lt;&quot;northaxis is &quot;&lt;&lt;northaxis&lt;&lt;&quot; n_north is &quot;&lt;&lt;n_north&lt;&lt;&quot;\n&quot;;</span></div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;  <span class="comment">// cout&lt;&lt;&quot;eastaxis is &quot;&lt;&lt;eastaxis&lt;&lt;&quot; n_east is &quot;&lt;&lt;n_east&lt;&lt;&quot;\n&quot;;</span></div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;  this-&gt;x_axis_rot = xaxis;</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;  this-&gt;y_axis_rot = yaxis;</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;  this-&gt;z_axis_rot = zaxis;</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;  <span class="keywordflow">return</span> ant_pos;</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;}  </div><div class="line"><a name="l01221"></a><span class="lineno"><a class="line" href="../../d2/d24/class_balloon.html#ace0902a765981b8ca408b4fce6857805"> 1221</a></span>&#160;<a class="code" href="../../d5/db2/class_vector.html">Vector</a> <a class="code" href="../../d2/d24/class_balloon.html#ace0902a765981b8ca408b4fce6857805">Balloon::unRotatePayload</a>(<a class="code" href="../../d5/db2/class_vector.html">Vector</a> ant_pos_pre) {<span class="comment">//rotate back to Payload Centric coordinates</span></div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../d2/d24/class_balloon.html#a81c68a6d332881cf4759a4bcca7dc48c">WHICHPATH</a>==7){</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;    pitch=-0.29; <span class="comment">//ANITA-2 settings in ANALYSIS</span></div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;    roll=0.89; <span class="comment">//ANITA-2 settings in ANALYSIS</span></div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d2/d24/class_balloon.html#a81c68a6d332881cf4759a4bcca7dc48c">WHICHPATH</a>==8){</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;    <span class="comment">// ANITA-3 analysis forced pitch and roll to be 0</span></div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;    pitch=roll=0;</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;  }</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;  </div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;  </div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;  <a class="code" href="../../d5/db2/class_vector.html">Vector</a> BalloonPos;</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;  BalloonPos=<a class="code" href="../../d2/d24/class_balloon.html#a69f284427712f451a4c1c3756f168093">r_bn</a>;</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;  <span class="keywordtype">double</span> BalloonTheta = BalloonPos.Theta();</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;  <span class="keywordtype">double</span> BalloonPhi = BalloonPos.Phi();</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;  </div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;  <span class="comment">//cout&lt;&lt;&quot;BalloonTheta is &quot;&lt;&lt;BalloonTheta&lt;&lt;&quot; phi is &quot;&lt;&lt;BalloonPhi&lt;&lt;&quot;\n&quot;;</span></div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;  <span class="keywordflow">if</span>(BalloonPhi &gt; PI){</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;    BalloonPhi =BalloonPhi-TWOPI;</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;  }</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;  </div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160; </div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;  <a class="code" href="../../d5/db2/class_vector.html">Vector</a> ant_pos = ant_pos_pre;</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160; </div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;  </div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;  <span class="comment">//rotate to correct heading, roll and pitch</span></div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;  </div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;  ant_pos=ant_pos.RotateZ(-1*BalloonPhi);</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;  </div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;  ant_pos=ant_pos.RotateY(-1*BalloonTheta);</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;  ant_pos=ant_pos.Rotate(-1*roll*RADDEG,x_axis_rot);<span class="comment">//roll and pitch</span></div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;  </div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;  ant_pos=ant_pos.Rotate(-1*pitch*RADDEG,y_axis_rot);</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;  ant_pos=ant_pos.Rotate(-1*heading*RADDEG,z_axis_rot);</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;  <span class="keywordflow">return</span> ant_pos;</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;}  </div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;</div><div class="ttc" id="class_balloon_html_a9ab8f966d754641c2ccd78099ba55b33"><div class="ttname"><a href="../../d2/d24/class_balloon.html#a9ab8f966d754641c2ccd78099ba55b33">Balloon::realTime_flightdata_temp</a></div><div class="ttdeci">unsigned int realTime_flightdata_temp</div><div class="ttdoc">realtime from the flight data file </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/balloon_8hh_source.html#l00050">balloon.hh:50</a></div></div>
<div class="ttc" id="class_balloon_html_a9f24af1ced17aa2d3ee33558e54d2d06"><div class="ttname"><a href="../../d2/d24/class_balloon.html#a9f24af1ced17aa2d3ee33558e54d2d06">Balloon::realtime_bn_anitalite</a></div><div class="ttdeci">double realtime_bn_anitalite[100000]</div><div class="ttdoc">same for real life time </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/balloon_8hh_source.html#l00087">balloon.hh:87</a></div></div>
<div class="ttc" id="class_balloon_html_a81c68a6d332881cf4759a4bcca7dc48c"><div class="ttname"><a href="../../d2/d24/class_balloon.html#a81c68a6d332881cf4759a4bcca7dc48c">Balloon::WHICHPATH</a></div><div class="ttdeci">int WHICHPATH</div><div class="ttdoc">0=fixed balloon position,1=randomized,2=ANITA-lite GPS data,3=banana plot </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/balloon_8hh_source.html#l00057">balloon.hh:57</a></div></div>
<div class="ttc" id="class_balloon_html_a155811c7b07a72024a4c21ece1aa311c"><div class="ttname"><a href="../../d2/d24/class_balloon.html#a155811c7b07a72024a4c21ece1aa311c">Balloon::surfTrigBandMask</a></div><div class="ttdeci">unsigned short surfTrigBandMask[9][2]</div><div class="ttdoc">Ryan&amp;#39;s 16 bit masks for 9 surfs. 2x16 bit masks gives 32 channels per surf. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/balloon_8hh_source.html#l00060">balloon.hh:60</a></div></div>
<div class="ttc" id="class_balloon_html_a4067df26bb03b68f35e99d9012e67525"><div class="ttname"><a href="../../d2/d24/class_balloon.html#a4067df26bb03b68f35e99d9012e67525">Balloon::igps</a></div><div class="ttdeci">int igps</div><div class="ttdoc">which balloon position do we use out of the 25000 anitalite GPS positions. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/balloon_8hh_source.html#l00041">balloon.hh:41</a></div></div>
<div class="ttc" id="class_balloon_html_a538038f8fa2bfcb35677e30ac871f87a"><div class="ttname"><a href="../../d2/d24/class_balloon.html#a538038f8fa2bfcb35677e30ac871f87a">Balloon::ReadAnitaliteFlight</a></div><div class="ttdeci">void ReadAnitaliteFlight()</div><div class="ttdoc">This function reads in the ANITA LITE flight. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d65/balloon_8cc_source.html#l00112">balloon.cc:112</a></div></div>
<div class="ttc" id="class_balloon_html_a69f284427712f451a4c1c3756f168093"><div class="ttname"><a href="../../d2/d24/class_balloon.html#a69f284427712f451a4c1c3756f168093">Balloon::r_bn</a></div><div class="ttdeci">Position r_bn</div><div class="ttdoc">position of balloon </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/balloon_8hh_source.html#l00066">balloon.hh:66</a></div></div>
<div class="ttc" id="class_balloon_html_a785d36ec34b42251921dfaf971a62cd5"><div class="ttname"><a href="../../d2/d24/class_balloon.html#a785d36ec34b42251921dfaf971a62cd5">Balloon::MAX_POSITIONS</a></div><div class="ttdeci">static const int MAX_POSITIONS</div><div class="ttdoc">for the slac beam test </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/balloon_8hh_source.html#l00044">balloon.hh:44</a></div></div>
<div class="ttc" id="class_interaction_html_a15b1f5258dcfc709bfc401f293e5d12a"><div class="ttname"><a href="../../d3/d8e/class_interaction.html#a15b1f5258dcfc709bfc401f293e5d12a">Interaction::r_fromballoon</a></div><div class="ttdeci">double r_fromballoon[2]</div><div class="ttdoc">distance from interaction to balloon for each ray </div><div class="ttdef"><b>Definition:</b> <a href="../../df/dea/_primaries_8h_source.html#l00251">Primaries.h:251</a></div></div>
<div class="ttc" id="class_balloon_html_a6bf058d1320831ad733db4c5f9ce3cbe"><div class="ttname"><a href="../../d2/d24/class_balloon.html#a6bf058d1320831ad733db4c5f9ce3cbe">Balloon::phi_bn</a></div><div class="ttdeci">double phi_bn</div><div class="ttdoc">theta,phi of balloon wrt south pole </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/balloon_8hh_source.html#l00065">balloon.hh:65</a></div></div>
<div class="ttc" id="class_balloon_html_ab9fd0ffce4b8bbb8dc23f8636d741e4d"><div class="ttname"><a href="../../d2/d24/class_balloon.html#ab9fd0ffce4b8bbb8dc23f8636d741e4d">Balloon::RotatePayload</a></div><div class="ttdeci">Vector RotatePayload(Vector ant_pos)</div><div class="ttdoc">This function rotates the payload. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d65/balloon_8cc_source.html#l01164">balloon.cc:1164</a></div></div>
<div class="ttc" id="class_interaction_html_adcd5f9195ba605c86eaa83f216088bf2"><div class="ttname"><a href="../../d3/d8e/class_interaction.html#adcd5f9195ba605c86eaa83f216088bf2">Interaction::phi_nu_banana</a></div><div class="ttdeci">static constexpr double phi_nu_banana</div><div class="ttdoc">Location in phi. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/dea/_primaries_8h_source.html#l00163">Primaries.h:163</a></div></div>
<div class="ttc" id="class_position_html_a68bbe0fdc40d3d380f633a88735f212e"><div class="ttname"><a href="../../d7/d3b/class_position.html#a68bbe0fdc40d3d380f633a88735f212e">Position::Distance</a></div><div class="ttdeci">double Distance(const Position &amp;second) const </div><div class="ttdoc">Returns chord distance (direct distance between two vectors) </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dd0/position_8cc_source.html#l00037">position.cc:37</a></div></div>
<div class="ttc" id="class_interaction_html_a1e6c2d93ac3db39b513394477c69aafb"><div class="ttname"><a href="../../d3/d8e/class_interaction.html#a1e6c2d93ac3db39b513394477c69aafb">Interaction::nu_banana_surface</a></div><div class="ttdeci">Position nu_banana_surface</div><div class="ttdoc">The location of the surface above the forced neutrino interaction point. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/dea/_primaries_8h_source.html#l00240">Primaries.h:240</a></div></div>
<div class="ttc" id="class_balloon_html_a1abf252a4e4d375db5821822c5225aea"><div class="ttname"><a href="../../d2/d24/class_balloon.html#a1abf252a4e4d375db5821822c5225aea">Balloon::heading_bn_anitalite</a></div><div class="ttdeci">double heading_bn_anitalite[100000]</div><div class="ttdoc">same for heading of the balloon </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/balloon_8hh_source.html#l00086">balloon.hh:86</a></div></div>
<div class="ttc" id="class_anita_html_abec80f2a6b3cec5a9912c5ada98f50e6"><div class="ttname"><a href="../../df/da2/class_anita.html#abec80f2a6b3cec5a9912c5ada98f50e6">Anita::LAYER_VPOSITION</a></div><div class="ttdeci">double LAYER_VPOSITION[Anita::NLAYERS_MAX]</div><div class="ttdoc">position of layers in z relative to vertical center of the payload </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d52/anita_8hh_source.html#l00081">anita.hh:81</a></div></div>
<div class="ttc" id="class_balloon_html_a96a9419e73f0188979bdec29c4597d67"><div class="ttname"><a href="../../d2/d24/class_balloon.html#a96a9419e73f0188979bdec29c4597d67">Balloon::MAXHORIZON</a></div><div class="ttdeci">double MAXHORIZON</div><div class="ttdoc">pick the interaction within this distance from the balloon so that it is within the horizon ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/balloon_8hh_source.html#l00078">balloon.hh:78</a></div></div>
<div class="ttc" id="class_anita_html_a7c3129627c6e17ad7cd6b3481dd5d205"><div class="ttname"><a href="../../df/da2/class_anita.html#a7c3129627c6e17ad7cd6b3481dd5d205">Anita::THETA_ZENITH</a></div><div class="ttdeci">double THETA_ZENITH[NLAYERS_MAX]</div><div class="ttdoc">how the antenna is tilted in theta (in radians with 0=up) </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d52/anita_8hh_source.html#l00075">anita.hh:75</a></div></div>
<div class="ttc" id="class_balloon_html_a9d7ad805352db5a11ecd3acfddc27d44"><div class="ttname"><a href="../../d2/d24/class_balloon.html#a9d7ad805352db5a11ecd3acfddc27d44">Balloon::Getibnposition</a></div><div class="ttdeci">int Getibnposition()</div><div class="ttdoc">This function gets ith balloon position. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d65/balloon_8cc_source.html#l00303">balloon.cc:303</a></div></div>
<div class="ttc" id="class_balloon_html_a6dba9060a33b1755d6609ff2de0b8a49"><div class="ttname"><a href="../../d2/d24/class_balloon.html#a6dba9060a33b1755d6609ff2de0b8a49">Balloon::PickBalloonPosition</a></div><div class="ttdeci">void PickBalloonPosition(Vector straightup, IceModel *antarctica, Settings *settings1, Anita *anita1)</div><div class="ttdoc">This function picks the balloon position. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d65/balloon_8cc_source.html#l00317">balloon.cc:317</a></div></div>
<div class="ttc" id="class_balloon_html_a82787639a749dc17dee91fdf539f9deb"><div class="ttname"><a href="../../d2/d24/class_balloon.html#a82787639a749dc17dee91fdf539f9deb">Balloon::AdjustSlacBalloonPosition</a></div><div class="ttdeci">void AdjustSlacBalloonPosition(int inu)</div><div class="ttdoc">This function adjusts the slac balloon position. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d65/balloon_8cc_source.html#l00627">balloon.cc:627</a></div></div>
<div class="ttc" id="class_balloon_html_a30995e682b03d7ec9fba2d6f3f7e5529"><div class="ttname"><a href="../../d2/d24/class_balloon.html#a30995e682b03d7ec9fba2d6f3f7e5529">Balloon::CenterPayload</a></div><div class="ttdeci">void CenterPayload(double &amp;hitangle_e)</div><div class="ttdoc">This function centers the payload. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d65/balloon_8cc_source.html#l00639">balloon.cc:639</a></div></div>
<div class="ttc" id="class_balloon_html_aa66ff5dc8a3812aaf4e18300021adc15"><div class="ttname"><a href="../../d2/d24/class_balloon.html#aa66ff5dc8a3812aaf4e18300021adc15">Balloon::horizcoord_bn</a></div><div class="ttdeci">double horizcoord_bn</div><div class="ttdoc">x component of balloon position </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/balloon_8hh_source.html#l00067">balloon.hh:67</a></div></div>
<div class="ttc" id="class_balloon_html_a3a82e49e805b9070cf0684b519e20a6f"><div class="ttname"><a href="../../d2/d24/class_balloon.html#a3a82e49e805b9070cf0684b519e20a6f">Balloon::REDUCEBALLOONPOSITIONS</a></div><div class="ttdeci">int REDUCEBALLOONPOSITIONS</div><div class="ttdoc">only take every 100th entry in the flight data file </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/balloon_8hh_source.html#l00056">balloon.hh:56</a></div></div>
<div class="ttc" id="namespace_environment_variable_html_a064f876067320b15e34beb8c29c8ffdc"><div class="ttname"><a href="../../d4/d7f/namespace_environment_variable.html#a064f876067320b15e34beb8c29c8ffdc">EnvironmentVariable::ICEMC_SRC_DIR</a></div><div class="ttdeci">const char * ICEMC_SRC_DIR()</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd9/_environment_variable_8cc_source.html#l00056">EnvironmentVariable.cc:56</a></div></div>
<div class="ttc" id="class_balloon_html_a356923e58f8c56224ff6995537146491"><div class="ttname"><a href="../../d2/d24/class_balloon.html#a356923e58f8c56224ff6995537146491">Balloon::altitude_bn_anitalite</a></div><div class="ttdeci">double altitude_bn_anitalite[100000]</div><div class="ttdoc">same for altitude </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/balloon_8hh_source.html#l00085">balloon.hh:85</a></div></div>
<div class="ttc" id="class_interaction_html_a442362e66d0fe0fe0bc6f1d8807aa4e5"><div class="ttname"><a href="../../d3/d8e/class_interaction.html#a442362e66d0fe0fe0bc6f1d8807aa4e5">Interaction::dtryingdirection</a></div><div class="ttdeci">double dtryingdirection</div><div class="ttdoc">weighting factor: how many equivalent tries each neutrino counts for after having reduced angular pha...</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dea/_primaries_8h_source.html#l00243">Primaries.h:243</a></div></div>
<div class="ttc" id="class_balloon_html_a83af0cc214fdafe44fd492d7dbbaca51"><div class="ttname"><a href="../../d2/d24/class_balloon.html#a83af0cc214fdafe44fd492d7dbbaca51">Balloon::NPOINTS_MIN</a></div><div class="ttdeci">int NPOINTS_MIN</div><div class="ttdoc">min and max index for gps positions we want to include in the simulation (to exclude launch and fall)...</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/balloon_8hh_source.html#l00081">balloon.hh:81</a></div></div>
<div class="ttc" id="class_balloon_html_a51eebf6b41e338b52dff8844dff87d56"><div class="ttname"><a href="../../d2/d24/class_balloon.html#a51eebf6b41e338b52dff8844dff87d56">Balloon::BN_LATITUDE</a></div><div class="ttdeci">double BN_LATITUDE</div><div class="ttdoc">balloon latitude for fixed balloon location </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/balloon_8hh_source.html#l00089">balloon.hh:89</a></div></div>
<div class="ttc" id="class_balloon_html_a694b260dc39659a04bc32d92cad72ad8"><div class="ttname"><a href="../../d2/d24/class_balloon.html#a694b260dc39659a04bc32d92cad72ad8">Balloon::PickDownwardInteractionPoint</a></div><div class="ttdeci">void PickDownwardInteractionPoint(Interaction *interaction1, Anita *anita1, Settings *settings1, IceModel *antarctica1, Ray *ray1, int &amp;beyondhorizon, double len_int_km2, Vector *force_dir=0)</div><div class="ttdoc">This function picks downward interaction point. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d65/balloon_8cc_source.html#l00762">balloon.cc:762</a></div></div>
<div class="ttc" id="class_balloon_html_ae5a88658b80b1f027e5fe28a9d8144e8"><div class="ttname"><a href="../../d2/d24/class_balloon.html#ae5a88658b80b1f027e5fe28a9d8144e8">Balloon::r_bn_shadow</a></div><div class="ttdeci">Position r_bn_shadow</div><div class="ttdoc">position of the balloon projected on earth surface - point just below balloon at surface of the earth...</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/balloon_8hh_source.html#l00077">balloon.hh:77</a></div></div>
<div class="ttc" id="class_balloon_html_afa3d16030232d03d5986d340b8f562c2"><div class="ttname"><a href="../../d2/d24/class_balloon.html#afa3d16030232d03d5986d340b8f562c2">Balloon::MINALTITUDE</a></div><div class="ttdeci">double MINALTITUDE</div><div class="ttdoc">minimum altitude balloon needs to be before we consider it a good event to read from the flight data ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/balloon_8hh_source.html#l00054">balloon.hh:54</a></div></div>
<div class="ttc" id="class_settings_html"><div class="ttname"><a href="../../db/d2b/class_settings.html">Settings</a></div><div class="ttdoc">Reads in and stores input settings for the run. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d4a/_settings_8h_source.html#l00037">Settings.h:37</a></div></div>
<div class="ttc" id="class_interaction_html_a8f9f2b7b7495ddf5218ebfdb9bbb053e"><div class="ttname"><a href="../../d3/d8e/class_interaction.html#a8f9f2b7b7495ddf5218ebfdb9bbb053e">Interaction::banana_observation_distance</a></div><div class="ttdeci">static constexpr double banana_observation_distance</div><div class="ttdoc">How far from the surface above the interaction are we when we measure the voltages? (meters) Note: Should be at least 100000 for best results. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/dea/_primaries_8h_source.html#l00165">Primaries.h:165</a></div></div>
<div class="ttc" id="class_balloon_html_a1298f31799a3b6a8e29ebe709dfe4e05"><div class="ttname"><a href="../../d2/d24/class_balloon.html#a1298f31799a3b6a8e29ebe709dfe4e05">Balloon::setr_bn</a></div><div class="ttdeci">void setr_bn(double latitude, double longitude)</div><div class="ttdoc">This function sets r of the balloon. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d65/balloon_8cc_source.html#l00742">balloon.cc:742</a></div></div>
<div class="ttc" id="class_balloon_html_aa11b7c8d8fca6acb9c5789a85974ad92"><div class="ttname"><a href="../../d2/d24/class_balloon.html#aa11b7c8d8fca6acb9c5789a85974ad92">Balloon::NPOINTS</a></div><div class="ttdeci">int NPOINTS</div><div class="ttdoc">number of GPS positions we&amp;#39;re picking from. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/balloon_8hh_source.html#l00080">balloon.hh:80</a></div></div>
<div class="ttc" id="class_balloon_html_aae0a6056476d43b3e44bc9ddf3d66afd"><div class="ttname"><a href="../../d2/d24/class_balloon.html#aae0a6056476d43b3e44bc9ddf3d66afd">Balloon::BN_ALTITUDE</a></div><div class="ttdeci">double BN_ALTITUDE</div><div class="ttdoc">pick balloon altitude </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/balloon_8hh_source.html#l00059">balloon.hh:59</a></div></div>
<div class="ttc" id="class_balloon_html_a3fb3960c3971912072c734c3df055f87"><div class="ttname"><a href="../../d2/d24/class_balloon.html#a3fb3960c3971912072c734c3df055f87">Balloon::BN_LONGITUDE</a></div><div class="ttdeci">double BN_LONGITUDE</div><div class="ttdoc">balloon longitude for fixed balloon location </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/balloon_8hh_source.html#l00088">balloon.hh:88</a></div></div>
<div class="ttc" id="class_anita_html_a77fd97662b6459c8e96d04d7554e93f8"><div class="ttname"><a href="../../df/da2/class_anita.html#a77fd97662b6459c8e96d04d7554e93f8">Anita::PHI_EACHLAYER</a></div><div class="ttdeci">double PHI_EACHLAYER[NLAYERS_MAX][NPHI_MAX]</div><div class="ttdoc">phi of the center of each antenna on each layer </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d52/anita_8hh_source.html#l00070">anita.hh:70</a></div></div>
<div class="ttc" id="class_balloon_html_ad62ec9ecbb5e88b701b6f38de01240c3"><div class="ttname"><a href="../../d2/d24/class_balloon.html#ad62ec9ecbb5e88b701b6f38de01240c3">Balloon::n_bn</a></div><div class="ttdeci">Vector n_bn</div><div class="ttdoc">normalized r_bn </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/balloon_8hh_source.html#l00073">balloon.hh:73</a></div></div>
<div class="ttc" id="class_anita_html_a6d3e7a6c08dd0f1d3f493b2f879aacc9"><div class="ttname"><a href="../../df/da2/class_anita.html#a6d3e7a6c08dd0f1d3f493b2f879aacc9">Anita::PHI_OFFSET</a></div><div class="ttdeci">double PHI_OFFSET[NLAYERS_MAX]</div><div class="ttdoc">antenna offset in phi for each layer (radians) </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d52/anita_8hh_source.html#l00074">anita.hh:74</a></div></div>
<div class="ttc" id="class_balloon_html_ab961c4c09983ae291b1feedb1f98b786"><div class="ttname"><a href="../../d2/d24/class_balloon.html#ab961c4c09983ae291b1feedb1f98b786">Balloon::powerthresh</a></div><div class="ttdeci">float powerthresh[9][32]</div><div class="ttdoc">power threshold in Watts </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/balloon_8hh_source.html#l00061">balloon.hh:61</a></div></div>
<div class="ttc" id="class_balloon_html_a1ddbf318da23992fe38ab54c80c45d84"><div class="ttname"><a href="../../d2/d24/class_balloon.html#a1ddbf318da23992fe38ab54c80c45d84">Balloon::InitializeBalloon</a></div><div class="ttdeci">void InitializeBalloon()</div><div class="ttdoc">This function initializes the balloon or the specific flight. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d65/balloon_8cc_source.html#l00188">balloon.cc:188</a></div></div>
<div class="ttc" id="class_position_html"><div class="ttname"><a href="../../d7/d3b/class_position.html">Position</a></div><div class="ttdoc">This class is a 3-vector that represents a position on the Earth&amp;#39;s surface. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d18/position_8hh_source.html#l00026">position.hh:26</a></div></div>
<div class="ttc" id="class_balloon_html_a80dccd66445722dd1bb5f8d386aa5d0f"><div class="ttname"><a href="../../d2/d24/class_balloon.html#a80dccd66445722dd1bb5f8d386aa5d0f">Balloon::RANDOMIZE_BN_ORIENTATION</a></div><div class="ttdeci">int RANDOMIZE_BN_ORIENTATION</div><div class="ttdoc">0=fixed balloon orientation,1=randomized </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/balloon_8hh_source.html#l00058">balloon.hh:58</a></div></div>
<div class="ttc" id="class_anita_html_ac42b4a4b4040473c7a473b1417b90a83"><div class="ttname"><a href="../../df/da2/class_anita.html#ac42b4a4b4040473c7a473b1417b90a83">Anita::ANTENNA_POSITION_START</a></div><div class="ttdeci">Vector ANTENNA_POSITION_START[2][NLAYERS_MAX][NPHI_MAX]</div><div class="ttdoc">antenna positions from Kurt&amp;#39;s measurements </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d52/anita_8hh_source.html#l00062">anita.hh:62</a></div></div>
<div class="ttc" id="class_interaction_html"><div class="ttname"><a href="../../d3/d8e/class_interaction.html">Interaction</a></div><div class="ttdoc">Stores everything about a particular neutrino interaction. Interaction. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/dea/_primaries_8h_source.html#l00135">Primaries.h:135</a></div></div>
<div class="ttc" id="class_balloon_html_a9b958aae728e342a3e448b55b9d530b7"><div class="ttname"><a href="../../d2/d24/class_balloon.html#a9b958aae728e342a3e448b55b9d530b7">Balloon::GetAntennaOrientation</a></div><div class="ttdeci">void GetAntennaOrientation(Settings *settings1, Anita *anita1, int ilayer, int ifold, Vector &amp;n_eplane, Vector &amp;n_hplane, Vector &amp;n_normal)</div><div class="ttdoc">This function gets the antenna orientation. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d65/balloon_8cc_source.html#l00649">balloon.cc:649</a></div></div>
<div class="ttc" id="class_anita_html_a8e6c9f19105aff0e2d2e1a29b743243c"><div class="ttname"><a href="../../df/da2/class_anita.html#a8e6c9f19105aff0e2d2e1a29b743243c">Anita::RRX</a></div><div class="ttdeci">double RRX[Anita::NLAYERS_MAX]</div><div class="ttdoc">radius that the antenna sits from the axis of the payload (feedpoint) </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d52/anita_8hh_source.html#l00087">anita.hh:87</a></div></div>
<div class="ttc" id="class_balloon_html_a379114e2cc17de2246dd14f5cb6febdf"><div class="ttname"><a href="../../d2/d24/class_balloon.html#a379114e2cc17de2246dd14f5cb6febdf">Balloon::n_north</a></div><div class="ttdeci">Vector n_north</div><div class="ttdoc">north, as seen from the balloon position </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/balloon_8hh_source.html#l00075">balloon.hh:75</a></div></div>
<div class="ttc" id="class_balloon_html_a4bf2d1dbe9b6c6b98f3d507fa7d1002e"><div class="ttname"><a href="../../d2/d24/class_balloon.html#a4bf2d1dbe9b6c6b98f3d507fa7d1002e">Balloon::longitude_bn_anitalite</a></div><div class="ttdeci">double longitude_bn_anitalite[100000]</div><div class="ttdoc">same for longitude </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/balloon_8hh_source.html#l00084">balloon.hh:84</a></div></div>
<div class="ttc" id="class_balloon_html_a3c333ec0bbf10e678cd86ee3bdad0f0d"><div class="ttname"><a href="../../d2/d24/class_balloon.html#a3c333ec0bbf10e678cd86ee3bdad0f0d">Balloon::GetBalloonSpin</a></div><div class="ttdeci">double GetBalloonSpin(double heading)</div><div class="ttdoc">This function gets the spin of the balloon whatever that means. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d65/balloon_8cc_source.html#l00287">balloon.cc:287</a></div></div>
<div class="ttc" id="class_interaction_html_a6e9ad2ed02dd253db92aa8bd344f057e"><div class="ttname"><a href="../../d3/d8e/class_interaction.html#a6e9ad2ed02dd253db92aa8bd344f057e">Interaction::altitude_int_mirror</a></div><div class="ttdeci">double altitude_int_mirror</div><div class="ttdoc">depth of the mirror point of interaction. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/dea/_primaries_8h_source.html#l00249">Primaries.h:249</a></div></div>
<div class="ttc" id="class_balloon_html_a72ef197fc6e4a463e7b066081ddc7527"><div class="ttname"><a href="../../d2/d24/class_balloon.html#a72ef197fc6e4a463e7b066081ddc7527">Balloon::phi_spin</a></div><div class="ttdeci">double phi_spin</div><div class="ttdoc">orientation of the balloon </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/balloon_8hh_source.html#l00079">balloon.hh:79</a></div></div>
<div class="ttc" id="class_balloon_html_a5a7672a44eb85d425909a268ab53fbff"><div class="ttname"><a href="../../d2/d24/class_balloon.html#a5a7672a44eb85d425909a268ab53fbff">Balloon::SetDefaultBalloonPosition</a></div><div class="ttdeci">void SetDefaultBalloonPosition(IceModel *antarctica1)</div><div class="ttdoc">This function sets the default balloon position. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d65/balloon_8cc_source.html#l00075">balloon.cc:75</a></div></div>
<div class="ttc" id="class_anita_html"><div class="ttname"><a href="../../df/da2/class_anita.html">Anita</a></div><div class="ttdoc">Contains everything about positions within payload and signals it sees for each event, in both the trigger and signal paths. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d52/anita_8hh_source.html#l00032">anita.hh:32</a></div></div>
<div class="ttc" id="class_balloon_html_a86fdedefec1f2925bb92c905c0952ede"><div class="ttname"><a href="../../d2/d24/class_balloon.html#a86fdedefec1f2925bb92c905c0952ede">Balloon::calculate_antenna_positions</a></div><div class="ttdeci">void calculate_antenna_positions(Settings *settings1, Anita *anita1)</div><div class="ttdoc">This function calculates antenna positions. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d65/balloon_8cc_source.html#l01127">balloon.cc:1127</a></div></div>
<div class="ttc" id="class_balloon_html_ace0902a765981b8ca408b4fce6857805"><div class="ttname"><a href="../../d2/d24/class_balloon.html#ace0902a765981b8ca408b4fce6857805">Balloon::unRotatePayload</a></div><div class="ttdeci">Vector unRotatePayload(Vector ant_pos)</div><div class="ttdoc">This function UN-rotates the payload. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d65/balloon_8cc_source.html#l01221">balloon.cc:1221</a></div></div>
<div class="ttc" id="class_balloon_html_a82033268c70493ca7c6e850e82e8c49d"><div class="ttname"><a href="../../d2/d24/class_balloon.html#a82033268c70493ca7c6e850e82e8c49d">Balloon::surface_under_balloon</a></div><div class="ttdeci">double surface_under_balloon</div><div class="ttdoc">distance between center of the earth and the surface of earth under balloon </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/balloon_8hh_source.html#l00076">balloon.hh:76</a></div></div>
<div class="ttc" id="class_anita_html_a6bc753f453f91e30ed38f3cc4c30fbc3"><div class="ttname"><a href="../../df/da2/class_anita.html#a6bc753f453f91e30ed38f3cc4c30fbc3">Anita::NLAYERS_MAX</a></div><div class="ttdeci">static const int NLAYERS_MAX</div><div class="ttdoc">max number of layers (in smex design, it&amp;#39;s 4) </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d52/anita_8hh_source.html#l00059">anita.hh:59</a></div></div>
<div class="ttc" id="class_interaction_html_a0df23bdc40b2d92b95b0d6029f374edc"><div class="ttname"><a href="../../d3/d8e/class_interaction.html#a0df23bdc40b2d92b95b0d6029f374edc">Interaction::altitude_int</a></div><div class="ttdeci">double altitude_int</div><div class="ttdoc">depth of interaction </div><div class="ttdef"><b>Definition:</b> <a href="../../df/dea/_primaries_8h_source.html#l00248">Primaries.h:248</a></div></div>
<div class="ttc" id="class_anita_html_a4cd4b1d8f504ef45b8e59d16a77249c1"><div class="ttname"><a href="../../df/da2/class_anita.html#a4cd4b1d8f504ef45b8e59d16a77249c1">Anita::antenna_positions</a></div><div class="ttdeci">Vector antenna_positions[2][NLAYERS_MAX *NPHI_MAX]</div><div class="ttdoc">these are the antenna positions in space in a coordinate system where x=north and y=west and the orig...</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d52/anita_8hh_source.html#l00067">anita.hh:67</a></div></div>
<div class="ttc" id="class_balloon_html_a8dff2cae99ba8661c69438e604aebe00"><div class="ttname"><a href="../../d2/d24/class_balloon.html#a8dff2cae99ba8661c69438e604aebe00">Balloon::vertcoord_bn</a></div><div class="ttdeci">double vertcoord_bn</div><div class="ttdoc">y component of balloon position </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/balloon_8hh_source.html#l00068">balloon.hh:68</a></div></div>
<div class="ttc" id="class_interaction_html_a97f88ca0a1c9e906203aa5ce618221e0"><div class="ttname"><a href="../../d3/d8e/class_interaction.html#a97f88ca0a1c9e906203aa5ce618221e0">Interaction::banana_volts</a></div><div class="ttdeci">double banana_volts</div><div class="ttdoc">Total voltage measured at a spot on the sky. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/dea/_primaries_8h_source.html#l00216">Primaries.h:216</a></div></div>
<div class="ttc" id="class_balloon_html_a89cfc8cfa44410227aba08d70cbfc2bd"><div class="ttname"><a href="../../d2/d24/class_balloon.html#a89cfc8cfa44410227aba08d70cbfc2bd">Balloon::latitude_bn_anitalite</a></div><div class="ttdeci">double latitude_bn_anitalite[100000]</div><div class="ttdoc">latitude at times along flightpath, equally distributed among gps data. This is filled with anita or ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/balloon_8hh_source.html#l00083">balloon.hh:83</a></div></div>
<div class="ttc" id="class_interaction_html_ab558b148fa334b3b1522a68f6273b954"><div class="ttname"><a href="../../d3/d8e/class_interaction.html#ab558b148fa334b3b1522a68f6273b954">Interaction::iceinteraction</a></div><div class="ttdeci">int iceinteraction</div><div class="ttdoc">whether or not there is an interaction in the ice </div><div class="ttdef"><b>Definition:</b> <a href="../../df/dea/_primaries_8h_source.html#l00256">Primaries.h:256</a></div></div>
<div class="ttc" id="class_balloon_html_ace5f5d47d1e1c7842db8076f492d6fcf"><div class="ttname"><a href="../../d2/d24/class_balloon.html#ace5f5d47d1e1c7842db8076f492d6fcf">Balloon::setObservationLocation</a></div><div class="ttdeci">void setObservationLocation(Interaction *interaction1, int inu, IceModel *antarctic, Settings *settings1)</div><div class="ttdoc">This function sets the observation location. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d65/balloon_8cc_source.html#l00046">balloon.cc:46</a></div></div>
<div class="ttc" id="class_balloon_html_adbfe896855ef550c9a3c5c1fecc1b502"><div class="ttname"><a href="../../d2/d24/class_balloon.html#adbfe896855ef550c9a3c5c1fecc1b502">Balloon::GetEcompHcompEvector</a></div><div class="ttdeci">void GetEcompHcompEvector(Settings *settings1, Vector n_eplane, Vector n_hplane, const Vector n_pol, double &amp;e_component, double &amp;h_component, double &amp;n_component)</div><div class="ttdoc">This function gets the e-component, h-component and e-vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d65/balloon_8cc_source.html#l00704">balloon.cc:704</a></div></div>
<div class="ttc" id="class_balloon_html_aadaf722446282e6a5022146ccafb8c4a"><div class="ttname"><a href="../../d2/d24/class_balloon.html#aadaf722446282e6a5022146ccafb8c4a">Balloon::n_east</a></div><div class="ttdeci">Vector n_east</div><div class="ttdoc">east, as seen from the balloon position </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/balloon_8hh_source.html#l00074">balloon.hh:74</a></div></div>
<div class="ttc" id="class_interaction_html_a9c96b836f1c5df216eebc4021a041e83"><div class="ttname"><a href="../../d3/d8e/class_interaction.html#a9c96b836f1c5df216eebc4021a041e83">Interaction::theta_nu_banana</a></div><div class="ttdeci">static constexpr double theta_nu_banana</div><div class="ttdoc">Location of banana neutrino in theta. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/dea/_primaries_8h_source.html#l00166">Primaries.h:166</a></div></div>
<div class="ttc" id="class_vector_html"><div class="ttname"><a href="../../d5/db2/class_vector.html">Vector</a></div><div class="ttdoc">This class represents a three-vector. Operators are overloaded to provide for the familiar operations...</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d61/vector_8hh_source.html#l00027">vector.hh:27</a></div></div>
<div class="ttc" id="class_interaction_html_aa2dcd4c8539fa3ef312c54090682eb82"><div class="ttname"><a href="../../d3/d8e/class_interaction.html#aa2dcd4c8539fa3ef312c54090682eb82">Interaction::nu_banana</a></div><div class="ttdeci">Position nu_banana</div><div class="ttdoc">The forced interaction point of the neutrino for the banana plots. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/dea/_primaries_8h_source.html#l00239">Primaries.h:239</a></div></div>
<div class="ttc" id="class_anita_html_a0ba1b8d8c13ed0540efe34c51f04ffd4"><div class="ttname"><a href="../../df/da2/class_anita.html#a0ba1b8d8c13ed0540efe34c51f04ffd4">Anita::ANTENNA_DOWN</a></div><div class="ttdeci">double ANTENNA_DOWN[NLAYERS_MAX][NPHI_MAX]</div><div class="ttdoc">down angles of antennas from Kurt&amp;#39;s measurements </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d52/anita_8hh_source.html#l00063">anita.hh:63</a></div></div>
<div class="ttc" id="class_anita_html_af367aa78f54d08086f0f9c283ee3105e"><div class="ttname"><a href="../../df/da2/class_anita.html#af367aa78f54d08086f0f9c283ee3105e">Anita::NPHI_MAX</a></div><div class="ttdeci">static const int NPHI_MAX</div><div class="ttdoc">max number of antennas around in phi (in smex, 16) </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d52/anita_8hh_source.html#l00061">anita.hh:61</a></div></div>
<div class="ttc" id="class_balloon_html_a84fdc4c1b807ce01c41c0fb5a40ba4c5"><div class="ttname"><a href="../../d2/d24/class_balloon.html#a84fdc4c1b807ce01c41c0fb5a40ba4c5">Balloon::GetHitAngles</a></div><div class="ttdeci">void GetHitAngles(double e_component_kvector, double h_component_kvector, double n_component_kvector, double &amp;hitangle_e, double &amp;hitangle_h)</div><div class="ttdoc">This function gets the hit angles. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d65/balloon_8cc_source.html#l00726">balloon.cc:726</a></div></div>
<div class="ttc" id="class_balloon_html_a3a090dc24bdfdf84bdddc308de7d20e0"><div class="ttname"><a href="../../d2/d24/class_balloon.html#a3a090dc24bdfdf84bdddc308de7d20e0">Balloon::igps_previous</a></div><div class="ttdeci">int igps_previous</div><div class="ttdoc">which entry from the flight data file the previous event was so we can just take the next one...</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/balloon_8hh_source.html#l00055">balloon.hh:55</a></div></div>
<div class="ttc" id="class_interaction_html_acedcf047fba72945f603c907294352a8"><div class="ttname"><a href="../../d3/d8e/class_interaction.html#acedcf047fba72945f603c907294352a8">Interaction::banana_obs</a></div><div class="ttdeci">Vector banana_obs</div><div class="ttdoc">Vector from the neutrino interaction to the observation point. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/dea/_primaries_8h_source.html#l00173">Primaries.h:173</a></div></div>
<div class="ttc" id="class_balloon_html_a83699275fd0ec62469cfcde3d5f0656d"><div class="ttname"><a href="../../d2/d24/class_balloon.html#a83699275fd0ec62469cfcde3d5f0656d">Balloon::meanp</a></div><div class="ttdeci">float meanp[9][32]</div><div class="ttdoc">mean power in Watts </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/balloon_8hh_source.html#l00062">balloon.hh:62</a></div></div>
<div class="ttc" id="class_balloon_html_a7542eed41dafcc761205c51a18e6eddf"><div class="ttname"><a href="../../d2/d24/class_balloon.html#a7542eed41dafcc761205c51a18e6eddf">Balloon::dtryingposition</a></div><div class="ttdeci">double dtryingposition</div><div class="ttdoc">weighting factor: how many equivalent tries each neutrino counts for after having reduced possible in...</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/balloon_8hh_source.html#l00043">balloon.hh:43</a></div></div>
<div class="ttc" id="class_anita_html_aa4086768bd82bee20776062925a302f2"><div class="ttname"><a href="../../df/da2/class_anita.html#aa4086768bd82bee20776062925a302f2">Anita::LAYER_PHIPOSITION</a></div><div class="ttdeci">double LAYER_PHIPOSITION[Anita::NLAYERS_MAX]</div><div class="ttdoc">phi corresponding to the position of each &quot;layer&quot; on the &quot;payload&quot; </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d52/anita_8hh_source.html#l00086">anita.hh:86</a></div></div>
<div class="ttc" id="class_ray_html"><div class="ttname"><a href="../../d2/d1f/class_ray.html">Ray</a></div><div class="ttdoc">Ray tracing. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da4/ray_8hh_source.html#l00020">ray.hh:20</a></div></div>
<div class="ttc" id="class_position_html_a736146228c802ee9b3f0953349c4410a"><div class="ttname"><a href="../../d7/d3b/class_position.html#a736146228c802ee9b3f0953349c4410a">Position::Lon</a></div><div class="ttdeci">double Lon() const </div><div class="ttdoc">Returns longitude. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dd0/position_8cc_source.html#l00051">position.cc:51</a></div></div>
<div class="ttc" id="class_balloon_html_ac3081c89e7f41389590e683659a69fc5"><div class="ttname"><a href="../../d2/d24/class_balloon.html#ac3081c89e7f41389590e683659a69fc5">Balloon::GetEcompHcompkvector</a></div><div class="ttdeci">void GetEcompHcompkvector(Vector n_eplane, Vector n_hplane, Vector n_normal, const Vector n_exit2bn, double &amp;e_component_kvector, double &amp;h_component_kvector, double &amp;n_component_kvector)</div><div class="ttdoc">This function gets the e-component, h-component and k-vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d65/balloon_8cc_source.html#l00690">balloon.cc:690</a></div></div>
<div class="ttc" id="class_anita_html_a470613ae9031d09fd76c7af393dbd556"><div class="ttname"><a href="../../df/da2/class_anita.html#a470613ae9031d09fd76c7af393dbd556">Anita::NRX_PHI</a></div><div class="ttdeci">int NRX_PHI[NLAYERS_MAX]</div><div class="ttdoc">number of antennas around in each layer. (radians) </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d52/anita_8hh_source.html#l00069">anita.hh:69</a></div></div>
<div class="ttc" id="class_balloon_html_a78e22e4ce293cabeaa2a249d9932e772"><div class="ttname"><a href="../../d2/d24/class_balloon.html#a78e22e4ce293cabeaa2a249d9932e772">Balloon::GetBoresights</a></div><div class="ttdeci">void GetBoresights(Settings *settings1, Anita *anita1, Position r_boresights[Anita::NLAYERS_MAX][Anita::NPHI_MAX])</div><div class="ttdoc">This function gets the boresights. </div></div>
<div class="ttc" id="class_interaction_html_a645204fe8e7608c32ddaaa23069fa017"><div class="ttname"><a href="../../d3/d8e/class_interaction.html#a645204fe8e7608c32ddaaa23069fa017">Interaction::banana_weight</a></div><div class="ttdeci">double banana_weight</div><div class="ttdoc">Weight measurement locations to account for phase space. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/dea/_primaries_8h_source.html#l00214">Primaries.h:214</a></div></div>
<div class="ttc" id="class_balloon_html_a27d12f9572a932f50bc87069697fe63f"><div class="ttname"><a href="../../d2/d24/class_balloon.html#a27d12f9572a932f50bc87069697fe63f">Balloon::r_boresights</a></div><div class="ttdeci">Position r_boresights[Anita::NLAYERS_MAX][Anita::NPHI_MAX]</div><div class="ttdoc">position of antenna boresights </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/balloon_8hh_source.html#l00069">balloon.hh:69</a></div></div>
<div class="ttc" id="class_ice_model_html"><div class="ttname"><a href="../../de/d63/class_ice_model.html">IceModel</a></div><div class="ttdoc">Ice thicknesses and water depth. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dee/icemodel_8hh_source.html#l00103">icemodel.hh:103</a></div></div>
<div class="ttc" id="class_interaction_html_a1c6e9aa72103431cd124bdce1fcad885"><div class="ttname"><a href="../../d3/d8e/class_interaction.html#a1c6e9aa72103431cd124bdce1fcad885">Interaction::d_effective_area</a></div><div class="ttdeci">double d_effective_area</div><div class="ttdoc">In unbaised mode, projection of surface onto nnu. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/dea/_primaries_8h_source.html#l00246">Primaries.h:246</a></div></div>
<div class="ttc" id="class_balloon_html_aefb79f91cdee782d62e724b2c50c64b2"><div class="ttname"><a href="../../d2/d24/class_balloon.html#aefb79f91cdee782d62e724b2c50c64b2">Balloon::realTime_flightdata</a></div><div class="ttdeci">unsigned int realTime_flightdata</div><div class="ttdoc">realtime from the flight data file </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/balloon_8hh_source.html#l00051">balloon.hh:51</a></div></div>
<div class="ttc" id="class_balloon_html_a4dd01bbfe671c53d6286b6ca6a327354"><div class="ttname"><a href="../../d2/d24/class_balloon.html#a4dd01bbfe671c53d6286b6ca6a327354">Balloon::GetSlacPositions</a></div><div class="ttdeci">void GetSlacPositions(Anita *anita1)</div><div class="ttdoc">This function gets the slac balloon positions. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d65/balloon_8cc_source.html#l00917">balloon.cc:917</a></div></div>
<div class="ttc" id="class_anita_html_a89a4c9d1469f67fcff979d09907165ac"><div class="ttname"><a href="../../df/da2/class_anita.html#a89a4c9d1469f67fcff979d09907165ac">Anita::LAYER_HPOSITION</a></div><div class="ttdeci">double LAYER_HPOSITION[Anita::NLAYERS_MAX]</div><div class="ttdoc">distance in horizontal plane between center axis of the &quot;payload&quot; and each &quot;layer&quot;. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d52/anita_8hh_source.html#l00085">anita.hh:85</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Apr 5 2021 19:55:40 for ANITA Software by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
