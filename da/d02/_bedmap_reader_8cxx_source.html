<!-- HTML header for doxygen 1.8.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=9"/>
    <meta name="generator" content="Doxygen 1.8.11"/>
    <title>ANITA Software: components/anitaEventCorrelator/src/BedmapReader.cxx Source File</title>
    <link href="../../tabs.css" rel="stylesheet" type="text/css"/>
    <script type="text/javascript" src="../../jquery.js"></script>
    <script type="text/javascript" src="../../dynsections.js"></script>
    <link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
    <link href="../../doxygen.css" rel="stylesheet" type="text/css" />
    <link href="../../customdoxygen.css" rel="stylesheet" type="text/css"/>
  </head>
  <body>
    <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
      <div id="titlearea">
	<table cellspacing="0" cellpadding="0">
	  <tbody>	    
	    <tr style="height: 56px;">
	      <td id="projectlogo"><img width="960" alt="Logo" src="../../anitaSoftware.png"/></td>
	    </tr>
	  </tbody>
	</table>
      </div>
      <!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Introduction</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_409f97388efe006bc3438b95e9edef48.html">components</a></li><li class="navelem"><a class="el" href="../../dir_86c758350d5a3dfda49436f3ac1beedc.html">anitaEventCorrelator</a></li><li class="navelem"><a class="el" href="../../dir_b48a86a3833e6b3087dd6927d6e8db8a.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">BedmapReader.cxx</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//  BedmapReader.cxx : </span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//  Based on code stolen from Stephen Hoover&#39;s readBedmap.C.  </span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">//  Modified by Matthew Mottram to work for surface elevation</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//  and to be consistent with the eventCorrelator framework</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//    Sample code for reading in BEDMAP data and making it available </span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//  by longitude and latitude coordinates.  BEDMAP data is assumed to be </span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">//  in directory &quot;data/&quot;.  The files &quot;icethic.asc&quot;, &quot;groundbed.asc&quot;, and </span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//  &quot;water.asc&quot; are needed.</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">//    Methods &quot;IceThickness&quot;, &quot;Surface&quot;, &quot;SurfaceAboveGeoid&quot;, and &quot;WaterDepth&quot;</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">//  take (latitude, longitude) as arguments, and return data from BEDMAP.</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">//  Longitude is in degrees from the Prime Meridian, with degrees east being </span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">//  positive and degrees west being negative.  Latitude is in degrees from </span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">//  the equator, where negative degrees are south latitude.</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">//    Code to read data from files by Ryan Nichol, remaining code by Stephen Hoover.</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">//  16 April 2007</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &lt;fstream&gt;</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &lt;cstring&gt;</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;TMath.h&quot;</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;BedmapReader.h&quot;</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;AnitaGeomTool.h&quot;</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;TProfile2D.h&quot;</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;TGaxis.h&quot;</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="keyword">using namespace </span><a class="code" href="../../d8/dcc/namespacestd.html">std</a>;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div><div class="line"><a name="l00037"></a><span class="lineno"><a class="line" href="../../db/d26/structramp_data.html">   37</a></span>&#160; <span class="keyword">struct </span><a class="code" href="../../db/d26/structramp_data.html">rampData</a>{</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  Double_t lat;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  Double_t longi;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  Double_t el1;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  Double_t el2;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160; };</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="keywordtype">bool</span> comparitor(<a class="code" href="../../db/d26/structramp_data.html">rampData</a> <span class="keyword">const</span>&amp; first, <a class="code" href="../../db/d26/structramp_data.html">rampData</a> <span class="keyword">const</span>&amp; second){</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="keywordflow">return</span> first.lat &lt; second.lat;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;}</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;vector&lt;rampData&gt; rampDemVec;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;vector&lt;double&gt; longVec;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;vector&lt;double&gt; latVec;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;vector&lt;double&gt;::iterator myIteratorLow;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;vector&lt;double&gt;::iterator myIteratorUp;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;vector&lt;double&gt;::iterator myIteratorFinal;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">//Parameters of the BEDMAP ice model. (See http://www.antarctica.ac.uk/data/access/bedmap/download/)</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">// Int_t cellSize=5000; //in meters, set by header file (should be 5000)</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">// Int_t nCols_surface=1096;</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">// Int_t nRows_surface=911;</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">// Int_t xLowerLeft_surface=-2713600;</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">// Int_t yLowerLeft_surface=-2304000;</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;Int_t NODATA=-9999;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">//Variables for conversion between BEDMAP polar stereographic coordinates and lat/lon.  Conversion equations from ftp://164.214.2.65/pub/gig/tm8358.2/TM8358_2.pdf</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="keyword">const</span> Double_t scale_factor=0.97276901289;  <span class="comment">//scale factor at pole corresponding to 71 deg S latitude of true scale (used in BEDMAP)</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="keyword">const</span> Double_t ellipsoid_inv_f = 298.257223563; <span class="comment">//of Earth</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="keyword">const</span> Double_t ellipsoid_b = R_EARTH*(1-(1/ellipsoid_inv_f));</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="keyword">const</span> Double_t eccentricity = sqrt((1/ellipsoid_inv_f)*(2-(1/ellipsoid_inv_f)));</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="keyword">const</span> Double_t bedmap_a_bar = pow(eccentricity,2)/2 + 5*pow(eccentricity,4)/24 + pow(eccentricity,6)/12 + 13*pow(eccentricity,8)/360;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="keyword">const</span> Double_t bedmap_b_bar = 7*pow(eccentricity,4)/48 + 29*pow(eccentricity,6)/240 + 811*pow(eccentricity,8)/11520;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="keyword">const</span> Double_t bedmap_c_bar = 7*pow(eccentricity,6)/120 + 81*pow(eccentricity,8)/1120;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="keyword">const</span> Double_t bedmap_d_bar = 4279*pow(eccentricity,8)/161280;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="keyword">const</span> Double_t bedmap_c_0 = (2*R_EARTH / sqrt(1-pow(eccentricity,2))) * pow(( (1-eccentricity) / (1+eccentricity) ),eccentricity/2);</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;Double_t bedmap_R = scale_factor*bedmap_c_0 * pow(( (1 + eccentricity*sin(71*TMath::DegToRad())) / (1 - eccentricity*sin(71*TMath::DegToRad())) ),eccentricity/2) * tan((TMath::Pi()/4) - (71*TMath::DegToRad())/2); <span class="comment">//varies with latitude, defined here for 71 deg S latitude</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="keyword">const</span> Double_t bedmap_nu = bedmap_R / cos(71*TMath::DegToRad());</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<a class="code" href="../../d5/d60/class_bedmap_reader.html">BedmapReader</a>*  BedmapReader::fgInstance = 0;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;BedmapReader::BedmapReader(<span class="keywordtype">bool</span> icethicknessMode) </div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;{</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <span class="comment">//Default constructor</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;reading the bedmap data&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  ReadSurfaceElevation(icethicknessMode);</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="comment">//ReadSurfaceElevationRampDem();</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  fgInstance=<span class="keyword">this</span>;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;}</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;BedmapReader::~BedmapReader() </div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;{</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <span class="comment">//Default destructor</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;}</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">//______________________________________________________________________________</span></div><div class="line"><a name="l00097"></a><span class="lineno"><a class="line" href="../../d5/d60/class_bedmap_reader.html#a5471b09d4f57169864fb28e63181475a">   97</a></span>&#160;<a class="code" href="../../d5/d60/class_bedmap_reader.html">BedmapReader</a>*  <a class="code" href="../../d5/d60/class_bedmap_reader.html#a5471b09d4f57169864fb28e63181475a">BedmapReader::Instance</a>(<span class="keywordtype">bool</span> icethicknessMode)</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;{</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="comment">//static function</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="keywordflow">return</span> (fgInstance) ? (<a class="code" href="../../d5/d60/class_bedmap_reader.html">BedmapReader</a>*) fgInstance : <span class="keyword">new</span> <a class="code" href="../../d5/d60/class_bedmap_reader.html">BedmapReader</a>(icethicknessMode);</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;}</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">//_______________________________________________________________________________</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;Double_t BedmapReader::Surface(Double_t lon,Double_t lat) {</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="keywordflow">return</span> (SurfaceAboveGeoid(lon,lat) + Geoid(lat));</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;} <span class="comment">//Surface</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">//_______________________________________________________________________________</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;Double_t BedmapReader::SurfaceAboveGeoid(Double_t lon, Double_t lat) {</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="comment">//This method returns the elevation above the geoid of the surface of the top of the ice ice (or bare ground, if no ice is present) in meters, at a location specified by a latitude and longitude (in degrees). </span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  Double_t surface=0;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  Int_t e_coord_surface=0;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  Int_t n_coord_surface=0;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  SurfaceLonLattoEN(lon,lat,e_coord_surface,n_coord_surface);</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="keywordflow">if</span> (e_coord_surface &lt;= nCols_surface &amp;&amp; e_coord_surface &gt;= 0 &amp;&amp; n_coord_surface &lt;= nRows_surface &amp;&amp; n_coord_surface &gt;= 0)</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    surface = surface_elevation[e_coord_surface][n_coord_surface];</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    surface = NODATA;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  }</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">//   std::cout &lt;&lt; &quot;surface height &quot; &lt;&lt; surface &lt;&lt; &quot; e_co &quot; &lt;&lt; e_coord_surface &lt;&lt; &quot; n_co &quot; &lt;&lt; n_coord_surface &lt;&lt; &quot; lon &quot; &lt;&lt; lon &lt;&lt; &quot; lat &quot; &lt;&lt; lat &lt;&lt; std::endl;</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <span class="keywordflow">return</span> surface;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;} <span class="comment">//method SurfaceAboveGeoid</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">//_______________________________________________________________________________</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;Double_t BedmapReader::Geoid(Double_t latitude) {</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <span class="keywordflow">return</span> (GEOID_MIN*GEOID_MAX/sqrt(pow(GEOID_MIN,2)-(pow(GEOID_MIN,2)-pow(GEOID_MAX,2))*pow(cos(latitude*TMath::DegToRad()),2)));</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;} <span class="comment">//Geoid(lat)</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">//_______________________________________________________________________________</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;Double_t BedmapReader::SurfaceAboveGeoidRampDem(Double_t lon, Double_t lat) {</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <span class="keywordtype">double</span> searchVal = lat;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <span class="keywordtype">double</span> searchValFinal = lon;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <span class="keywordtype">double</span> lower = 0;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <span class="keywordtype">double</span>  upper = 0;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  <span class="keywordtype">double</span> finalVal = 0;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <span class="keywordtype">double</span> lowerEl =0;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <span class="keywordtype">double</span> upperEl =0;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  <span class="keywordtype">double</span> finalEl;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <span class="comment">//there may be more than one value that matches the latitude, so first lets fins find the upper and lower limit on this range</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; myIteratorLow = lower_bound(latVec.begin(), latVec.end(), searchVal);</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="keywordflow">if</span> (myIteratorLow == latVec.begin()) upper = *myIteratorLow; <span class="comment">// no smaller value  than val in vector</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="keywordflow">else</span> <span class="keywordflow">if</span> (myIteratorLow == latVec.end()) lower = *(myIteratorLow-1); <span class="comment">// no bigger value than val in vector</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="keywordflow">else</span> {</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    lower = *(myIteratorLow);</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;   lowerEl = distance(latVec.begin(),myIteratorLow); </div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;}</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160; myIteratorUp = upper_bound(latVec.begin(), latVec.end(), searchVal);</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="keywordflow">if</span> (myIteratorUp == latVec.begin()) upper = *myIteratorUp; <span class="comment">// no smaller value  than val in vector</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="keywordflow">else</span> <span class="keywordflow">if</span> (myIteratorUp == latVec.end()) lower = *(myIteratorUp-1); <span class="comment">// no bigger value than val in vector</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="keywordflow">else</span> {</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    upper = *(myIteratorUp);</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;   upperEl = distance(latVec.begin(),myIteratorUp); </div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;}</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">//now we have upper and lower limit, lets find the nearest longitude in this range of values</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160; myIteratorFinal = lower_bound(longVec.begin()+lowerEl, longVec.begin()+upperEl-1, searchValFinal);</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    </div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;   finalVal = *(myIteratorFinal);</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;   finalEl = distance(longVec.begin()+lowerEl,myIteratorFinal); </div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    finalEl = rampDemVec[finalEl+lowerEl].el1;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="comment">//cout &lt;&lt; finalEl &lt;&lt; endl;</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <span class="keywordflow">return</span> finalEl;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;}</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">//_______________________________________________________________________________</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="keywordtype">void</span> BedmapReader::ReadSurfaceElevation(<span class="keywordtype">bool</span> icethicknessMode) {</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <span class="comment">//Reads the BEDMAP data on the elevation of the surface beneath the ice.  If there is water beneath the ice, the ground elevation is given the value 0.  Assumes the file is in directory &quot;data&quot;.  Origianl code by Ryan Nichol.</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <span class="keywordtype">char</span> calibDir[FILENAME_MAX];</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  <span class="keywordtype">char</span> *calibEnv=getenv(<span class="stringliteral">&quot;ANITA_CALIB_DIR&quot;</span>);</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  <span class="keywordflow">if</span>(!calibEnv) {</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;     <span class="keywordtype">char</span> *utilEnv=getenv(<span class="stringliteral">&quot;ANITA_UTIL_INSTALL_DIR&quot;</span>);</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;     <span class="keywordflow">if</span>(!utilEnv)</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    sprintf(calibDir,<span class="stringliteral">&quot;calib&quot;</span>);</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;     <span class="keywordflow">else</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    sprintf(calibDir,<span class="stringliteral">&quot;%s/share/anitaCalib&quot;</span>,utilEnv);</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  }</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    strncpy(calibDir,calibEnv,FILENAME_MAX);</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  }</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  <span class="keywordtype">char</span> surfaceFile[FILENAME_MAX];</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  <span class="keywordflow">if</span>(!icethicknessMode)</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    sprintf(surfaceFile,<span class="stringliteral">&quot;%s/surfaceElevation.asc&quot;</span>,calibDir);</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <span class="keywordflow">else</span> </div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    sprintf(surfaceFile,<span class="stringliteral">&quot;/home/mottram/work/eventCorrelator/data/iceThickness.asc&quot;</span>);</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  ifstream SurfaceElevationFile(surfaceFile);</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  <span class="keywordflow">if</span>(!SurfaceElevationFile) {</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    std::cerr &lt;&lt; <span class="stringliteral">&quot;Couldn&#39;t open: &quot;</span> &lt;&lt; surfaceFile &lt;&lt; std::endl;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    exit(1);</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  }</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  std::cout &lt;&lt; calibDir &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; surfaceFile &lt;&lt; std::endl;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  std::cout&lt;&lt;<span class="stringliteral">&quot;Reading in BEDMAP data on surface elevation.\n&quot;</span>;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  <span class="keywordtype">string</span> tempBuf1;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  <span class="keywordtype">string</span> tempBuf2;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  <span class="keywordtype">string</span> tempBuf3;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  <span class="keywordtype">string</span> tempBuf4;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  <span class="keywordtype">string</span> tempBuf5;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  <span class="keywordtype">string</span> tempBuf6;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  Int_t temp1,temp2,temp3,temp4,temp5,temp6;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  </div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  SurfaceElevationFile &gt;&gt; tempBuf1 &gt;&gt; temp1 &gt;&gt; tempBuf2 &gt;&gt; temp2 </div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        &gt;&gt; tempBuf3 &gt;&gt; temp3 &gt;&gt; tempBuf4 &gt;&gt; temp4 </div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        &gt;&gt; tempBuf5 &gt;&gt; temp5 &gt;&gt; tempBuf6 &gt;&gt; temp6;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  </div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  <span class="keywordflow">if</span>(tempBuf1 == <span class="keywordtype">string</span>(<span class="stringliteral">&quot;ncols&quot;</span>)) {</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    nCols_surface=temp1;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  }</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <span class="keywordflow">if</span>(tempBuf2 == <span class="keywordtype">string</span>(<span class="stringliteral">&quot;nrows&quot;</span>)) {</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    nRows_surface=temp2;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  }</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <span class="keywordflow">if</span>(tempBuf3 == <span class="keywordtype">string</span>(<span class="stringliteral">&quot;xllcorner&quot;</span>)) {</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    xLowerLeft_surface=temp3;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  }</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <span class="keywordflow">if</span>(tempBuf4 == <span class="keywordtype">string</span>(<span class="stringliteral">&quot;yllcorner&quot;</span>)) {</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    yLowerLeft_surface=temp4;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  }</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  <span class="keywordflow">if</span>(tempBuf5 == <span class="keywordtype">string</span>(<span class="stringliteral">&quot;cellsize&quot;</span>)) {</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    cellSize=temp5;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  }</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  <span class="keywordflow">if</span>(tempBuf6 == <span class="keywordtype">string</span>(<span class="stringliteral">&quot;NODATA_value&quot;</span>)) {</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    NODATA=temp6;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  }</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  xUpperRight_surface = xLowerLeft_surface + cellSize*nCols_surface;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  yUpperRight_surface = yLowerLeft_surface + cellSize*nRows_surface;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  <span class="comment">//std::cout&lt;&lt;&quot;nCols_surface, nRows_surface &quot;&lt;&lt;nCols_surface&lt;&lt;&quot; , &quot;&lt;&lt;nRows_surface&lt;&lt;std::endl;</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  <span class="comment">//std::cout&lt;&lt;&quot;xLL_surface, yLL_surface, cellsize &quot;&lt;&lt;xLowerLeft_surface&lt;&lt;&quot; , &quot;&lt;&lt;yLowerLeft_surface&lt;&lt;&quot; , &quot;&lt;&lt;cellSize&lt;&lt;std::endl&lt;&lt;std::endl;</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  </div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  surface_elevation = std::vector&lt; std::vector&lt;short&gt; &gt;( nCols_surface, std::vector&lt;short&gt;( nRows_surface, 0 ) );</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  Double_t theValue;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  <span class="keywordflow">for</span>(Int_t rowNum=0;rowNum&lt;nRows_surface;rowNum++) {</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="keywordflow">for</span>(Int_t colNum=0;colNum&lt;nCols_surface;colNum++) {</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      SurfaceElevationFile &gt;&gt; theValue;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      </div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;      <span class="comment">// if(theValue==NODATA)</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;      <span class="comment">//    theValue=0; //Set elevation to 0 where we have no data.</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">//       surface_elevation[colNum][rowNum] = Double_t(theValue);</span></div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      surface_elevation[colNum][rowNum] = theValue;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;      <span class="comment">//if (theValue != -96 &amp;&amp; theValue != 0)</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;      <span class="comment">//std::cout&lt;&lt;&quot;surface_elevation: &quot;&lt;&lt;theValue&lt;&lt;std::endl;</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    }<span class="comment">//for</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  }<span class="comment">//for</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  </div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  SurfaceElevationFile.close();</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  <span class="keywordflow">return</span>;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;} <span class="comment">//method ReadSurfaceElevation</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">//_______________________________________________________________________________</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="keywordtype">void</span> BedmapReader::ReadSurfaceElevationRampDem() {</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <span class="comment">//Reads the BEDMAP data on the elevation of the surface beneath the ice.  If there is water beneath the ice, the ground elevation is given the value 0.  Assumes the file is in directory &quot;data&quot;.  Origianl code by Ryan Nichol.</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  <span class="keywordtype">char</span> calibDir[FILENAME_MAX];</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  <span class="keywordtype">char</span> *calibEnv=getenv(<span class="stringliteral">&quot;ANITA_CALIB_DIR&quot;</span>);</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <span class="keywordflow">if</span>(!calibEnv) {</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;     <span class="keywordtype">char</span> *utilEnv=getenv(<span class="stringliteral">&quot;ANITA_UTIL_INSTALL_DIR&quot;</span>);</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;     <span class="keywordflow">if</span>(!utilEnv)</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    sprintf(calibDir,<span class="stringliteral">&quot;calib&quot;</span>);</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;     <span class="keywordflow">else</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    sprintf(calibDir,<span class="stringliteral">&quot;%s/share/anitaCalib&quot;</span>,utilEnv);</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  }</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    strncpy(calibDir,calibEnv,FILENAME_MAX);</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  }</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  <span class="keywordtype">char</span> surfaceFile[FILENAME_MAX];</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  <span class="comment">//sprintf(surfaceFile,&quot;%s/ramp1kmdem_wgsosu_v2.txt&quot;,calibDir);</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  sprintf(surfaceFile,<span class="stringliteral">&quot;/unix/anita1/rampDemData/ramp1kmdem_wgsosu_v2.txt&quot;</span>);</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  ifstream SurfaceElevationFile(surfaceFile);</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  <span class="keywordflow">if</span>(!SurfaceElevationFile) {</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    std::cerr &lt;&lt; <span class="stringliteral">&quot;Couldn&#39;t open: &quot;</span> &lt;&lt; surfaceFile &lt;&lt; std::endl;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    exit(1);</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  }</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  std::cout&lt;&lt;<span class="stringliteral">&quot;Reading in RampDEM data on surface elevation.\n&quot;</span>;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160; </div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  Double_t latIn = 0;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  Double_t longIn = 0;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  Double_t el1In = 0;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  Double_t el2In = 0;  </div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  <a class="code" href="../../db/d26/structramp_data.html">rampData</a> dataIn;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  <span class="keywordflow">while</span> (!SurfaceElevationFile.eof()){</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    SurfaceElevationFile &gt;&gt; latIn;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    SurfaceElevationFile &gt;&gt; longIn;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        SurfaceElevationFile &gt;&gt; el1In;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        SurfaceElevationFile &gt;&gt; el2In;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    dataIn.lat = latIn;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    dataIn.longi = longIn;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    dataIn.el1 = el1In;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    dataIn.el2 = el2In;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    rampDemVec.push_back(dataIn);</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;       }</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  cout &lt;&lt; <span class="stringliteral">&quot;sorting data&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  std::sort(rampDemVec.begin(), rampDemVec.end(), comparitor);</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160; <span class="keywordflow">for</span> (vector&lt;rampData&gt;::iterator it = rampDemVec.begin(); it!=rampDemVec.end(); ++it) {</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160; </div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;   latVec.push_back(it-&gt;lat);</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;   longVec.push_back(it-&gt;longi);</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;   <span class="comment">//cout &lt;&lt; it-&gt;lat &lt;&lt; &quot;  &quot; &lt;&lt; it-&gt;longi &lt;&lt; endl;</span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  }</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  </div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  SurfaceElevationFile.close();</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  <span class="keywordflow">return</span>;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;} <span class="comment">//method ReadSurfaceElevation</span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment">//_______________________________________________________________________________</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;Double_t BedmapReader::Area(Double_t latitude) {</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  <span class="comment">//Returns the area of one square of the BEDMAP data at a given latitude. </span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  Double_t lat_rad = -latitude * TMath::DegToRad();</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  <span class="comment">//Double_t lat_rad = (90 - latitude) * TMath::DegToRad();</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  <span class="keywordflow">return</span> (pow(cellSize* ((1 + sin(71*TMath::DegToRad())) / (1 + sin(lat_rad))),2));</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;} <span class="comment">//method Area</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment">//_______________________________________________________________________________</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="keywordtype">void</span> BedmapReader::LonLattoEN(Double_t lon, Double_t lat, Double_t xLowerLeft, Double_t yLowerLeft, <span class="keywordtype">int</span>&amp; e_coord, <span class="keywordtype">int</span>&amp; n_coord) {</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  <span class="comment">//takes as input a latitude and longitude (in degrees) and converts to indicies for BEDMAP matricies. Needs a location for the corner of the matrix, as not all the BEDMAP files cover the same area.  Code by Stephen Hoover.</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  Double_t easting=0;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  Double_t northing=0;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;  Double_t lon_rad = lon * TMath::DegToRad(); <span class="comment">//convert to radians</span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  Double_t lat_rad = -lat * TMath::DegToRad();</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  bedmap_R = scale_factor*bedmap_c_0 * pow(( (1 + eccentricity*sin(lat_rad)) / (1 - eccentricity*sin(lat_rad)) ),eccentricity/2) * tan((TMath::Pi()/4) - lat_rad/2);</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  easting = bedmap_R * sin(lon_rad);</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  northing = bedmap_R * cos(lon_rad);</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  e_coord = (int)((easting - xLowerLeft) / cellSize);</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  n_coord = (int)((-1*northing - yLowerLeft) / cellSize);</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  <span class="keywordflow">return</span>;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;} <span class="comment">//method LonLattoEN</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment">//_______________________________________________________________________________</span></div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="keywordtype">void</span> BedmapReader::SurfaceLonLattoEN(Double_t lon, Double_t lat, <span class="keywordtype">int</span>&amp; e_coord, <span class="keywordtype">int</span>&amp; n_coord) {</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  <span class="comment">//Converts a latitude and longitude (in degrees) to indicies for BEDMAP surface elevation data.  Code by Stephen Hoover.</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  LonLattoEN(lon, lat, xLowerLeft_surface, yLowerLeft_surface, e_coord, n_coord);</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;}<span class="comment">//SurfaceLonLattoEN</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment">//_______________________________________________________________________________</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="keywordtype">void</span> BedmapReader::ENtoLonLat(Int_t e_coord, Int_t n_coord, Double_t xLowerLeft, Double_t yLowerLeft, Double_t&amp; lon, Double_t&amp; lat) {</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  <span class="comment">//Takes as input the indicies from a BEDMAP data set, and turns them into latitude and longitude coordinates.  Information on which data set (surface data, ice depth, water depth) is necessary, in the form of coordinates of a corner of the map.  Code by Stephen Hoover.</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  Double_t isometric_lat=0;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  Double_t easting = xLowerLeft+(cellSize*(e_coord+0.5)); <span class="comment">//Add offset of 0.5 to get coordinates of middle of cell instead of edges.</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  Double_t northing = -1*(yLowerLeft+(cellSize*(n_coord+0.5)));</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  <span class="comment">//first set longitude</span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  <span class="keywordflow">if</span> (northing!=0)</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    lon = atan(easting/northing);</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    lon = 90*TMath::DegToRad();</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  <span class="keywordflow">if</span> (easting &gt; 0 &amp;&amp; lon &lt; 0) <span class="comment">//adjust sign of longitude</span></div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    lon += TMath::Pi();</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (easting &lt; 0 &amp;&amp; lon &gt; 0)</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    lon -= TMath::Pi();</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (easting == 0 &amp;&amp; northing &lt; 0)</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    lon += TMath::Pi();</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  <span class="comment">//now find latitude</span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  <span class="keywordflow">if</span> (easting != 0)</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    bedmap_R = TMath::Abs(easting/sin(lon));</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (easting == 0 &amp;&amp; northing != 0)</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    bedmap_R = TMath::Abs(northing);</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    lat = 0; <span class="comment">//at the pole, set lat=0 degrees</span></div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    lon = lon*TMath::RadToDeg();</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  } <span class="comment">//else</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  isometric_lat = (TMath::Pi()/2) - 2*atan(bedmap_R/(scale_factor*bedmap_c_0));</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  lat = isometric_lat + bedmap_a_bar*sin(2*isometric_lat) + bedmap_b_bar*sin(4*isometric_lat) + bedmap_c_bar*sin(6*isometric_lat) + bedmap_d_bar*sin(8*isometric_lat);</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  lon = lon * TMath::RadToDeg();  <span class="comment">//convert to degrees</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  lat =  -lat*TMath::RadToDeg(); <span class="comment">//convert to degrees, with -90 degrees at the south pole</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;  <span class="keywordflow">return</span>;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;} <span class="comment">//method ENtoLonLat</span></div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment">//_______________________________________________________________________________</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="keywordtype">void</span> BedmapReader::SurfaceENtoLonLat(Int_t e, Int_t n, Double_t&amp; lon, Double_t&amp; lat) {</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  <span class="comment">//Converts indicies of the BEDMAP surface elevation matrix into longitude and latitude.  Code by Stephen Hoover.</span></div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  ENtoLonLat(e,n,xLowerLeft_surface,yLowerLeft_surface,lon,lat);</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;}<span class="comment">//SurfaceENtoLonLat</span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="comment">//_______________________________________________________________________________</span></div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;TProfile2D *BedmapReader::bedmapMap(<span class="keywordtype">int</span> coarseness_factor, <span class="keywordtype">int</span> set_log_scale,UInt_t &amp;xBins,UInt_t &amp;yBins){</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  Bool_t debug=<span class="keyword">false</span>;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  UInt_t num_columns = surface_elevation.size()/coarseness_factor;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  UInt_t num_rows = surface_elevation[0].size()/coarseness_factor;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  <span class="comment">//  UInt_t num_columns = 1096/coarseness_factor;</span></div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  <span class="comment">//  UInt_t num_rows = 911/coarseness_factor;</span></div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  xBins = num_columns;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  yBins = num_rows;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;xBins &quot;</span> &lt;&lt; xBins &lt;&lt; <span class="stringliteral">&quot; yBins &quot;</span> &lt;&lt; yBins &lt;&lt; std::endl;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="comment">//   TProfile2D * theHist = new TProfile2D( &quot;antarctica_surface_elevation_hist&quot;, &quot;&quot;, num_columns, x_min, x_max, num_rows, y_min, y_max+cell_size );</span></div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  TProfile2D * theHist = <span class="keyword">new</span> TProfile2D( <span class="stringliteral">&quot;antarctica_ice_thickness_hist&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, num_columns, xLowerLeft_surface, xUpperRight_surface, num_rows, yLowerLeft_surface, yUpperRight_surface );</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> row_index=0; row_index &lt; surface_elevation[0].size(); ++row_index){</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <span class="keywordflow">if</span>(debug){</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;      <span class="keywordflow">if</span>(row_index%(surface_elevation[0].size()/100)==0) std::cerr &lt;&lt; <span class="stringliteral">&quot;*&quot;</span>;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    }</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    </div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> column_index=0; column_index &lt; surface_elevation.size(); ++column_index)</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;      {</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="keywordflow">if</span>(surface_elevation[column_index][row_index]&lt;-9000)<span class="comment">//this is a silly scale for map drawing</span></div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;      surface_elevation[column_index][row_index]=-500;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="keywordflow">if</span> (set_log_scale == 1)</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;      theHist-&gt;Fill( xLowerLeft_surface + <span class="keywordtype">double</span>(column_index)*cellSize, -(yLowerLeft_surface + <span class="keywordtype">double</span>(row_index)*cellSize), log10(surface_elevation[column_index][row_index]+1000) ); <span class="comment">//The &quot;+1000&quot; makes sure everything is positive.</span></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="comment">//    theHist-&gt;Fill( x_min + double(column_index)*cell_size, -(y_min + double(row_index)*cell_size), log10(surface_elevation[column_index][row_index]+1000) ); //The &quot;+1000&quot; makes sure everything is positive.</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;      theHist-&gt;Fill( xLowerLeft_surface + <span class="keywordtype">double</span>(column_index)*cellSize, -(yLowerLeft_surface + <span class="keywordtype">double</span>(row_index)*cellSize), surface_elevation[column_index][row_index] );</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="comment">//    theHist-&gt;Fill( x_min + double(column_index)*cell_size, -(y_min + double(row_index)*cell_size), surface_elevation[column_index][row_index] );</span></div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;      } <span class="comment">//end for (loop over surface elevation vector)</span></div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;  }</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  <span class="keywordflow">if</span>(debug)</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    std::cout &lt;&lt; std::endl;</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  theHist-&gt;SetStats(0);</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  <span class="keywordflow">return</span> theHist;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;}</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="comment">//_______________________________________________________________________________</span></div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;TGaxis *BedmapReader::distanceScale(Double_t xMin,Double_t xMax,Double_t yMin,Double_t yMax){</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  <span class="comment">//here xmin, xmax etc are the positions in easting/northing of the distance scale</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  <span class="keywordflow">if</span>(xMax&lt;=xMin &amp;&amp; yMax&lt;=yMin) {</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    std::cerr &lt;&lt; <span class="stringliteral">&quot;size ordering wrong: xMin &quot;</span> &lt;&lt; xMin &lt;&lt; <span class="stringliteral">&quot; xMax &quot;</span> &lt;&lt; xMax &lt;&lt; <span class="stringliteral">&quot; yMin &quot;</span> &lt;&lt; yMin &lt;&lt; <span class="stringliteral">&quot; yMax &quot;</span> &lt;&lt; yMax &lt;&lt; std::endl;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  }</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  TGaxis *theAxis = <span class="keyword">new</span> TGaxis(xMin,yMin,xMax,yMax,0,sqrt((xMax-xMin)/1e3*(xMax-xMin)/1e3-(yMax-yMin)/1e3*(yMax-yMin)/1e3),2,<span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;  theAxis-&gt;SetTitle(<span class="stringliteral">&quot;km&quot;</span>);</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;  <span class="keywordflow">return</span> theAxis;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;}</div><div class="ttc" id="class_bedmap_reader_html_a5471b09d4f57169864fb28e63181475a"><div class="ttname"><a href="../../d5/d60/class_bedmap_reader.html#a5471b09d4f57169864fb28e63181475a">BedmapReader::Instance</a></div><div class="ttdeci">static BedmapReader * Instance(bool icethicknessMode)</div><div class="ttdoc">Instance generator. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d02/_bedmap_reader_8cxx_source.html#l00097">BedmapReader.cxx:97</a></div></div>
<div class="ttc" id="structramp_data_html"><div class="ttname"><a href="../../db/d26/structramp_data.html">rampData</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/d02/_bedmap_reader_8cxx_source.html#l00037">BedmapReader.cxx:37</a></div></div>
<div class="ttc" id="namespacestd_html"><div class="ttname"><a href="../../d8/dcc/namespacestd.html">std</a></div><div class="ttdoc">STL namespace. </div></div>
<div class="ttc" id="class_bedmap_reader_html"><div class="ttname"><a href="../../d5/d60/class_bedmap_reader.html">BedmapReader</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/dae/_bedmap_reader_8h_source.html#l00024">BedmapReader.h:24</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Apr 5 2021 19:55:40 for ANITA Software by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
