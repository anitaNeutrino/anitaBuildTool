<!-- HTML header for doxygen 1.8.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=9"/>
    <meta name="generator" content="Doxygen 1.8.11"/>
    <title>ANITA Software: components/icemc/testThermalNoise.cc Source File</title>
    <link href="../../tabs.css" rel="stylesheet" type="text/css"/>
    <script type="text/javascript" src="../../jquery.js"></script>
    <script type="text/javascript" src="../../dynsections.js"></script>
    <link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
    <link href="../../doxygen.css" rel="stylesheet" type="text/css" />
    <link href="../../customdoxygen.css" rel="stylesheet" type="text/css"/>
  </head>
  <body>
    <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
      <div id="titlearea">
	<table cellspacing="0" cellpadding="0">
	  <tbody>	    
	    <tr style="height: 56px;">
	      <td id="projectlogo"><img width="960" alt="Logo" src="../../anitaSoftware.png"/></td>
	    </tr>
	  </tbody>
	</table>
      </div>
      <!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Introduction</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_409f97388efe006bc3438b95e9edef48.html">components</a></li><li class="navelem"><a class="el" href="../../dir_de1961011fa38df2c6d5e9e49bef1e29.html">icemc</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">testThermalNoise.cc</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#include &lt;fstream&gt;</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &lt;sstream&gt;</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &lt;math.h&gt;</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &lt;ctype.h&gt;</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &lt;string&gt;</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &lt;stdio.h&gt;</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &lt;stdlib.h&gt;</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &lt;array&gt;</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &lt;time.h&gt;</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &quot;TTreeIndex.h&quot;</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &quot;TChain.h&quot;</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;TH1.h&quot;</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;TF1.h&quot;</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;TF2.h&quot;</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;TFile.h&quot;</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;icemc_random.h&quot;</span> </div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;TTree.h&quot;</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;TLegend.h&quot;</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;TLine.h&quot;</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;TROOT.h&quot;</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;TPostScript.h&quot;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;TCanvas.h&quot;</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;TH2F.h&quot;</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;TText.h&quot;</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;TProfile.h&quot;</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;TGraphErrors.h&quot;</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;TGraphAsymmErrors.h&quot;</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;TStyle.h&quot;</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;TMath.h&quot;</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &lt;unistd.h&gt;</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;TVector3.h&quot;</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;TRotation.h&quot;</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;TSpline.h&quot;</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;Math/InterpolationTypes.h&quot;</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &quot;Math/Interpolator.h&quot;</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &quot;signal.h&quot;</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">//#include &quot;rx.hpp&quot;</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &quot;Constants.h&quot;</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &quot;Settings.h&quot;</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &quot;position.hh&quot;</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &quot;earthmodel.hh&quot;</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#include &quot;Tools.h&quot;</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#include &quot;vector.hh&quot;</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#include &quot;roughness.hh&quot;</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#include &quot;anita.hh&quot;</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">#include &quot;balloon.hh&quot;</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#include &quot;icemodel.hh&quot;</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">// #include &quot;trigger.hh&quot;</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor">#include &quot;Spectra.h&quot;</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor">#include &quot;signal.hh&quot;</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor">#include &quot;secondaries.hh&quot;</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="preprocessor">#include &quot;ray.hh&quot;</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="preprocessor">#include &quot;counting.hh&quot;</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="preprocessor">#include &quot;Primaries.h&quot;</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="preprocessor">#include &quot;Taumodel.hh&quot;</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="preprocessor">#include &quot;screen.hh&quot;</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="preprocessor">#include &quot;GlobalTrigger.h&quot;</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="preprocessor">#include &quot;ChanTrigger.h&quot;</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="preprocessor">#include &quot;SimulatedSignal.h&quot;</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="preprocessor">#include &quot;EnvironmentVariable.h&quot;</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="preprocessor">#include &lt;string&gt;</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="preprocessor">#include &lt;sstream&gt;</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="preprocessor">#if __cplusplus &gt; 199711L</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="preprocessor">#include &lt;type_traits&gt;</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="preprocessor">#include &lt;typeinfo&gt;</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="preprocessor">#ifdef ANITA_UTIL_EXISTS</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="preprocessor">#include &quot;UsefulAnitaEvent.h&quot;</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="preprocessor">#include &quot;AnitaGeomTool.h&quot;</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="preprocessor">#include &quot;AnitaConventions.h&quot;</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="preprocessor">#include &quot;RawAnitaHeader.h&quot;</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="preprocessor">#include &quot;Adu5Pat.h&quot;</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="preprocessor">#include &quot;FFTtools.h&quot;</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<a class="code" href="../../d9/d4a/class_useful_anita_event.html">UsefulAnitaEvent</a>*     realEvPtr    = NULL;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<a class="code" href="../../d0/dc4/class_raw_anita_header.html">RawAnitaHeader</a>*       rawHeaderPtr = NULL;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<a class="code" href="../../d2/dbf/class_adu5_pat.html">Adu5Pat</a>*         Adu5PatPtr   = NULL;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="preprocessor">#ifdef ANITA3_EVENTREADER</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="preprocessor">#include &quot;TruthAnitaEvent.h&quot;</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<a class="code" href="../../d7/dd8/class_truth_anita_event.html">TruthAnitaEvent</a>*      truthEvPtr   = NULL;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<a class="code" href="../../d6/dc1/class_taumodel.html">Taumodel</a>* TauPtr = NULL;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="keyword">const</span> <span class="keywordtype">string</span> ICEMC_SRC_DIR = <a class="code" href="../../d4/d7f/namespace_environment_variable.html#a064f876067320b15e34beb8c29c8ffdc">EnvironmentVariable::ICEMC_SRC_DIR</a>();</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;ClassImp(<a class="code" href="../../df/d22/class_r_x.html">RX</a>);</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="keyword">using namespace </span><a class="code" href="../../d8/dcc/namespacestd.html">std</a>;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="keyword">class </span><a class="code" href="../../d1/d3b/class_earth_model.html">EarthModel</a>;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="keyword">class </span><a class="code" href="../../d7/d3b/class_position.html">Position</a>;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">/************MOVED FROM shared.hh and shared.cc*****************/</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">// These need to be moved elsewhere.</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">// They were all global variables inside of shared.hh.</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">// Most of these should not be global variables.</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="keyword">const</span> <span class="keywordtype">int</span> NVIEWANGLE=100; <span class="comment">// number of viewing angles to look at the signal,  on Seckel&#39;s request</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">// int irays; // counts rays (for roughness) // LC: commented out because not used</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="keywordtype">int</span> inu; <span class="comment">// counts neutrinos as they are generated</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;UInt_t eventNumber;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="keywordtype">double</span> eventsfound_beforetrigger=0.;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="keywordtype">double</span> eventsfound_crust=0; <span class="comment">//number of events that only traverse the crust</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="keywordtype">double</span> eventsfound_weightgt01=0; <span class="comment">// summing weights &gt; 0.1</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="keywordtype">double</span> eventsfound_belowhorizon=0; <span class="comment">// how many are below horizon</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="keywordtype">double</span> eventsfound=0;   <span class="comment">// how many events found</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="keywordtype">double</span> eventsfound_prob=0;   <span class="comment">// how many events found,  probabilities</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="keywordtype">double</span> sum[3]; <span class="comment">// sum of weight for events found for 3 flavors</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">// These numbers are from Feldman and Cousins wonderful paper:  physics/9711021</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="keywordtype">double</span> poissonerror_minus[21] = {0.-0.00, 1.-0.37, 2.-0.74, 3.-1.10, 4.-2.34, 5.-2.75, 6.-3.82, 7.-4.25, 8.-5.30, 9.-6.33, 10.-6.78, 11.-7.81, 12.-8.83, 13.-9.28, 14.-10.30, 15.-11.32, 16.-12.33, 17.-12.79, 18.-13.81, 19.-14.82, 20.-15.83};</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="keywordtype">double</span> poissonerror_plus[21] = {1.29-0., 2.75-1., 4.25-2., 5.30-3., 6.78-4., 7.81-5., 9.28-6., 10.30-7., 11.32-8., 12.79-9., 13.81-10., 14.82-11., 16.29-12., 17.30-13., 18.32-14., 19.32-15., 20.80-16., 21.81-17., 22.82-18., 23.82-19., 25.30-20.};</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="keyword">const</span> <span class="keywordtype">int</span> NBINS=10; <span class="comment">// keep track of the number of events found,  binned</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">// by weights</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="keywordtype">double</span> MIN_LOGWEIGHT=-3;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="keywordtype">double</span> MAX_LOGWEIGHT=-1;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="keywordtype">int</span> index_weights=0; <span class="comment">// which bin the weight falls into</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="keywordtype">double</span> eventsfound_binned[NBINS];</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="keywordtype">double</span> eventsfound_binned_e[NBINS];</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="keywordtype">double</span> eventsfound_binned_mu[NBINS];</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="keywordtype">double</span> eventsfound_binned_tau[NBINS];</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="keywordtype">double</span> km3sr = 0;                      <span class="comment">// total km3sr</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="keywordtype">double</span> km3sr_e=0;                       <span class="comment">// to calculate km3sr for electrons</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="keywordtype">double</span> km3sr_mu=0;                       <span class="comment">// to calculate km3sr for muons</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="keywordtype">double</span> km3sr_tau=0;                       <span class="comment">// to calculate km3sr for taus</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="keywordtype">double</span> error_plus=0;          <span class="comment">// keeping track of asymmetric error bars</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="keywordtype">double</span> error_e_plus=0;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="keywordtype">double</span> error_mu_plus=0;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="keywordtype">double</span> error_tau_plus=0;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="keywordtype">double</span> error_minus=0;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="keywordtype">double</span> error_e_minus=0;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="keywordtype">double</span> error_mu_minus=0;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="keywordtype">double</span> error_tau_minus=0;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="keywordtype">int</span> ierr=0; <span class="comment">// integer for returning error from functions.</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="keywordtype">double</span> gain_dipole=2.15;  <span class="comment">// antenna gain (nominal value for dipole is 2.15)</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="keywordtype">double</span> changle_deg=0; <span class="comment">// same,  in degrees.</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">// inputs</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="keywordtype">int</span> NNU;        <span class="comment">// number of neutrinos</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="keywordtype">int</span> whichray=0; <span class="comment">// indexes the rays that we look at (actually just used for ice but we use it in GetNuFlavor so keep it here)</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="keywordtype">double</span> RANDOMISEPOL=0.;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">/************MOVED FROM shared.hh and shared.cc*****************/</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="keywordtype">double</span> volume_thishorizon; <span class="comment">// for plotting volume within the horizon of the balloon</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="keywordtype">int</span> realtime_this;  <span class="comment">// for plotting real unix time</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="keywordtype">double</span> longitude_this; <span class="comment">// for plotting longitude</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="keywordtype">double</span> latitude_this; <span class="comment">// for plotting latitude</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="keywordtype">double</span> altitude_this; <span class="comment">// for plotting altitude</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="keywordtype">double</span> heading_this=0.;<span class="comment">// for plotting heading</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="keywordtype">double</span> gps_offset=0;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">// inputs</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="keywordtype">double</span> pnu=pow(10., 20);   </div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="keywordtype">double</span> MEANX=0;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="keywordtype">double</span> MEANY=0.;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="keywordtype">double</span> SIGNALRADIUS=2.; <span class="comment">// in degrees</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="keywordtype">double</span> bwslice_vnoise_thislayer[4];<span class="comment">// for filling tree6b,  noise for each bandwidth on each layer</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="keywordtype">int</span> passes_thisevent=0; <span class="comment">// this event passes</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="keywordtype">int</span> unmasked_thisevent=0; <span class="comment">// this event is unmasked</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="keywordtype">int</span> discones_passing;  <span class="comment">// number of discones that pass</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="keywordtype">int</span> NDISCONES=8;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="keywordtype">double</span> heff_discone=0; <span class="comment">// effective height of a discone antenna</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="keywordtype">double</span> polarfactor_discone=0.;<span class="comment">// factor to account for antenna beam pattern.</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="keywordtype">double</span> thislambda=0;<span class="comment">// for finding wavelength at each frequency</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="keywordtype">double</span> volts_discone=0.;<span class="comment">// for finding voltage at each discone</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="keywordtype">double</span> vnoise_discone=0.; <span class="comment">// noise on each discone</span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="keywordtype">double</span> BW_DISCONES=300.E6-120.E6; <span class="comment">// bandwidth of the discones</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">// ray tracing</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="keywordtype">double</span> fresnel1=0;  </div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="keywordtype">double</span> fresnel1_eachboresight[<a class="code" href="../../df/da2/class_anita.html#a6bc753f453f91e30ed38f3cc4c30fbc3">Anita::NLAYERS_MAX</a>][<a class="code" href="../../df/da2/class_anita.html#af367aa78f54d08086f0f9c283ee3105e">Anita::NPHI_MAX</a>];  <span class="comment">// for slac simulation</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="keywordtype">double</span> fresnel2=0;  </div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="keywordtype">double</span> mag1=0;  <span class="comment">// magnification factor on field at ice-firn interface</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="keywordtype">double</span> mag1_eachboresight[<a class="code" href="../../df/da2/class_anita.html#a6bc753f453f91e30ed38f3cc4c30fbc3">Anita::NLAYERS_MAX</a>][<a class="code" href="../../df/da2/class_anita.html#af367aa78f54d08086f0f9c283ee3105e">Anita::NPHI_MAX</a>];<span class="comment">// for slac simulation</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="keywordtype">double</span> mag2=0;  <span class="comment">// magnification factor on field in firn-air</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="keywordtype">double</span> t_coeff_pokey, t_coeff_slappy;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="keywordtype">double</span> rflength=0;  <span class="comment">// distance from interaction to ice-air exit point</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="keywordtype">double</span> e_comp_max1=0;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="keywordtype">double</span> h_comp_max1=0;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="keywordtype">double</span> e_comp_max2=0;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="keywordtype">double</span> h_comp_max2=0;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="keywordtype">double</span> e_comp_max3=0;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="keywordtype">double</span> h_comp_max3=0;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="keywordtype">double</span> diffexit=0;  <span class="comment">// checking exit point between_MAX interations</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="keywordtype">double</span> diff_3tries=0;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="keywordtype">double</span> diffnorm=0;  <span class="comment">// checking angle of surf normal between iterations</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="keywordtype">double</span> diffrefr=0;  <span class="comment">// checking angle of refr between iterations</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="keywordtype">double</span> costheta_inc=0;  <span class="comment">// cos angle of incidence wrt surface normal</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="keywordtype">double</span> costheta_exit=0; <span class="comment">// theta of exit point wrt earth (costheta=1 at south pole)</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="keywordtype">double</span> theta_rf_atbn; <span class="comment">// polar angle of the signal as seen by perfect eyes at the balloon.</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="keywordtype">double</span> theta_rf_atbn_measured; <span class="comment">//polar angle of the signal as measured at the balloon (just the above variable smeared by 0.5 degrees)</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="keywordtype">double</span> costhetanu=-1000; <span class="comment">// costheta of neutrino direction wrt earth (costheta=1 at south pole)</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment">// neutrino path</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="keywordtype">double</span> theta_in=0; <span class="comment">// theta where neutrino enters earth (radians, south pole=0)</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="keywordtype">double</span> lat_in=0; <span class="comment">// latitude where neutrino enters earth (degrees, south pole=-90)</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="keywordtype">double</span> nearthlayers=0; <span class="comment">// how many layers (core, mantle, crust) does nnu traverse</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="keywordtype">double</span> weight_prob=0.;<span class="comment">//event weight,  including probability it interacts somewhere in ice along its path</span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="keywordtype">double</span> weight1=0; <span class="comment">// event weight,  just based on absorption in earth,  see note</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="keywordtype">double</span> weight=0.; <span class="comment">// total event weight (product of the previous 2)</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="keywordtype">double</span> logweight=0.;<span class="comment">// log of the previous number</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="keywordtype">double</span> len_int=0;<span class="comment">// interaction length in m</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="keywordtype">double</span> pieceofkm2sr=0; <span class="comment">// Use this for making plots comparing different cross sections.  The integral of a plot from a run will be the total Area*sr of the detector.  That way it is proportional to the cross section and the integral is something meaningful to people.</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="keywordtype">double</span> CUTONWEIGHTS=1.E-10; <span class="comment">// cut out events with small enough weight that they don&#39;t matter,  to save time</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">// counting variables</span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="keywordtype">int</span> count_inthisloop1=0; <span class="comment">// for debugging</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="keywordtype">int</span> count_inthisloop2=0;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="keywordtype">int</span> count_inthisloop3=0;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="keywordtype">double</span> averaging_thetas1=0; <span class="comment">// for debugging</span></div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="keywordtype">double</span> averaging_thetas2=0;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="keywordtype">double</span> averaging_thetas3=0;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="keywordtype">int</span> count_total=0; <span class="comment">// number of neutrinos looped over.  should always equal inu</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">// i.e.,  is theoretically visible by balloon</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="keywordtype">int</span> count_asktrigger=0;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="keywordtype">int</span> count_asktrigger_nfb=0;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="keywordtype">int</span> count_pass=0;  <span class="comment">// how many total trigger channels pass (4 bandwidth slices*2 pol * nrx)</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="keywordtype">double</span> count_passestrigger_w=0; <span class="comment">// same as above,  but sum weights</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="keywordtype">int</span> passestrigger=0; <span class="comment">// 1=this event passes trigger, 0=does not</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">// so that we know to increment count_passestrigger_w at the end of the event</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="keywordtype">int</span> allcuts[2]={0, 0}; <span class="comment">// index is which ray (upward or downward)</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">// 1=this ray for this event passes all cuts,  0=does not</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="keywordtype">double</span> allcuts_weighted[2]={0, 0}; <span class="comment">// same as above but weighted</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="keywordtype">double</span> allcuts_weighted_polarization[3]={0, 0, 0}; <span class="comment">// same as above but divided into [0] vpol, [1] hpol, [2] both vpol and hpol</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment">//signal has a chance to pass after accounting for 1/r</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="keywordtype">int</span> count_chanceofsurviving=0; <span class="comment">// based on neutrino direction,  has a chance of making it through earth.</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="keywordtype">int</span> count_chanceinhell0=0; <span class="comment">// based on 1/r,  and best case attenuation</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment">// (after 2nd guess at rf exit point)</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">// signal has a chance of passing</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="keywordtype">double</span> count_chanceinhell2_w=0; <span class="comment">//same as above,  but sum weights</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="keywordtype">int</span> chanceinhell2=0; <span class="comment">// 1=this event has chance to pass, 0=does not-</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">// so that we know to increment count_chanceinhell2_w by weight1 at the end.</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="keywordtype">int</span> count_chordgoodlength=0; <span class="comment">// Incremented if neutrino path through earth is more than 1m</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="keywordtype">int</span> count_d2goodlength=0; <span class="comment">// neutrino path through ice is more than 1m</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="keywordtype">int</span> count_rx=0; <span class="comment">// counting antennas we loop through them</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="keywordtype">double</span> sum_frac[3]; <span class="comment">// fraction of passing events that are e, mu, tau adding weights</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="keywordtype">double</span> sum_frac_db[3]; <span class="comment">// same for double bangs</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="keyword">const</span> <span class="keywordtype">int</span> NBINS_DISTANCE=28; <span class="comment">// keep track of number that pass as a function of distance to make Peter&#39;s plot</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="keywordtype">double</span> eventsfound_binned_distance[NBINS_DISTANCE] = {0.};  <span class="comment">// binning cumulative events found vs. distance</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="keywordtype">int</span> index_distance=0; <span class="comment">// index for filling array above</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="keywordtype">double</span> km3sr_distance[NBINS_DISTANCE] = {0.}; <span class="comment">// result of conversion of events to sensitivity</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="keywordtype">double</span> error_distance_plus[NBINS_DISTANCE] = {0.}; <span class="comment">// errors on above</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="keywordtype">double</span> error_distance_minus[NBINS_DISTANCE] = {0.};</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="keywordtype">int</span> eventsfound_binned_distance_forerror[NBINS_DISTANCE][NBINS] = {{0}}; <span class="comment">// for propagation of errors</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">//taus</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="keywordtype">double</span> km3sr_db = 0;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="keywordtype">double</span> km3sr_nfb=0;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="keywordtype">double</span> ptau=0;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="keywordtype">int</span> count_passestrigger_nfb=0;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="keywordtype">double</span> percent_increase_db=0;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="keywordtype">double</span> percent_increase_nfb=0;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="keywordtype">double</span> percent_increase_total=0;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="keywordtype">double</span> error_nfb=0;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="keywordtype">double</span> error_km3sr_nfb=0;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="keywordtype">double</span> error_percent_increase_nfb=0;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<a class="code" href="../../d5/db2/class_vector.html">Vector</a> n_exit2bn_db[5];</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<a class="code" href="../../d5/db2/class_vector.html">Vector</a> nrf_iceside_db[5];  <span class="comment">// direction of rf [tries][3d]</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="keywordtype">double</span> n_exit_phi;  <span class="comment">//phi angle of the ray from the surface to the balloon</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="keywordtype">int</span> count_dbexitsice=0;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">// int count_interacts_in_earth=0;</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="keywordtype">double</span> eventsfound_nfb_binned[NBINS]; <span class="comment">// counting events without first bang</span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">// rf parameters</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="keywordtype">double</span> heff_max=0.62639; <span class="comment">// maximum value of the effective height based on antenna specs</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">// event geometry</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="keywordtype">double</span> scalefactor_distance=0; <span class="comment">// 1/r scalefactor</span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="keywordtype">double</span> scalefactor_attenuation=0; <span class="comment">//scalefactor due to attenuation in ice</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="keywordtype">double</span> MAX_ATTENLENGTH=1671;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="keywordtype">double</span> maxtaper=0; <span class="comment">// this is just for plotting - maximum you are ever off cerenkov cone while</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment">//an event is detectable</span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="keywordtype">double</span> dviewangle_deg=0; </div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="keywordtype">double</span> forseckel[NVIEWANGLE][Anita::NFREQ];<span class="comment">// Per Seckel&#39;s request,  get strength of signal across frequencies for different viewing angles.</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="keywordtype">double</span> viewangles[NVIEWANGLE];</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="keywordtype">double</span> GetAirDistance(<span class="keywordtype">double</span> altitude_bn,  <span class="keywordtype">double</span> beta); <span class="comment">// given beta=angle wrt horizontal that the ray hits the balloon,  calculate distance that the ray traveled in air,  including curvature of earth</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment">//Input files</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="keywordtype">int</span> err=0; <span class="comment">// errors from GetDirection function</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="keywordtype">double</span> djunk; <span class="comment">// junk variable</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">//For verification plots - added by Stephen</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="keywordtype">int</span> max_antenna0 = -1;  <span class="comment">//antenna with the peak voltage,  top layer</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="keywordtype">int</span> max_antenna1 = -1;  <span class="comment">//antenna with the peak voltage,  middle layer</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="keywordtype">int</span> max_antenna2 = -1;  <span class="comment">//antenna with the peak voltage,  bottom layer</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="keywordtype">double</span> max_antenna_volts0 = 0; <span class="comment">//Voltage on the antenna with maximum signal,  top layer</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="keywordtype">double</span> max_antenna_volts0_em = 0; <span class="comment">//Component of voltage from em shower on the antenna with maximum signal,  top layer</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="keywordtype">double</span> max_antenna_volts1 = 0; <span class="comment">//Voltage on the antenna with maximum signal,  middle layer</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="keywordtype">double</span> max_antenna_volts2 = 0; <span class="comment">//Voltage on the antenna with maximum signal,  bottom layer</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="keywordtype">double</span> rx0_signal_eachband[2][5];</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="keywordtype">double</span> rx0_threshold_eachband[2][5];</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="keywordtype">double</span> rx0_noise_eachband[2][5];</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="keywordtype">int</span> rx0_passes_eachband[2][5];</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="keywordtype">double</span> voltagearray[<a class="code" href="../../df/da2/class_anita.html#a6bc753f453f91e30ed38f3cc4c30fbc3">Anita::NLAYERS_MAX</a>*<a class="code" href="../../df/da2/class_anita.html#af367aa78f54d08086f0f9c283ee3105e">Anita::NPHI_MAX</a>]; <span class="comment">//Records max voltages on each antenna for one neutrino</span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<a class="code" href="../../d5/db2/class_vector.html">Vector</a> ant_max_normal0; <span class="comment">//Vector normal to the face of the antenna with the maximum signal for a single neutrino,  top layer</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<a class="code" href="../../d5/db2/class_vector.html">Vector</a> ant_max_normal1; <span class="comment">//Vector normal to the face of the antenna with the maximum signal for a single neutrino,  middle layer</span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<a class="code" href="../../d5/db2/class_vector.html">Vector</a> ant_max_normal2; <span class="comment">//Vector normal to the face of the antenna with the maximum signal for a single neutrino,  bottom layer</span></div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="keywordtype">double</span> vmmhz1m_visible = 0; <span class="comment">//Actual V/m/Mhz at 1m</span></div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="keywordtype">int</span> freq_bins = Anita::NFREQ; <span class="comment">//Because the compiler objected to using the const directly</span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="keywordtype">double</span> total_kgm2 = 0; <span class="comment">// output of Getchord</span></div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="keywordtype">double</span> nnu_array[3];</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="keywordtype">double</span> r_in_array[3];</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="keywordtype">double</span> nsurf_rfexit_array[3];</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="keywordtype">double</span> nsurf_rfexit_db_array[3];</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="keywordtype">double</span> r_bn_array[3];</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="keywordtype">double</span> n_bn_array[3];</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="keywordtype">double</span> posnu_array[3];</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="keywordtype">double</span> nrf_iceside_array[5][3];</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="keywordtype">double</span> nrf_iceside_db_array[5][3];</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="keywordtype">double</span> ant_max_normal0_array[3];</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="keywordtype">double</span> ant_max_normal1_array[3];</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="keywordtype">double</span> ant_max_normal2_array[3];</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="keywordtype">double</span> n_pol_array[3];</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="keywordtype">double</span> n_exit2bn_array[5][3];</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="keywordtype">double</span> r_enterice_array[3];</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="keywordtype">double</span> n_exit2bn_db_array[5][3];</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="keywordtype">double</span> rfexit_array[5][3];</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="keywordtype">double</span> rfexit_db_array[5][3];</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="keywordtype">int</span> times_crust_entered_det=0;  <span class="comment">//Counter for total times each Earth layer is entered for detected neutrinos only</span></div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="keywordtype">int</span> times_mantle_entered_det=0;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="keywordtype">int</span> times_core_entered_det=0;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="keywordtype">int</span> crust_entered=0;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="keywordtype">int</span> mantle_entered=0;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="keywordtype">int</span> core_entered=0;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="keywordtype">int</span> neutrinos_passing_all_cuts=0;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="keywordtype">double</span> sum_weights=0;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment">//End verification plot block</span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="keywordtype">double</span> justNoise_trig[2][48][512];</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="keywordtype">double</span> justSignal_trig[2][48][512];</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="keywordtype">double</span> justNoise_dig[2][48][512];</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="keywordtype">double</span> justSignal_dig[2][48][512];</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment">// functions</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment">// set up array of viewing angles for making plots for seckel</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="keywordtype">void</span> SetupViewangles(<a class="code" href="../../dc/d20/class_signal.html">Signal</a> *sig1);</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="keywordtype">void</span> GetAir(<span class="keywordtype">double</span> *col1); <span class="comment">// get air column as a function of theta- only important for black hole studies</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="keywordtype">double</span> GetThisAirColumn(<a class="code" href="../../db/d2b/class_settings.html">Settings</a>*,  <a class="code" href="../../d7/d3b/class_position.html">Position</a> r_in,  <a class="code" href="../../d5/db2/class_vector.html">Vector</a> nnu, <a class="code" href="../../d7/d3b/class_position.html">Position</a> posnu,  <span class="keywordtype">double</span> *col1,  <span class="keywordtype">double</span>&amp; cosalpha, <span class="keywordtype">double</span>&amp; mytheta,  <span class="keywordtype">double</span>&amp; cosbeta0, <span class="keywordtype">double</span>&amp; mybeta);</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="keywordtype">double</span> ScaleVmMHz(<span class="keywordtype">double</span> vmmhz1m_max,  <span class="keyword">const</span> <a class="code" href="../../d7/d3b/class_position.html">Position</a> &amp;posnu,  <span class="keyword">const</span> <a class="code" href="../../d7/d3b/class_position.html">Position</a> &amp;r_bn);</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="keywordtype">double</span> IsItDoubleBang(<span class="keywordtype">double</span> exitlength,  <span class="keywordtype">double</span> plepton);</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="keywordtype">int</span> WhereIsSecondBang(<span class="keyword">const</span> <a class="code" href="../../d7/d3b/class_position.html">Position</a>&amp; posnu,  <span class="keyword">const</span> <a class="code" href="../../d5/db2/class_vector.html">Vector</a>&amp; nnu,  <span class="keywordtype">double</span> nuexitlength,  <span class="keywordtype">double</span> pnu,  <a class="code" href="../../de/d63/class_ice_model.html">IceModel</a> *antarctica1,  <span class="keyword">const</span> <a class="code" href="../../d7/d3b/class_position.html">Position</a>&amp; r_bn, <a class="code" href="../../d7/d3b/class_position.html">Position</a> &amp;posnu2,  <a class="code" href="../../d7/d3b/class_position.html">Position</a> &amp;rfexit_db,  <a class="code" href="../../d5/db2/class_vector.html">Vector</a> &amp;n_exit2bn_db);</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="keywordtype">void</span> GetCurrent(<span class="keywordtype">string</span>&amp; current);</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="keywordtype">double</span> GetAverageVoltageFromAntennasHit(<a class="code" href="../../db/d2b/class_settings.html">Settings</a> *settings1,  <span class="keywordtype">int</span> *nchannels_perrx_triggered,  <span class="keywordtype">double</span> *voltagearray,  <span class="keywordtype">double</span>&amp; volts_rx_sum);</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<a class="code" href="../../d5/db2/class_vector.html">Vector</a> GetPolarization(<span class="keyword">const</span> <a class="code" href="../../d5/db2/class_vector.html">Vector</a> &amp;nnu,  <span class="keyword">const</span> <a class="code" href="../../d5/db2/class_vector.html">Vector</a> &amp;nrf2_iceside);</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="keywordtype">void</span> Attenuate(<a class="code" href="../../de/d63/class_ice_model.html">IceModel</a> *antartica1, <a class="code" href="../../db/d2b/class_settings.html">Settings</a> *settings1,  <span class="keywordtype">double</span>&amp; vmmhz_max,  <span class="keywordtype">double</span> rflength,  <span class="keyword">const</span> <a class="code" href="../../d7/d3b/class_position.html">Position</a> &amp;posnu);</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="keywordtype">void</span> Attenuate_down(<a class="code" href="../../de/d63/class_ice_model.html">IceModel</a> *antarctica1,  <a class="code" href="../../db/d2b/class_settings.html">Settings</a> *settings1,  <span class="keywordtype">double</span>&amp; vmmhz_max,  <span class="keyword">const</span> <a class="code" href="../../d7/d3b/class_position.html">Position</a> &amp;rfexit2,  <span class="keyword">const</span> <a class="code" href="../../d7/d3b/class_position.html">Position</a> &amp;posnu,  <span class="keyword">const</span> <a class="code" href="../../d7/d3b/class_position.html">Position</a> &amp;posnu_down);</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="keywordtype">void</span> IsAbsorbed(<span class="keywordtype">double</span> chord_kgm2,  <span class="keywordtype">double</span> len_int_kgm2,  <span class="keywordtype">double</span>&amp; weight);</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="keywordtype">int</span> GetRayIceSide(<span class="keyword">const</span> <a class="code" href="../../d5/db2/class_vector.html">Vector</a> &amp;n_exit2rx,  <span class="keyword">const</span> <a class="code" href="../../d5/db2/class_vector.html">Vector</a> &amp;nsurf_rfexit,  <span class="keywordtype">double</span> nexit,  <span class="keywordtype">double</span> nenter,  <a class="code" href="../../d5/db2/class_vector.html">Vector</a> &amp;nrf2_iceside);</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="keywordtype">double</span> GetViewAngle(<span class="keyword">const</span> <a class="code" href="../../d5/db2/class_vector.html">Vector</a> &amp;nrf2_iceside,  <span class="keyword">const</span> <a class="code" href="../../d5/db2/class_vector.html">Vector</a> &amp;nnu);</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="keywordtype">int</span> TIR(<span class="keyword">const</span> <a class="code" href="../../d5/db2/class_vector.html">Vector</a> &amp;n_surf,  <span class="keyword">const</span> <a class="code" href="../../d5/db2/class_vector.html">Vector</a> &amp;nrf2_iceside,  <span class="keywordtype">double</span> N_IN,  <span class="keywordtype">double</span> N_OUT);</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="keywordtype">void</span> IntegrateBands(Anita *anita1,  <span class="keywordtype">int</span> k,  Screen *panel1,  <span class="keywordtype">double</span> *freq,  <span class="keywordtype">double</span> scalefactor,  <span class="keywordtype">double</span> *sumsignal);</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="keywordtype">void</span> Integrate(Anita *anita1,  <span class="keywordtype">int</span> j,  <span class="keywordtype">int</span> k,  <span class="keywordtype">double</span> *vmmhz,  <span class="keywordtype">double</span> *freq,  <span class="keywordtype">double</span> scalefactor,  <span class="keywordtype">double</span> sumsignal);</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="keywordtype">void</span> interrupt_signal_handler(<span class="keywordtype">int</span>);  <span class="comment">// This catches the Control-C interrupt,  SIGINT</span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="keywordtype">bool</span> ABORT_EARLY = <span class="keyword">false</span>;    <span class="comment">// This flag is set to true when interrupt_signal_handler() is called</span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="keywordtype">void</span> WriteNeutrinoInfo(<a class="code" href="../../d7/d3b/class_position.html">Position</a>&amp;,  <a class="code" href="../../d5/db2/class_vector.html">Vector</a>&amp;,  <a class="code" href="../../d7/d3b/class_position.html">Position</a>&amp;,  <span class="keywordtype">double</span>,  <span class="keywordtype">string</span>,  <span class="keywordtype">string</span>,  <span class="keywordtype">double</span>,  ofstream &amp;nu_out);</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="keywordtype">void</span> CloseTFile(TFile *hfile);</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="keywordtype">int</span> Getmine(<span class="keywordtype">double</span>*,  <span class="keywordtype">double</span>*,  <span class="keywordtype">double</span>*,  <span class="keywordtype">double</span>*);</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="keywordtype">void</span> Getearth(<span class="keywordtype">double</span>*,  <span class="keywordtype">double</span>*,  <span class="keywordtype">double</span>*,  <span class="keywordtype">double</span>*);</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="preprocessor">#ifdef ANITA_UTIL_EXISTS</span></div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="keywordtype">int</span> GetIceMCAntfromUsefulEventAnt(<a class="code" href="../../db/d2b/class_settings.html">Settings</a> *settings1,  <span class="keywordtype">int</span> UsefulEventAnt);</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="preprocessor">#ifdef R_EARTH</span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="preprocessor">#undef R_EARTH</span></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="keywordtype">double</span> thresholdsAnt[48][2][5];</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="keywordtype">double</span> thresholdsAntPass[48][2][5];</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment">//do a threshold scan</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="keywordtype">double</span> threshold_start=-1.;</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="keywordtype">double</span> threshold_end=-6.;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="keyword">const</span> <span class="keywordtype">int</span> NTHRESHOLDS=20;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="keywordtype">double</span> threshold_step=(threshold_end-threshold_start)/(<span class="keywordtype">double</span>)NTHRESHOLDS;</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="keywordtype">double</span> npass_v_thresh[NTHRESHOLDS]={0.};</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="keywordtype">double</span> denom_v_thresh[NTHRESHOLDS]={0.};</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="keywordtype">double</span> npass_h_thresh[NTHRESHOLDS]={0.};</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="keywordtype">double</span> denom_h_thresh[NTHRESHOLDS]={0.};</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="keywordtype">double</span> thresholds[NTHRESHOLDS];</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc,  <span class="keywordtype">char</span> **argv) {</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  <span class="comment">//--------------------------------------------------------------</span></div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  <span class="comment">//  MC Anita</span></div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  <span class="comment">// 12/01/03</span></div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  <span class="comment">//--------------------------------------------------------------</span></div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;  <span class="comment">// // for comparing with peter</span></div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  <span class="comment">// double sumsignal[5]={0.};</span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;  <span class="keywordtype">string</span> stemp;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  <a class="code" href="../../db/d2b/class_settings.html">Settings</a>* settings1 = <span class="keyword">new</span> <a class="code" href="../../db/d2b/class_settings.html">Settings</a>();</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;  <span class="keywordtype">string</span> input= ICEMC_SRC_DIR + <span class="stringliteral">&quot;/inputs.conf&quot;</span>;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  <span class="keywordtype">string</span> run_num;<span class="comment">//current run number as string</span></div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  <span class="keywordtype">int</span> run_no = 0;<span class="comment">//current run number as integer</span></div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;  TString outputdir;</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  </div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  <span class="keywordflow">if</span>( (argc%3!=1)&amp;&amp;(argc%2!=1)) {</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;Syntax for options: -i inputfile -o outputdir -r run_number\n&quot;</span>;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  }</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  <span class="keywordtype">int</span> nnu_tmp=0;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  <span class="keywordtype">double</span> exp_tmp=0;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  <span class="keywordtype">double</span> trig_thresh=0.;</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  <span class="keywordtype">char</span> clswitch; <span class="comment">// command line switch</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;  <span class="keywordflow">if</span> (argc&gt;1) {</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <span class="keywordflow">while</span> ((clswitch = getopt(argc, argv, <span class="stringliteral">&quot;t:i:o:r:n:e:&quot;</span>)) != EOF) {</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;      <span class="keywordflow">switch</span>(clswitch) {</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;      <span class="keywordflow">case</span> <span class="charliteral">&#39;n&#39;</span>:</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    nnu_tmp=atoi(optarg);</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;Changed number of simulated neutrinos to &quot;</span> &lt;&lt; nnu_tmp &lt;&lt; endl;</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;      <span class="keywordflow">case</span> <span class="charliteral">&#39;t&#39;</span>:</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    trig_thresh=atof(optarg);</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;      <span class="keywordflow">case</span> <span class="charliteral">&#39;i&#39;</span>:</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        input=optarg;</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;Changed input file to: &quot;</span> &lt;&lt; input &lt;&lt; endl;</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;      <span class="keywordflow">case</span> <span class="charliteral">&#39;o&#39;</span>:</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        outputdir=optarg;</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;Changed output directory to: &quot;</span> &lt;&lt; string(outputdir.Data()) &lt;&lt; endl;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        stemp=<span class="stringliteral">&quot;mkdir -p &quot;</span> + string(outputdir.Data());</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        system(stemp.c_str());</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;      <span class="keywordflow">case</span> <span class="charliteral">&#39;r&#39;</span>:</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        run_num=optarg;</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        stringstream convert(run_num);</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;        convert&gt;&gt;run_no;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;      } <span class="comment">// end switch</span></div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    } <span class="comment">// end while</span></div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  } <span class="comment">// end if arg&gt;1</span></div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;  settings1-&gt;SEED=settings1-&gt;SEED +run_no;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;  cout &lt;&lt;<span class="stringliteral">&quot;seed is &quot;</span> &lt;&lt; settings1-&gt;SEED &lt;&lt; endl;</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  setSeed(settings1-&gt;SEED); </div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;  stemp=string(outputdir.Data())+<span class="stringliteral">&quot;/nu_position&quot;</span>+run_num+<span class="stringliteral">&quot;.txt&quot;</span>;</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;  ofstream nu_out(stemp.c_str(),  ios::app); <span class="comment">//Positions,  direction of momentum,  and neutrino type for Ryan.</span></div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;  stemp=string(outputdir.Data())+<span class="stringliteral">&quot;/veff&quot;</span>+run_num+<span class="stringliteral">&quot;.txt&quot;</span>;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;  ofstream veff_out(stemp.c_str(),  ios::app);<span class="comment">//to output only energy and effective volume to veff.txt</span></div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;  stemp=string(outputdir.Data())+<span class="stringliteral">&quot;/distance&quot;</span>+run_num+<span class="stringliteral">&quot;.txt&quot;</span>;</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;  ofstream distanceout(stemp.c_str());</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;  stemp=string(outputdir.Data())+<span class="stringliteral">&quot;/debug&quot;</span>+run_num+<span class="stringliteral">&quot;.txt&quot;</span>;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;  fstream outfile(stemp.c_str(), ios::out);</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  stemp=string(outputdir.Data())+<span class="stringliteral">&quot;/forbrian&quot;</span>+run_num+<span class="stringliteral">&quot;.txt&quot;</span>;</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  fstream forbrian(stemp.c_str(), ios::out);</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;  stemp=string(outputdir.Data())+<span class="stringliteral">&quot;/al_voltages_direct&quot;</span>+run_num+<span class="stringliteral">&quot;.dat&quot;</span>;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;  fstream al_voltages_direct(stemp.c_str(), ios::out); <span class="comment">//added djg ------provide anita-lite voltages and noise from MC for anita-lite analysis</span></div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;  stemp=string(outputdir.Data())+<span class="stringliteral">&quot;/events&quot;</span>+run_num+<span class="stringliteral">&quot;.txt&quot;</span>;</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;  ofstream eventsthatpassfile(stemp.c_str());</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;  stemp=string(outputdir.Data())+<span class="stringliteral">&quot;/numbers&quot;</span>+run_num+<span class="stringliteral">&quot;.txt&quot;</span>;</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;  ofstream fnumbers(stemp.c_str()); <span class="comment">// debugging</span></div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;  stemp=string(outputdir.Data())+<span class="stringliteral">&quot;/output&quot;</span>+run_num+<span class="stringliteral">&quot;.txt&quot;</span>;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;  ofstream foutput(stemp.c_str(),  ios::app);</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  stemp=string(outputdir.Data())+<span class="stringliteral">&quot;/slacviewangles&quot;</span>+run_num+<span class="stringliteral">&quot;.dat&quot;</span>;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;  ofstream fslac_viewangles(stemp.c_str()); <span class="comment">// this outputs numbers that we need for analyzing slac data</span></div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;  stemp=string(outputdir.Data())+<span class="stringliteral">&quot;/slac_hitangles&quot;</span>+run_num+<span class="stringliteral">&quot;.dat&quot;</span>;</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;  ofstream fslac_hitangles(stemp.c_str()); <span class="comment">// this outputs numbers that we need for analyzing slac data</span></div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  <a class="code" href="../../d2/d24/class_balloon.html">Balloon</a> *bn1=<span class="keyword">new</span> <a class="code" href="../../d2/d24/class_balloon.html">Balloon</a>(); <span class="comment">// instance of the balloon</span></div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;  Anita *anita1=<span class="keyword">new</span> Anita();<span class="comment">// right now this constructor gets banding info</span></div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;  <a class="code" href="../../d6/d1a/class_secondaries.html">Secondaries</a> *sec1=<span class="keyword">new</span> <a class="code" href="../../d6/d1a/class_secondaries.html">Secondaries</a>();</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;  <a class="code" href="../../dc/d20/class_signal.html">Signal</a> *sig1=<span class="keyword">new</span> <a class="code" href="../../dc/d20/class_signal.html">Signal</a>();</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;  <a class="code" href="../../d2/d1f/class_ray.html">Ray</a> *ray1=<span class="keyword">new</span> <a class="code" href="../../d2/d1f/class_ray.html">Ray</a>(); <span class="comment">// create new instance of the ray class</span></div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  <a class="code" href="../../d4/de2/class_counting.html">Counting</a> *count1=<span class="keyword">new</span> <a class="code" href="../../d4/de2/class_counting.html">Counting</a>();</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;  <span class="comment">// input parameters</span></div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;  settings1-&gt;ReadInputs(input.c_str(),  foutput, NNU, RANDOMISEPOL);</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;  settings1-&gt;ApplyInputs(anita1,  sec1,  sig1,  bn1,  ray1);</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  sig1-&gt;Initialize();</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;  settings1-&gt;SEED=settings1-&gt;SEED + run_no;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;  setSeed(settings1-&gt;SEED);</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;  bn1-&gt;InitializeBalloon();</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;  anita1-&gt;Initialize(settings1, foutput, inu, outputdir);</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;  <span class="keywordflow">if</span> (nnu_tmp!=0)</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    NNU=nnu_tmp;</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;  <span class="keywordflow">if</span> (exp_tmp!=0)</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    settings1-&gt;EXPONENT=exp_tmp;</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  settings1-&gt;SIGNAL_FLUCT=1;</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;  settings1-&gt;ZEROSIGNAL=1;</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;  </div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;  time_t raw_start_time = time(NULL);</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;  <span class="keyword">struct </span>tm * start_time = localtime(&amp;raw_start_time);</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;  cout &lt;&lt; <span class="stringliteral">&quot;Date and time at start of run are: &quot;</span> &lt;&lt; asctime (start_time) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;  <span class="comment">// zeroing global variables.</span></div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;  Tools::Zero(sum_frac, 3);</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;  Tools::Zero(sum_frac_db, 3);</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;  Tools::Zero(anita1-&gt;NRX_PHI, <a class="code" href="../../df/da2/class_anita.html#a6bc753f453f91e30ed38f3cc4c30fbc3">Anita::NLAYERS_MAX</a>);</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="../../df/da2/class_anita.html#a6bc753f453f91e30ed38f3cc4c30fbc3">Anita::NLAYERS_MAX</a>;i++) {</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    Tools::Zero(anita1-&gt;PHI_EACHLAYER[i], <a class="code" href="../../df/da2/class_anita.html#af367aa78f54d08086f0f9c283ee3105e">Anita::NPHI_MAX</a>);</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;  }</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;  Tools::Zero(anita1-&gt;PHI_OFFSET, Anita::NLAYERS_MAX);</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;  Tools::Zero(anita1-&gt;THETA_ZENITH, Anita::NLAYERS_MAX);</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;  Tools::Zero(anita1-&gt;LAYER_VPOSITION, Anita::NLAYERS_MAX);</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;  Tools::Zero(anita1-&gt;RRX, Anita::NLAYERS_MAX);</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;  <span class="comment">// frequency binning</span></div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;  <span class="keywordtype">double</span> vmmhz[Anita::NFREQ];                        <span class="comment">//  V/m/MHz at balloon (after all steps)</span></div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;  <span class="comment">// given the angle you are off the Cerenkov cone,  the fraction of the observed e field that comes from the em shower</span></div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;  <span class="keywordtype">double</span> vmmhz_em[Anita::NFREQ];</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;  <span class="keywordtype">double</span> vmmhz_min_thatpasses=1000;</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160; </div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;  <span class="keywordtype">string</span> taudecay;                   <span class="comment">// tau decay type: e, m, h</span></div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;  <span class="keywordtype">double</span> volts_rx_rfcm_lab_e_all[48][512];</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;  <span class="keywordtype">double</span> volts_rx_rfcm_lab_h_all[48][512];</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  <span class="comment">// variable declarations for functions GetEcompHcompEvector and GetEcompHcompkvector - oindree</span></div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;  <span class="keywordtype">double</span> e_component[Anita::NANTENNAS_MAX]={0}; <span class="comment">// E comp along polarization</span></div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;  <span class="keywordtype">double</span> h_component[Anita::NANTENNAS_MAX]={0}; <span class="comment">// H comp along polarization</span></div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;  <span class="keywordtype">double</span> n_component[Anita::NANTENNAS_MAX]={0}; <span class="comment">// normal comp along polarization</span></div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;  <span class="keywordtype">double</span> e_component_kvector[Anita::NANTENNAS_MAX]={0}; <span class="comment">// component of e-field along the rx e-plane</span></div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;  <span class="keywordtype">double</span> h_component_kvector[Anita::NANTENNAS_MAX]={0}; <span class="comment">// component of the e-field along the rx h-plane</span></div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;  <span class="keywordtype">double</span> n_component_kvector[Anita::NANTENNAS_MAX]={0}; <span class="comment">// component of the e-field along the normal</span></div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;  <span class="comment">// Vector n_eplane = const_z;</span></div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;  <span class="comment">// Vector n_hplane = -const_y;</span></div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;  <span class="comment">// Vector n_normal = const_x;</span></div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;  <a class="code" href="../../d5/db2/class_vector.html">Vector</a> ant_normal; <span class="comment">//Vector normal to the face of the antenna</span></div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;  <span class="comment">// double hitangle_e, hitangle_h;       // angle the ray hits the antenna wrt e-plane, h-plane</span></div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;  <span class="keywordtype">double</span> hitangle_e_all[Anita::NANTENNAS_MAX];         <span class="comment">// hit angles rel. to e plane stored for each antenna</span></div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;  <span class="keywordtype">double</span> hitangle_h_all[Anita::NANTENNAS_MAX];         <span class="comment">// hit angles rel. to h plane stored for each antenna</span></div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;  <span class="keywordtype">double</span> eventsfound_db=0; <span class="comment">// same,  for double bang</span></div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;  <span class="keywordtype">double</span> eventsfound_nfb=0; <span class="comment">// for taus</span></div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;  <span class="keywordtype">double</span> sourceLon=-999;</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;  <span class="keywordtype">double</span> sourceAlt=-999;</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;  <span class="keywordtype">double</span> sourceLat=-999;</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;  <a class="code" href="../../d5/db2/class_vector.html">Vector</a> n_nutraject_ontheground; <span class="comment">//direction of the neutrino from the person standing on the ground just below the balloon.</span></div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;  <a class="code" href="../../d5/db2/class_vector.html">Vector</a> n_pol; <span class="comment">// direction of polarization</span></div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;  <span class="comment">// Vector n_pol_eachboresight[Anita::NLAYERS_MAX][Anita::NPHI_MAX]; // direction of polarization of signal seen at each antenna</span></div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;  <a class="code" href="../../d5/db2/class_vector.html">Vector</a> n_pol_db; <span class="comment">// same,  double bangs</span></div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;  <span class="keywordtype">int</span> l3trig[<a class="code" href="../../df/da2/class_anita.html#a1c7ef28c5f83fa1e858a7d7bb64d666a">Anita::NPOL</a>];  <span class="comment">// 16 bit number which says which phi sectors pass L3 V-POL</span></div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;  <span class="comment">// For each trigger layer,  which &quot;clumps&quot; pass L2.  16 bit,  16 bit and 8 bit for layers 1 &amp; 2 and nadirs</span></div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;  <span class="keywordtype">int</span> l2trig[<a class="code" href="../../df/da2/class_anita.html#a1c7ef28c5f83fa1e858a7d7bb64d666a">Anita::NPOL</a>][Anita::NTRIGGERLAYERS_MAX];</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;  <span class="comment">//For each trigger layer,  which antennas pass L1.  16 bit,  16 bit and 8 bit and layers 1,  2 and nadirs</span></div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;  <span class="keywordtype">int</span> l1trig[<a class="code" href="../../df/da2/class_anita.html#a1c7ef28c5f83fa1e858a7d7bb64d666a">Anita::NPOL</a>][Anita::NTRIGGERLAYERS_MAX];</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;  eventsfound=0.; <span class="comment">// sums weights for events that pass</span></div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;  Tools::Zero(count1-&gt;npass, 2); <span class="comment">// sums events that pass,  without weights</span></div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;  Tools::Zero(sum, 3);</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;  eventsfound_db=0;</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  eventsfound_nfb=0;</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;  Tools::Zero(eventsfound_binned, NBINS);</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;  Tools::Zero(eventsfound_binned_e, NBINS);</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;  Tools::Zero(eventsfound_binned_mu, NBINS);</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;  Tools::Zero(eventsfound_binned_tau, NBINS);</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;  Tools::Zero(eventsfound_nfb_binned, NBINS);</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;  </div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;  Tools::Zero(anita1-&gt;arrival_times[0], Anita::NLAYERS_MAX*<a class="code" href="../../df/da2/class_anita.html#af367aa78f54d08086f0f9c283ee3105e">Anita::NPHI_MAX</a>);</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;  Tools::Zero(anita1-&gt;arrival_times[1], Anita::NLAYERS_MAX*<a class="code" href="../../df/da2/class_anita.html#af367aa78f54d08086f0f9c283ee3105e">Anita::NPHI_MAX</a>);</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;  <span class="comment">//we pick both the interaction point and its corresponding mirror point</span></div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  <span class="keywordtype">int</span> pdgcode=-999;</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;<span class="preprocessor">#ifdef ANITA_UTIL_EXISTS</span></div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;  <span class="keywordtype">string</span> outputAnitaFile =string(outputdir.Data())+<span class="stringliteral">&quot;/SimulatedAnitaEventFile&quot;</span>+run_num+<span class="stringliteral">&quot;.root&quot;</span>;</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;  TFile *anitafileEvent = <span class="keyword">new</span> TFile(outputAnitaFile.c_str(), <span class="stringliteral">&quot;RECREATE&quot;</span>);</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;  TTree *eventTree = <span class="keyword">new</span> TTree(<span class="stringliteral">&quot;eventTree&quot;</span>, <span class="stringliteral">&quot;eventTree&quot;</span>);</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;  eventTree-&gt;Branch(<span class="stringliteral">&quot;event&quot;</span>,             &amp;realEvPtr           );</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;  eventTree-&gt;Branch(<span class="stringliteral">&quot;run&quot;</span>,               &amp;run_no,   <span class="stringliteral">&quot;run/I&quot;</span>   );</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;  eventTree-&gt;Branch(<span class="stringliteral">&quot;weight&quot;</span>,            &amp;weight,   <span class="stringliteral">&quot;weight/D&quot;</span>);</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;  outputAnitaFile =string(outputdir.Data())+<span class="stringliteral">&quot;/SimulatedAnitaHeadFile&quot;</span>+run_num+<span class="stringliteral">&quot;.root&quot;</span>;</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;  TFile *anitafileHead = <span class="keyword">new</span> TFile(outputAnitaFile.c_str(), <span class="stringliteral">&quot;RECREATE&quot;</span>);</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;  TTree *headTree = <span class="keyword">new</span> TTree(<span class="stringliteral">&quot;headTree&quot;</span>, <span class="stringliteral">&quot;headTree&quot;</span>);</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;  headTree-&gt;Branch(<span class="stringliteral">&quot;header&quot;</span>,  &amp;rawHeaderPtr           );</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;  headTree-&gt;Branch(<span class="stringliteral">&quot;weight&quot;</span>,  &amp;weight,      <span class="stringliteral">&quot;weight/D&quot;</span>);</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;  outputAnitaFile =string(outputdir.Data())+<span class="stringliteral">&quot;/SimulatedAnitaGpsFile&quot;</span>+run_num+<span class="stringliteral">&quot;.root&quot;</span>;</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;  TFile *anitafileGps = <span class="keyword">new</span> TFile(outputAnitaFile.c_str(), <span class="stringliteral">&quot;RECREATE&quot;</span>);</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;  TTree *adu5PatTree = <span class="keyword">new</span> TTree(<span class="stringliteral">&quot;adu5PatTree&quot;</span>, <span class="stringliteral">&quot;adu5PatTree&quot;</span>);</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;  adu5PatTree-&gt;Branch(<span class="stringliteral">&quot;pat&quot;</span>,          &amp;Adu5PatPtr                   );</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;  adu5PatTree-&gt;Branch(<span class="stringliteral">&quot;eventNumber&quot;</span>,  &amp;eventNumber,  <span class="stringliteral">&quot;eventNumber/I&quot;</span>);</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;  adu5PatTree-&gt;Branch(<span class="stringliteral">&quot;weight&quot;</span>,       &amp;weight,       <span class="stringliteral">&quot;weight/D&quot;</span>     );</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;<span class="preprocessor">#ifdef ANITA3_EVENTREADER</span></div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;  <span class="comment">// Set AnitaVersion so that the right payload geometry is used</span></div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;  AnitaVersion::set(settings1-&gt;ANITAVERSION);</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;  </div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;  outputAnitaFile =string(outputdir.Data())+<span class="stringliteral">&quot;/SimulatedAnitaTruthFile&quot;</span>+run_num+<span class="stringliteral">&quot;.root&quot;</span>;</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;  TFile *anitafileTruth = <span class="keyword">new</span> TFile(outputAnitaFile.c_str(), <span class="stringliteral">&quot;RECREATE&quot;</span>);</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;  TString icemcgitversion = TString::Format(<span class="stringliteral">&quot;%s&quot;</span>, EnvironmentVariable::ICEMC_VERSION(outputdir));  </div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;  printf(<span class="stringliteral">&quot;ICEMC GIT Repository Version: %s\n&quot;</span>, icemcgitversion.Data());</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> timenow = time(NULL);</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;  TTree *configAnitaTree = <span class="keyword">new</span> TTree(<span class="stringliteral">&quot;configIcemcTree&quot;</span>, <span class="stringliteral">&quot;Config file and settings information&quot;</span>);</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;  configAnitaTree-&gt;Branch(<span class="stringliteral">&quot;gitversion&quot;</span>,   &amp;icemcgitversion  );</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;  configAnitaTree-&gt;Branch(<span class="stringliteral">&quot;startTime&quot;</span>,    &amp;timenow          );</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;  <span class="comment">// configAnitaTree-&gt;Branch(&quot;settings&quot;,  &amp;settings1                    );</span></div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;  configAnitaTree-&gt;Fill();</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160; </div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;  TTree *truthAnitaTree = <span class="keyword">new</span> TTree(<span class="stringliteral">&quot;truthAnitaTree&quot;</span>, <span class="stringliteral">&quot;Truth Anita Tree&quot;</span>);</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;  truthAnitaTree-&gt;Branch(<span class="stringliteral">&quot;truth&quot;</span>,     &amp;truthEvPtr                   );</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;  <a class="code" href="../../d8/db1/class_anita_geom_tool.html">AnitaGeomTool</a> *AnitaGeom1 = <a class="code" href="../../d8/db1/class_anita_geom_tool.html#a1082689d96e9b03316b7625a9de37b44">AnitaGeomTool::Instance</a>();</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;  </div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;  </div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;  <a class="code" href="../../de/d63/class_ice_model.html">IceModel</a> *antarctica = <span class="keyword">new</span> <a class="code" href="../../de/d63/class_ice_model.html">IceModel</a>(settings1-&gt;ICE_MODEL + settings1-&gt;NOFZ*10, settings1-&gt;CONSTANTICETHICKNESS * 1000 + settings1-&gt;CONSTANTCRUST * 100 + settings1-&gt;FIXEDELEVATION * 10 + 0, settings1-&gt;WEIGHTABSORPTION);</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;  cout &lt;&lt; <span class="stringliteral">&quot;area of the earth&#39;s surface covered by antarctic ice is &quot;</span> &lt;&lt; antarctica-&gt;ice_area &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;  </div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;  <span class="comment">// sets position of balloon and related quantities</span></div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;  <span class="comment">// these are all passed as pointers</span></div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;  <span class="comment">// theta,  phi,  altitude of balloon</span></div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;  <span class="comment">// position of balloon,  altitude and position of surface of earth (relative to the center of the earth) under balloon</span></div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;  bn1-&gt;SetDefaultBalloonPosition(antarctica);</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;  </div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;  <span class="comment">// builds payload based on read inputs</span></div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;  anita1-&gt;GetPayload(settings1,  bn1);</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;  <span class="comment">// if (settings1-&gt;TRIGGERSCHEME == 3 || settings1-&gt;TRIGGERSCHEME == 4 || settings1-&gt;TRIGGERSCHEME==5) {</span></div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;  <a class="code" href="../../d5/db2/class_vector.html">Vector</a> plusz(0., 0., 1.);</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;  bn1-&gt;PickBalloonPosition(plusz, antarctica, settings1, anita1);</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;  </div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;  time_t raw_loop_start_time = time(NULL);</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;  cout&lt;&lt;<span class="stringliteral">&quot;Starting loop over events.  Time required for setup is &quot;</span>&lt;&lt;(int)((raw_loop_start_time - raw_start_time)/60)&lt;&lt;<span class="stringliteral">&quot;:&quot;</span>&lt;&lt; ((raw_loop_start_time - raw_start_time)%60)&lt;&lt;endl;</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160; </div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;  <span class="comment">// for averaging balloon altitude and distance from center of earth</span></div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;  <span class="comment">// for comparing with Peter</span></div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;  <span class="keywordtype">double</span> average_altitude=0.;</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;  <span class="keywordtype">double</span> average_rbn=0.;</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;  signal(SIGINT,  interrupt_signal_handler);     <span class="comment">// This function call allows icemc to gracefully abort and write files as usual rather than stopping abruptly.</span></div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;  <span class="keywordtype">int</span> antNum;</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;  <span class="comment">// begin looping over NNU neutrinos doing the things</span></div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;  <span class="keywordflow">for</span> (inu = 0; inu &lt; NNU; inu++) {</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    <span class="keywordflow">if</span> (NNU &gt;= 100) {</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;      <span class="keywordflow">if</span> (inu % (NNU / 100) == 0)</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;        cout &lt;&lt; inu &lt;&lt; <span class="stringliteral">&quot; neutrinos. &quot;</span> &lt;&lt; (double(inu)/double(NNU)) * 100 &lt;&lt; <span class="stringliteral">&quot;% complete.\n&quot;</span>;</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    }</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;      cout &lt;&lt; inu &lt;&lt; <span class="stringliteral">&quot; neutrinos.  &quot;</span> &lt;&lt; (double(inu) / double(NNU)) * 100 &lt;&lt; <span class="stringliteral">&quot;% complete.\n&quot;</span>;</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    </div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    eventNumber=(UInt_t)(run_no)*NNU+inu;</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    </div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    <span class="comment">// Set seed of all random number generators to be dependent on eventNumber</span></div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    setSeed(eventNumber); </div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    </div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    anita1-&gt;passglobtrig[0]=0;</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    anita1-&gt;passglobtrig[1]=0;</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    passes_thisevent=0;</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    unmasked_thisevent=1;</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    vmmhz_min_thatpasses=1000; <span class="comment">// initializing.  want to find the minumum voltage that passes a</span></div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;   </div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    count_pass=0;</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    passestrigger=0;</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    chanceinhell2=0;</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    <span class="comment">// sec1-&gt;secondbang=false;</span></div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    count_total++;</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    <span class="comment">// initializing the voltage seen by each polarization of each antenna</span></div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    bn1-&gt;dtryingposition=-999;</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;Anita::NFREQ;i++) {</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;      vmmhz[i] = 0.; <span class="comment">// the full signal with all factors accounted for (1/r,  atten. etc.)</span></div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;      vmmhz_em[i]=0.; <span class="comment">// for keeping track of just the em component of the shower</span></div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    } <span class="comment">//Zero the vmmhz array - helpful for banana plots,  shouldn&#39;t affect anything else - Stephen</span></div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    </div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    <span class="comment">// Picks the balloon position and at the same time sets the masks and thresholds</span></div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    bn1-&gt;PickBalloonPosition(antarctica,  settings1,  inu,  anita1,  getRNG(RNG_BALLOON_POSITION)-&gt;Rndm());</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;      </div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    <span class="comment">// find average balloon altitude and distance from center of earth for</span></div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    <span class="comment">// making comparisons with Peter</span></div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    average_altitude+=bn1-&gt;altitude_bn/(double)NNU;</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    average_rbn+=bn1-&gt;r_bn.Mag()/(double)NNU;</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    realtime_this=bn1-&gt;realTime_flightdata;</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    longitude_this=bn1-&gt;longitude;</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    latitude_this=bn1-&gt;latitude;</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    altitude_this=bn1-&gt;altitude;</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    heading_this=bn1-&gt;heading;</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ilayer=0; ilayer &lt; settings1-&gt;NLAYERS; ilayer++) { <span class="comment">// loop over layers on the payload</span></div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ifold=0;ifold&lt;anita1-&gt;NRX_PHI[ilayer];ifold++) { <span class="comment">// ifold loops over phi</span></div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;          </div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    <a class="code" href="../../dd/d24/class_chan_trigger.html">ChanTrigger</a> *chantrig1 = <span class="keyword">new</span> <a class="code" href="../../dd/d24/class_chan_trigger.html">ChanTrigger</a>();</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    chantrig1-&gt;<a class="code" href="../../dd/d24/class_chan_trigger.html#a4fcd80f9a174f236b60a6606ac0599b2">InitializeEachBand</a>(anita1);</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    antNum = anita1-&gt;GetRxTriggerNumbering(ilayer, ifold);</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;      </div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    </div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;<span class="preprocessor">#ifdef ANITA_UTIL_EXISTS</span></div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    <span class="keywordflow">if</span> (settings1-&gt;SIGNAL_FLUCT &amp;&amp; (settings1-&gt;NOISEFROMFLIGHTDIGITIZER || settings1-&gt;NOISEFROMFLIGHTTRIGGER) )</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;      chantrig1-&gt;<a class="code" href="../../dd/d24/class_chan_trigger.html#a321c3efd1737beef5af3d3bc31b26351">getNoiseFromFlight</a>(settings1, anita1, antNum);</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    <span class="comment">//    chantrig1-&gt;ApplyAntennaGain(settings1, anita1, bn1, panel1, antNum, n_eplane, n_hplane, n_normal);</span></div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    </div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;    <span class="comment">// chantrig1-&gt;injectImpulseAfterAntenna(anita1, antNum);</span></div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    </div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;    memset(chantrig1-&gt;<a class="code" href="../../dd/d24/class_chan_trigger.html#a25f076258aebe64f91b42e0769c4f81e">volts_rx_forfft</a>, 0, <span class="keyword">sizeof</span>(chantrig1-&gt;<a class="code" href="../../dd/d24/class_chan_trigger.html#a25f076258aebe64f91b42e0769c4f81e">volts_rx_forfft</a>));</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    chantrig1-&gt;<a class="code" href="../../dd/d24/class_chan_trigger.html#a3bbedfa72e4d8b4001fcef036a6ed286">TriggerPath</a>(settings1, anita1, antNum, bn1);</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    </div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    chantrig1-&gt;<a class="code" href="../../dd/d24/class_chan_trigger.html#a261ab5103931c402e8855a6f33922eb2">DigitizerPath</a>(settings1, anita1, antNum, bn1);</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    </div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    chantrig1-&gt;<a class="code" href="../../dd/d24/class_chan_trigger.html#a0e009613e4c8712b28075a00427b5fc6">TimeShiftAndSignalFluct</a>(settings1, anita1, ilayer, ifold, volts_rx_rfcm_lab_e_all,  volts_rx_rfcm_lab_h_all);</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    chantrig1-&gt;<a class="code" href="../../dd/d24/class_chan_trigger.html#af874b19d040e267a525bc2777f57173b">saveTriggerWaveforms</a>(anita1, justSignal_trig[0][antNum], justSignal_trig[1][antNum], justNoise_trig[0][antNum], justNoise_trig[1][antNum]);</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    chantrig1-&gt;<a class="code" href="../../dd/d24/class_chan_trigger.html#aa893bb77e40efd72317a10e4ed2a3880">saveDigitizerWaveforms</a>(anita1, justSignal_dig[0][antNum], justSignal_dig[1][antNum], justNoise_dig[0][antNum], justNoise_dig[1][antNum]);</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160; </div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    <span class="comment">// chantrig1-&gt;WhichBandsPass(settings1, anita1, globaltrig1, bn1, ilayer, ifold,  viewangle-sig1-&gt;changle, emfrac, hadfrac, thresholdsAnt[antNum]);</span></div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    <span class="comment">//  cout &lt;&lt; inu &lt;&lt; &quot; &quot; &lt;&lt; ilayer &lt;&lt; &quot; &quot; &lt;&lt; ifold &lt;&lt; endl;</span></div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    <span class="keyword">delete</span> chantrig1;</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;           </div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;      } <span class="comment">//loop through the phi-fold antennas</span></div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;    }  <span class="comment">//loop through the layers of antennas</span></div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    <span class="keywordflow">if</span> ( <span class="keyword">true</span> ) {</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;          </div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;<span class="preprocessor">#ifdef ANITA_UTIL_EXISTS</span></div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;      realEvPtr   = <span class="keyword">new</span> <a class="code" href="../../d9/d4a/class_useful_anita_event.html">UsefulAnitaEvent</a>();</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;      rawHeaderPtr  = <span class="keyword">new</span> <a class="code" href="../../d0/dc4/class_raw_anita_header.html">RawAnitaHeader</a>();</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;      Adu5PatPtr  = <span class="keyword">new</span> <a class="code" href="../../d2/dbf/class_adu5_pat.html">Adu5Pat</a>();</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;      Adu5PatPtr-&gt;<a class="code" href="../../d2/dbf/class_adu5_pat.html#a3879b506194eb2cefff3fa13d6b8c766">latitude</a>  = bn1-&gt;latitude;</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;      Adu5PatPtr-&gt;<a class="code" href="../../d2/dbf/class_adu5_pat.html#a881469fddb163b232c688b82924232bd">longitude</a> = bn1-&gt;longitude;</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;      Adu5PatPtr-&gt;<a class="code" href="../../d2/dbf/class_adu5_pat.html#a299db954c0d3dc3f5d38e155cf5638f3">altitude</a>  = bn1-&gt;altitude;</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;      Adu5PatPtr-&gt;<a class="code" href="../../d2/dbf/class_adu5_pat.html#a4427ff546161494952d8843b98ba58c1">realTime</a>  = bn1-&gt;realTime_flightdata;</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;      Adu5PatPtr-&gt;<a class="code" href="../../d2/dbf/class_adu5_pat.html#a8aca444bcebad17c7645ec7d65afb7e4">heading</a>   = bn1-&gt;heading;</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;      Adu5PatPtr-&gt;<a class="code" href="../../d2/dbf/class_adu5_pat.html#af99a5597edfa5c86c4c4afd7841582b9">pitch</a>     = bn1-&gt;pitch;</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;      Adu5PatPtr-&gt;roll      = bn1-&gt;roll;</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;      Adu5PatPtr-&gt;run       = run_no;</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;      memset(realEvPtr-&gt;<a class="code" href="../../d9/d4a/class_useful_anita_event.html#ae86589d99938983649c75844d9853de8">fNumPoints</a>, 0, <span class="keyword">sizeof</span>(realEvPtr-&gt;<a class="code" href="../../d9/d4a/class_useful_anita_event.html#ae86589d99938983649c75844d9853de8">fNumPoints</a>) );</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;      memset(realEvPtr-&gt;<a class="code" href="../../d9/d4a/class_useful_anita_event.html#af702281d452d17cca331c620e06ad317">fVolts</a>,     0, <span class="keyword">sizeof</span>(realEvPtr-&gt;<a class="code" href="../../d9/d4a/class_useful_anita_event.html#af702281d452d17cca331c620e06ad317">fVolts</a>)     );</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;      memset(realEvPtr-&gt;<a class="code" href="../../d9/d4a/class_useful_anita_event.html#a14969bce1dc32ecc09f4d531c811b32b">fTimes</a>,     0, <span class="keyword">sizeof</span>(realEvPtr-&gt;<a class="code" href="../../d9/d4a/class_useful_anita_event.html#a14969bce1dc32ecc09f4d531c811b32b">fTimes</a>)     );</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;      </div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;      <span class="keywordtype">int</span> fNumPoints = 260;</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iant = 0; iant &lt; settings1-&gt;NANTENNAS; iant++){</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    <span class="comment">//int IceMCAnt = GetIceMCAntfromUsefulEventAnt(anita1,  AnitaGeom1,  iant);</span></div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    <span class="keywordtype">int</span> IceMCAnt = GetIceMCAntfromUsefulEventAnt(settings1,  iant);</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    <span class="keywordtype">int</span> UsefulChanIndexH = AnitaGeom1-&gt;<a class="code" href="../../d8/db1/class_anita_geom_tool.html#af1a3c9c9884f3cb09f520ad2dad96ea3">getChanIndexFromAntPol</a>(iant,  <a class="code" href="../../d4/df7/namespace_anita_pol.html#af98f5337ced6b7416f396f5ae76a14d7ad43edda04c9c2e92af2204d77cf0278d">AnitaPol::kHorizontal</a>);</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    <span class="keywordtype">int</span> UsefulChanIndexV = AnitaGeom1-&gt;<a class="code" href="../../d8/db1/class_anita_geom_tool.html#af1a3c9c9884f3cb09f520ad2dad96ea3">getChanIndexFromAntPol</a>(iant,  <a class="code" href="../../d4/df7/namespace_anita_pol.html#af98f5337ced6b7416f396f5ae76a14d7ab0265e0d23894d3ebafa94a767fad35a">AnitaPol::kVertical</a>);</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    realEvPtr-&gt;<a class="code" href="../../d9/d4a/class_useful_anita_event.html#ae86589d99938983649c75844d9853de8">fNumPoints</a>[UsefulChanIndexV] = fNumPoints;</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    realEvPtr-&gt;<a class="code" href="../../d9/d4a/class_useful_anita_event.html#ae86589d99938983649c75844d9853de8">fNumPoints</a>[UsefulChanIndexH] = fNumPoints;</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    realEvPtr-&gt;<a class="code" href="../../d6/d74/class_raw_anita_event.html#a82b9c921a5b03e60eaf80fab14b9adf0">chanId</a>[UsefulChanIndexV] = UsefulChanIndexV;</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    realEvPtr-&gt;<a class="code" href="../../d6/d74/class_raw_anita_event.html#a82b9c921a5b03e60eaf80fab14b9adf0">chanId</a>[UsefulChanIndexH] = UsefulChanIndexH;</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; fNumPoints; j++) {</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;      <span class="comment">// convert seconds to nanoseconds</span></div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;      realEvPtr-&gt;<a class="code" href="../../d9/d4a/class_useful_anita_event.html#a14969bce1dc32ecc09f4d531c811b32b">fTimes</a>[UsefulChanIndexV][j] = j * anita1-&gt;TIMESTEP * 1.0E9;</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;      realEvPtr-&gt;<a class="code" href="../../d9/d4a/class_useful_anita_event.html#a14969bce1dc32ecc09f4d531c811b32b">fTimes</a>[UsefulChanIndexH][j] = j * anita1-&gt;TIMESTEP * 1.0E9;</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;      <span class="comment">// convert volts to millivolts</span></div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;      realEvPtr-&gt;<a class="code" href="../../d9/d4a/class_useful_anita_event.html#af702281d452d17cca331c620e06ad317">fVolts</a>[UsefulChanIndexH][j] =  volts_rx_rfcm_lab_h_all[IceMCAnt][j+64]*1000;</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;      realEvPtr-&gt;<a class="code" href="../../d9/d4a/class_useful_anita_event.html#af702281d452d17cca331c620e06ad317">fVolts</a>[UsefulChanIndexV][j] =  volts_rx_rfcm_lab_e_all[IceMCAnt][j+64]*1000;</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;      realEvPtr-&gt;<a class="code" href="../../d9/d4a/class_useful_anita_event.html#ad45b6e5aa9f0e9b7b1b7ab6d2ff4ef1a">fCapacitorNum</a>[UsefulChanIndexH][j] = 0;</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;      realEvPtr-&gt;<a class="code" href="../../d9/d4a/class_useful_anita_event.html#ad45b6e5aa9f0e9b7b1b7ab6d2ff4ef1a">fCapacitorNum</a>[UsefulChanIndexV][j] = 0;</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    }<span class="comment">//end int j</span></div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;      }<span class="comment">// end int iant</span></div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;      realEvPtr-&gt;<a class="code" href="../../d6/d74/class_raw_anita_event.html#afeca0dd476450527b870c012bfb4914e">eventNumber</a> = eventNumber;</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;      rawHeaderPtr-&gt;<a class="code" href="../../d0/dc4/class_raw_anita_header.html#af363eb871304cc194b1e00172a0dfe71">eventNumber</a> = eventNumber;</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;      rawHeaderPtr-&gt;<a class="code" href="../../d0/dc4/class_raw_anita_header.html#aea004b982a2265646970aca691e1d707">surfSlipFlag</a> = 0;</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;      rawHeaderPtr-&gt;<a class="code" href="../../d0/dc4/class_raw_anita_header.html#a3fdea3bec4f8682964033e048b0dddef">errorFlag</a> = 0;</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;      rawHeaderPtr-&gt;<a class="code" href="../../d0/dc4/class_raw_anita_header.html#a055774db95517a74290a7735576beeef">trigType</a> = 8; <span class="comment">// soft-trigger</span></div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;      rawHeaderPtr-&gt;<a class="code" href="../../d0/dc4/class_raw_anita_header.html#a56e3571b12bca1472a6b34f2db5e9a3b">run</a> = run_no;</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;      <span class="comment">// put the vpol only as a placeholder - these are only used in Anita-2 anyway</span></div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;      rawHeaderPtr-&gt;<a class="code" href="../../d0/dc4/class_raw_anita_header.html#a839763b5c6fd348fb0c492ee87088b68">upperL1TrigPattern</a> = l1trig[0][0];</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;      rawHeaderPtr-&gt;<a class="code" href="../../d0/dc4/class_raw_anita_header.html#af6439566d155c931907f0753968b5f09">lowerL1TrigPattern</a> = l1trig[0][1];</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;      rawHeaderPtr-&gt;<a class="code" href="../../d0/dc4/class_raw_anita_header.html#a42809439d87cd10df266839871d2437b">nadirL1TrigPattern</a> = l1trig[0][2];</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;      rawHeaderPtr-&gt;<a class="code" href="../../d0/dc4/class_raw_anita_header.html#a8a70ecfc9450638c1aa1af9dd9619b1d">upperL2TrigPattern</a> = l2trig[0][0];</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;      rawHeaderPtr-&gt;<a class="code" href="../../d0/dc4/class_raw_anita_header.html#a870409dc8330ae256725e07c16ce3d1f">lowerL2TrigPattern</a> = l2trig[0][1];</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;      rawHeaderPtr-&gt;<a class="code" href="../../d0/dc4/class_raw_anita_header.html#a683cf2a794dee50d13dc8099d1659229">nadirL2TrigPattern</a> = l2trig[0][2];</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;      <span class="keywordflow">if</span> (settings1-&gt;WHICH&lt;9){</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    rawHeaderPtr-&gt;<a class="code" href="../../d0/dc4/class_raw_anita_header.html#af2df2269147d5b08f68170d470dfb2f8">phiTrigMask</a>  = (short) anita1-&gt;phiTrigMask;</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;    rawHeaderPtr-&gt;<a class="code" href="../../d0/dc4/class_raw_anita_header.html#a7a061cc7bf8cc7dac87259586cc4e1f2">l3TrigPattern</a> = (<span class="keywordtype">short</span>) l3trig[0];</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;      }</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;      rawHeaderPtr-&gt;<a class="code" href="../../d0/dc4/class_raw_anita_header.html#ac47047421e5d427609bcc92f8f8833e2">calibStatus</a> = 31;</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;      rawHeaderPtr-&gt;<a class="code" href="../../d0/dc4/class_raw_anita_header.html#a057c7366e4ef9e485adc55860eedad2b">realTime</a> = bn1-&gt;realTime_flightdata;</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;      rawHeaderPtr-&gt;<a class="code" href="../../d0/dc4/class_raw_anita_header.html#aff1b80a19465ac1784e336e0023573f6">triggerTime</a> = bn1-&gt;realTime_flightdata;</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;      Adu5PatPtr-&gt;<a class="code" href="../../d2/dbf/class_adu5_pat.html#a3879b506194eb2cefff3fa13d6b8c766">latitude</a>= bn1-&gt;latitude;</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;      Adu5PatPtr-&gt;<a class="code" href="../../d2/dbf/class_adu5_pat.html#a881469fddb163b232c688b82924232bd">longitude</a>=bn1-&gt;longitude;</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;      Adu5PatPtr-&gt;<a class="code" href="../../d2/dbf/class_adu5_pat.html#a299db954c0d3dc3f5d38e155cf5638f3">altitude</a>=bn1-&gt;altitude;</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;      Adu5PatPtr-&gt;<a class="code" href="../../d2/dbf/class_adu5_pat.html#a4427ff546161494952d8843b98ba58c1">realTime</a>=bn1-&gt;realTime_flightdata;</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;      Adu5PatPtr-&gt;<a class="code" href="../../d2/dbf/class_adu5_pat.html#a8aca444bcebad17c7645ec7d65afb7e4">heading</a> = bn1-&gt;heading;</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;      Adu5PatPtr-&gt;<a class="code" href="../../d2/dbf/class_adu5_pat.html#af99a5597edfa5c86c4c4afd7841582b9">pitch</a> = bn1-&gt;pitch;</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;      Adu5PatPtr-&gt;roll = bn1-&gt;roll;</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;      Adu5PatPtr-&gt;run = run_no;</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;<span class="preprocessor">#ifdef ANITA3_EVENTREADER</span></div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;      <span class="keywordflow">if</span> (settings1-&gt;WHICH==9 || settings1-&gt;WHICH==10) {</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    rawHeaderPtr-&gt;setTrigPattern((<span class="keywordtype">short</span>) l3trig[0], <a class="code" href="../../d4/df7/namespace_anita_pol.html#af98f5337ced6b7416f396f5ae76a14d7ab0265e0d23894d3ebafa94a767fad35a">AnitaPol::kVertical</a>);</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;    rawHeaderPtr-&gt;setTrigPattern((<span class="keywordtype">short</span>) l3trig[1], <a class="code" href="../../d4/df7/namespace_anita_pol.html#af98f5337ced6b7416f396f5ae76a14d7ad43edda04c9c2e92af2204d77cf0278d">AnitaPol::kHorizontal</a>);</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    rawHeaderPtr-&gt;setMask( (<span class="keywordtype">short</span>) anita1-&gt;l1TrigMask,  (<span class="keywordtype">short</span>) anita1-&gt;phiTrigMask,  <a class="code" href="../../d4/df7/namespace_anita_pol.html#af98f5337ced6b7416f396f5ae76a14d7ab0265e0d23894d3ebafa94a767fad35a">AnitaPol::kVertical</a>);</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    rawHeaderPtr-&gt;setMask( (<span class="keywordtype">short</span>) anita1-&gt;l1TrigMaskH, (<span class="keywordtype">short</span>) anita1-&gt;phiTrigMaskH, <a class="code" href="../../d4/df7/namespace_anita_pol.html#af98f5337ced6b7416f396f5ae76a14d7ad43edda04c9c2e92af2204d77cf0278d">AnitaPol::kHorizontal</a>);</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;      }</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;      truthEvPtr        = <span class="keyword">new</span> <a class="code" href="../../d7/dd8/class_truth_anita_event.html">TruthAnitaEvent</a>();</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;      truthEvPtr-&gt;<a class="code" href="../../d7/dd8/class_truth_anita_event.html#a3a12546b0d51a79bfda21a5241cf6a35">eventNumber</a>      = eventNumber;</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;      truthEvPtr-&gt;<a class="code" href="../../d7/dd8/class_truth_anita_event.html#a4cb34908e504793046832d7caa2a5136">realTime</a>         = bn1-&gt;realTime_flightdata;</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;      truthEvPtr-&gt;<a class="code" href="../../d7/dd8/class_truth_anita_event.html#a54781617ba9086e115ea859a4fbd86ff">run</a>              = run_no;</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;      truthEvPtr-&gt;<a class="code" href="../../d7/dd8/class_truth_anita_event.html#ad8a6a235c9c5096e477f0ff2d808910d">nuMom</a>            = pnu;</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;      truthEvPtr-&gt;<a class="code" href="../../d7/dd8/class_truth_anita_event.html#a3998ba2289088aa557bd9c2f53b6e704">nu_pdg</a>           = pdgcode;</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;      memcpy(truthEvPtr-&gt;<a class="code" href="../../d7/dd8/class_truth_anita_event.html#a1f489ed5162c79e19f8b1ebd35fccbc0">e_component</a>, e_component, <span class="keyword">sizeof</span>(e_component));</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;      memcpy(truthEvPtr-&gt;<a class="code" href="../../d7/dd8/class_truth_anita_event.html#ad741e5ab6704918be298a67dfcca334b">h_component</a>, h_component, <span class="keyword">sizeof</span>(h_component));</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;      memcpy(truthEvPtr-&gt;<a class="code" href="../../d7/dd8/class_truth_anita_event.html#a18bf3705078fec42385ee1b991f46e3a">n_component</a>, n_component, <span class="keyword">sizeof</span>(n_component));</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;      memcpy(truthEvPtr-&gt;<a class="code" href="../../d7/dd8/class_truth_anita_event.html#ad2e5a5b9cb38835922e9d33494a12dd1">e_component_k</a> ,e_component_kvector, <span class="keyword">sizeof</span>(e_component_kvector));</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;      memcpy(truthEvPtr-&gt;<a class="code" href="../../d7/dd8/class_truth_anita_event.html#a0bf32be933c245b5caed0a6aea75aa37">h_component_k</a> ,h_component_kvector, <span class="keyword">sizeof</span>(h_component_kvector));</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;      memcpy(truthEvPtr-&gt;<a class="code" href="../../d7/dd8/class_truth_anita_event.html#a0a236c05c12a25b9b44f82e96c1e2c3c">n_component_k</a> ,n_component_kvector, <span class="keyword">sizeof</span>(n_component_kvector));</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;      truthEvPtr-&gt;<a class="code" href="../../d7/dd8/class_truth_anita_event.html#ad6650c6860ed54bdd6e793ac2f9dfaa3">sourceLon</a>        = sourceLon;</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;      truthEvPtr-&gt;<a class="code" href="../../d7/dd8/class_truth_anita_event.html#ab85dcf36877be689e719314a3b67fd40">sourceLat</a>        = sourceLat;</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;      truthEvPtr-&gt;<a class="code" href="../../d7/dd8/class_truth_anita_event.html#a973d4cb23f66fe77791e69dacbdbe20f">sourceAlt</a>        = sourceAlt;</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;      truthEvPtr-&gt;<a class="code" href="../../d7/dd8/class_truth_anita_event.html#aa54a2e1fbf8a2599e89c4214a52b90a9">weight</a>           = weight;</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;3;i++){</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;    truthEvPtr-&gt;<a class="code" href="../../d7/dd8/class_truth_anita_event.html#a4a509e49df3c70d5aeb24125f2e96481">balloonPos</a>[i]  = -999;</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    truthEvPtr-&gt;<a class="code" href="../../d7/dd8/class_truth_anita_event.html#a26f272fa6d96cf9f2bca78b9d0662b63">balloonDir</a>[i]  = -999;</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    truthEvPtr-&gt;<a class="code" href="../../d7/dd8/class_truth_anita_event.html#afe9ea8167426bdf6806a7aff3fa677b7">nuPos</a>[i]       = -999;</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    truthEvPtr-&gt;<a class="code" href="../../d7/dd8/class_truth_anita_event.html#a217f992ab0e6ad1a6e3d4fcfe750cfa5">nuDir</a>[i]       = -999;</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;      }</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;      <span class="comment">// for (int i=0;i&lt;5;i++){</span></div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;      <span class="comment">//    for (int j=0;j&lt;3;j++){</span></div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;      <span class="comment">//      truthEvPtr-&gt;rfExitNor[i][j] = ray1-&gt;n_exit2bn[i][j];</span></div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;      <span class="comment">//      truthEvPtr-&gt;rfExitPos[i][j] = ray1-&gt;rfexit[i][j];</span></div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;      <span class="comment">//    }</span></div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;      <span class="comment">// }</span></div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;48;i++){</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    truthEvPtr-&gt;<a class="code" href="../../d7/dd8/class_truth_anita_event.html#ac84b5c53e71e67af1dcd64809d929f4d">hitangle_e</a>[i]  = hitangle_e_all[i];</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    truthEvPtr-&gt;<a class="code" href="../../d7/dd8/class_truth_anita_event.html#a1dca83a359aa61b27d09ca2ae84016b6">hitangle_h</a>[i]  = hitangle_h_all[i];</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;      }</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;      <span class="keywordflow">if</span>(settings1-&gt;ROUGHNESS){</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;Anita::NFREQ;i++)</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;      truthEvPtr-&gt;<a class="code" href="../../d7/dd8/class_truth_anita_event.html#a741da86656dc04af0e574080dd1fe26b">vmmhz</a>[i]       = -999;</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;      }</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;      truthAnitaTree-&gt;Fill();</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;      <span class="keyword">delete</span> truthEvPtr;</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;      headTree-&gt;Fill();</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;      eventTree-&gt;Fill();</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;      adu5PatTree-&gt;Fill();</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;      <span class="keyword">delete</span> realEvPtr;</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;      <span class="keyword">delete</span> rawHeaderPtr;</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;      <span class="keyword">delete</span> Adu5PatPtr;</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;      sum_weights+=weight;</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;      neutrinos_passing_all_cuts++;</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;    } <span class="comment">// end if passing global trigger conditions</span></div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;      passes_thisevent=0; <span class="comment">// flag this event as not passing</span></div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    }<span class="comment">// end else event does not pass trigger</span></div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    <span class="comment">// delete globaltrig1;</span></div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;    <span class="keywordflow">if</span> (ABORT_EARLY){</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot;\n***********************************************************&quot;</span>;</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot;\n* SIGINT received,  aborting loop over events early.&quot;</span>;</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot;\n* Stopped after event &quot;</span> &lt;&lt; inu &lt;&lt; <span class="stringliteral">&quot; instead of &quot;</span> &lt;&lt; NNU;</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot;\n* Any output which relied on NNU should be corrected for.&quot;</span>;</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot;\n***********************************************************\n&quot;</span>;</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;      foutput &lt;&lt; <span class="stringliteral">&quot;\n***********************************************************&quot;</span>;</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;      foutput &lt;&lt; <span class="stringliteral">&quot;\n* SIGINT received,  aborting loop over events early.&quot;</span>;</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;      foutput &lt;&lt; <span class="stringliteral">&quot;\n* Stopped after event &quot;</span> &lt;&lt; inu &lt;&lt; <span class="stringliteral">&quot; instead of &quot;</span> &lt;&lt; NNU;</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;      foutput &lt;&lt; <span class="stringliteral">&quot;\n* Any output which relied on NNU should be corrected for.&quot;</span>;</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;      foutput &lt;&lt; <span class="stringliteral">&quot;\n***********************************************************\n&quot;</span>;</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;    }</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;  }<span class="comment">//end NNU neutrino loop</span></div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;<span class="preprocessor">#ifdef ANITA_UTIL_EXISTS</span></div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;  anitafileEvent-&gt;cd();</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;  eventTree-&gt;Write(<span class="stringliteral">&quot;eventTree&quot;</span>);</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;  anitafileEvent-&gt;Close();</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;  <span class="keyword">delete</span> anitafileEvent;</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;  anitafileHead-&gt;cd();</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;  headTree-&gt;Write(<span class="stringliteral">&quot;headTree&quot;</span>);</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;  anitafileHead-&gt;Close();</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;  <span class="keyword">delete</span> anitafileHead;</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;  anitafileGps-&gt;cd();</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;  adu5PatTree-&gt;Write(<span class="stringliteral">&quot;adu5PatTree&quot;</span>);</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;  anitafileGps-&gt;Close();</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;  <span class="keyword">delete</span> anitafileGps;</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;<span class="preprocessor">#ifdef ANITA3_EVENTREADER</span></div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;  anitafileTruth-&gt;cd();</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;  truthAnitaTree-&gt;Write(<span class="stringliteral">&quot;truthAnitaTree&quot;</span>);</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;  anitafileTruth-&gt;Close();</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;  <span class="keyword">delete</span> anitafileTruth;</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;  time_t raw_end_time = time(NULL);</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;  <span class="keyword">struct </span>tm * end_time = localtime(&amp;raw_end_time);</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;  cout &lt;&lt; <span class="stringliteral">&quot;Date and time at end of run are: &quot;</span> &lt;&lt; asctime (end_time) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;  cout&lt;&lt;<span class="stringliteral">&quot;Total time elapsed is &quot;</span>&lt;&lt;(int)((raw_end_time - raw_start_time)/60)&lt;&lt;<span class="stringliteral">&quot;:&quot;</span>&lt;&lt; ((raw_end_time - raw_start_time)%60)&lt;&lt;endl;</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;  foutput &lt;&lt; <span class="stringliteral">&quot;\nTotal time elapsed in run is &quot;</span> &lt;&lt;(int)((raw_end_time - raw_start_time)/60)&lt;&lt;<span class="stringliteral">&quot;:&quot;</span>&lt;&lt; ((raw_end_time - raw_start_time)%60)&lt;&lt;endl;</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;  <span class="comment">//  delete anita1;</span></div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;} <span class="comment">//END MAIN PROGRAM</span></div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;<span class="comment">// ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span></div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;<span class="comment">// ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span></div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;<span class="comment">//  Auxiliary functions</span></div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;<span class="keywordtype">void</span> interrupt_signal_handler(<span class="keywordtype">int</span> sig){</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;  signal(sig,  SIG_IGN);</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;  ABORT_EARLY = <span class="keyword">true</span>;</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;  <span class="keywordflow">return</span>;</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;}</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;<span class="comment">//end interrupt_signal_handler()</span></div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;<span class="preprocessor">#ifdef ANITA_UTIL_EXISTS</span></div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;<span class="comment">//int GetIceMCAntfromUsefulEventAnt(Anita *anita1,  AnitaGeomTool *AnitaGeom1,  int UsefulEventAnt){</span></div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;<span class="keywordtype">int</span> GetIceMCAntfromUsefulEventAnt(<a class="code" href="../../db/d2b/class_settings.html">Settings</a> *settings1,  <span class="keywordtype">int</span> UsefulEventAnt){</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;  <span class="comment">//int layer_temp = IceMCLayerPosition[UsefulEventIndex][0];</span></div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;  <span class="comment">//int position_temp = IceMCLayerPosition[UsefulEventIndex][1];</span></div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;  <span class="comment">//int IceMCIndex = anita1-&gt;GetRx(layer_temp,  position_temp);</span></div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;  <span class="keywordtype">int</span> IceMCAnt = UsefulEventAnt;</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;  <span class="keywordflow">if</span> ((settings1-&gt;WHICH==9 || settings1-&gt;WHICH==10) &amp;&amp; UsefulEventAnt&lt;16) {</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;    IceMCAnt = (UsefulEventAnt%2==0)*UsefulEventAnt/2 + (UsefulEventAnt%2==1)*(UsefulEventAnt/2+8);</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;  }</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;  <span class="keywordflow">return</span> IceMCAnt;</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;}</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;<span class="comment">//end GetIceMCAntfromUsefulEventAnt()</span></div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;<span class="preprocessor">#endif</span></div><div class="ttc" id="class_raw_anita_event_html_afeca0dd476450527b870c012bfb4914e"><div class="ttname"><a href="../../d6/d74/class_raw_anita_event.html#afeca0dd476450527b870c012bfb4914e">RawAnitaEvent::eventNumber</a></div><div class="ttdeci">UInt_t eventNumber</div><div class="ttdoc">Event number from software. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d66/_raw_anita_event_8h_source.html#l00033">RawAnitaEvent.h:33</a></div></div>
<div class="ttc" id="class_raw_anita_header_html_a870409dc8330ae256725e07c16ce3d1f"><div class="ttname"><a href="../../d0/dc4/class_raw_anita_header.html#a870409dc8330ae256725e07c16ce3d1f">RawAnitaHeader::lowerL2TrigPattern</a></div><div class="ttdeci">UShort_t lowerL2TrigPattern</div><div class="ttdoc">Bit mask for lower ring l2 cluster triggers. eg. if the bit 1 (the lowest bit) is active it means the...</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d0f/_raw_anita_header_8h_source.html#l00170">RawAnitaHeader.h:170</a></div></div>
<div class="ttc" id="class_raw_anita_header_html_aea004b982a2265646970aca691e1d707"><div class="ttname"><a href="../../d0/dc4/class_raw_anita_header.html#aea004b982a2265646970aca691e1d707">RawAnitaHeader::surfSlipFlag</a></div><div class="ttdeci">UChar_t surfSlipFlag</div><div class="ttdoc">Sync Slip between SURF 2-9 and SURF 1. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d0f/_raw_anita_header_8h_source.html#l00095">RawAnitaHeader.h:95</a></div></div>
<div class="ttc" id="class_truth_anita_event_html_a0bf32be933c245b5caed0a6aea75aa37"><div class="ttname"><a href="../../d7/dd8/class_truth_anita_event.html#a0bf32be933c245b5caed0a6aea75aa37">TruthAnitaEvent::h_component_k</a></div><div class="ttdeci">Double_t h_component_k[48]</div><div class="ttdoc">Component of the e-field along the rx h-plane. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc7/_truth_anita_event_8h_source.html#l00050">TruthAnitaEvent.h:50</a></div></div>
<div class="ttc" id="class_raw_anita_header_html_a3fdea3bec4f8682964033e048b0dddef"><div class="ttname"><a href="../../d0/dc4/class_raw_anita_header.html#a3fdea3bec4f8682964033e048b0dddef">RawAnitaHeader::errorFlag</a></div><div class="ttdeci">UChar_t errorFlag</div><div class="ttdoc">Error Flag. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d0f/_raw_anita_header_8h_source.html#l00094">RawAnitaHeader.h:94</a></div></div>
<div class="ttc" id="class_truth_anita_event_html_aa54a2e1fbf8a2599e89c4214a52b90a9"><div class="ttname"><a href="../../d7/dd8/class_truth_anita_event.html#aa54a2e1fbf8a2599e89c4214a52b90a9">TruthAnitaEvent::weight</a></div><div class="ttdeci">Double_t weight</div><div class="ttdoc">Weight assigned by icemc. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc7/_truth_anita_event_8h_source.html#l00062">TruthAnitaEvent.h:62</a></div></div>
<div class="ttc" id="class_truth_anita_event_html_a3998ba2289088aa557bd9c2f53b6e704"><div class="ttname"><a href="../../d7/dd8/class_truth_anita_event.html#a3998ba2289088aa557bd9c2f53b6e704">TruthAnitaEvent::nu_pdg</a></div><div class="ttdeci">Int_t nu_pdg</div><div class="ttdoc">Neutrino PDG code. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc7/_truth_anita_event_8h_source.html#l00044">TruthAnitaEvent.h:44</a></div></div>
<div class="ttc" id="class_truth_anita_event_html_ab85dcf36877be689e719314a3b67fd40"><div class="ttname"><a href="../../d7/dd8/class_truth_anita_event.html#ab85dcf36877be689e719314a3b67fd40">TruthAnitaEvent::sourceLat</a></div><div class="ttdeci">Double_t sourceLat</div><div class="ttdoc">RF position when leaving the ice: Latitude (using icemc model) </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc7/_truth_anita_event_8h_source.html#l00060">TruthAnitaEvent.h:60</a></div></div>
<div class="ttc" id="class_useful_anita_event_html_af702281d452d17cca331c620e06ad317"><div class="ttname"><a href="../../d9/d4a/class_useful_anita_event.html#af702281d452d17cca331c620e06ad317">UsefulAnitaEvent::fVolts</a></div><div class="ttdeci">double fVolts[12 *9][260]</div><div class="ttdoc">Array of unwrapped (unless kNoCalib) voltages for each channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dca/_useful_anita_event_8h_source.html#l00079">UsefulAnitaEvent.h:79</a></div></div>
<div class="ttc" id="class_adu5_pat_html_af99a5597edfa5c86c4c4afd7841582b9"><div class="ttname"><a href="../../d2/dbf/class_adu5_pat.html#af99a5597edfa5c86c4c4afd7841582b9">Adu5Pat::pitch</a></div><div class="ttdeci">Float_t pitch</div><div class="ttdoc">in degrees </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d8e/_adu5_pat_8h_source.html#l00046">Adu5Pat.h:46</a></div></div>
<div class="ttc" id="class_chan_trigger_html_a4fcd80f9a174f236b60a6606ac0599b2"><div class="ttname"><a href="../../dd/d24/class_chan_trigger.html#a4fcd80f9a174f236b60a6606ac0599b2">ChanTrigger::InitializeEachBand</a></div><div class="ttdeci">void InitializeEachBand(Anita *anita1)</div><div class="ttdoc">Initialize trigger bands. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d47/_chan_trigger_8cc_source.html#l00711">ChanTrigger.cc:711</a></div></div>
<div class="ttc" id="class_raw_anita_header_html_a839763b5c6fd348fb0c492ee87088b68"><div class="ttname"><a href="../../d0/dc4/class_raw_anita_header.html#a839763b5c6fd348fb0c492ee87088b68">RawAnitaHeader::upperL1TrigPattern</a></div><div class="ttdeci">UShort_t upperL1TrigPattern</div><div class="ttdoc">Bit mask for upper ring l1 antenna triggers. eg. if the bit 1 (the lowest bit) is active it means the...</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d0f/_raw_anita_header_8h_source.html#l00167">RawAnitaHeader.h:167</a></div></div>
<div class="ttc" id="class_raw_anita_header_html_a7a061cc7bf8cc7dac87259586cc4e1f2"><div class="ttname"><a href="../../d0/dc4/class_raw_anita_header.html#a7a061cc7bf8cc7dac87259586cc4e1f2">RawAnitaHeader::l3TrigPattern</a></div><div class="ttdeci">UShort_t l3TrigPattern</div><div class="ttdoc">Bit mask for l3 global triggers. eg. if the bit 1 (the lowest bit) is active it means that phi sector...</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d0f/_raw_anita_header_8h_source.html#l00171">RawAnitaHeader.h:171</a></div></div>
<div class="ttc" id="class_adu5_pat_html"><div class="ttname"><a href="../../d2/dbf/class_adu5_pat.html">Adu5Pat</a></div><div class="ttdoc">Adu5Pat  The ADU5 Position and Attitude Data. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d8e/_adu5_pat_8h_source.html#l00026">Adu5Pat.h:26</a></div></div>
<div class="ttc" id="class_chan_trigger_html_a3bbedfa72e4d8b4001fcef036a6ed286"><div class="ttname"><a href="../../dd/d24/class_chan_trigger.html#a3bbedfa72e4d8b4001fcef036a6ed286">ChanTrigger::TriggerPath</a></div><div class="ttdeci">void TriggerPath(Settings *settings1, Anita *anita1, int ant, Balloon *bn1)</div><div class="ttdoc">Apply trigger path. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d47/_chan_trigger_8cc_source.html#l00871">ChanTrigger.cc:871</a></div></div>
<div class="ttc" id="class_anita_html_a1c7ef28c5f83fa1e858a7d7bb64d666a"><div class="ttname"><a href="../../df/da2/class_anita.html#a1c7ef28c5f83fa1e858a7d7bb64d666a">Anita::NPOL</a></div><div class="ttdeci">static const int NPOL</div><div class="ttdoc">number of polarizations </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d52/anita_8hh_source.html#l00051">anita.hh:51</a></div></div>
<div class="ttc" id="class_truth_anita_event_html_a0a236c05c12a25b9b44f82e96c1e2c3c"><div class="ttname"><a href="../../d7/dd8/class_truth_anita_event.html#a0a236c05c12a25b9b44f82e96c1e2c3c">TruthAnitaEvent::n_component_k</a></div><div class="ttdeci">Double_t n_component_k[48]</div><div class="ttdoc">Component of the e-field along the normal. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc7/_truth_anita_event_8h_source.html#l00051">TruthAnitaEvent.h:51</a></div></div>
<div class="ttc" id="class_raw_anita_header_html_ac47047421e5d427609bcc92f8f8833e2"><div class="ttname"><a href="../../d0/dc4/class_raw_anita_header.html#ac47047421e5d427609bcc92f8f8833e2">RawAnitaHeader::calibStatus</a></div><div class="ttdeci">UShort_t calibStatus</div><div class="ttdoc">Calib/Relay Status. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d0f/_raw_anita_header_8h_source.html#l00081">RawAnitaHeader.h:81</a></div></div>
<div class="ttc" id="class_adu5_pat_html_a3879b506194eb2cefff3fa13d6b8c766"><div class="ttname"><a href="../../d2/dbf/class_adu5_pat.html#a3879b506194eb2cefff3fa13d6b8c766">Adu5Pat::latitude</a></div><div class="ttdeci">Float_t latitude</div><div class="ttdoc">In degrees. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d8e/_adu5_pat_8h_source.html#l00042">Adu5Pat.h:42</a></div></div>
<div class="ttc" id="namespacestd_html"><div class="ttname"><a href="../../d8/dcc/namespacestd.html">std</a></div><div class="ttdoc">STL namespace. </div></div>
<div class="ttc" id="class_anita_geom_tool_html_af1a3c9c9884f3cb09f520ad2dad96ea3"><div class="ttname"><a href="../../d8/db1/class_anita_geom_tool.html#af1a3c9c9884f3cb09f520ad2dad96ea3">AnitaGeomTool::getChanIndexFromAntPol</a></div><div class="ttdeci">static Int_t getChanIndexFromAntPol(Int_t ant, AnitaPol::AnitaPol_t pol)</div><div class="ttdoc">Convert ant-pol to logical index. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d67/_anita_geom_tool_8cxx_source.html#l00623">AnitaGeomTool.cxx:623</a></div></div>
<div class="ttc" id="class_signal_html"><div class="ttname"><a href="../../dc/d20/class_signal.html">Signal</a></div><div class="ttdoc">Radiation from interaction. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/da9/signal_8hh_source.html#l00013">signal.hh:13</a></div></div>
<div class="ttc" id="class_useful_anita_event_html_a14969bce1dc32ecc09f4d531c811b32b"><div class="ttname"><a href="../../d9/d4a/class_useful_anita_event.html#a14969bce1dc32ecc09f4d531c811b32b">UsefulAnitaEvent::fTimes</a></div><div class="ttdeci">double fTimes[12 *9][260]</div><div class="ttdoc">Array of unwrapped (unless kNoCalib) times for each channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dca/_useful_anita_event_8h_source.html#l00080">UsefulAnitaEvent.h:80</a></div></div>
<div class="ttc" id="class_truth_anita_event_html_ad6650c6860ed54bdd6e793ac2f9dfaa3"><div class="ttname"><a href="../../d7/dd8/class_truth_anita_event.html#ad6650c6860ed54bdd6e793ac2f9dfaa3">TruthAnitaEvent::sourceLon</a></div><div class="ttdeci">Double_t sourceLon</div><div class="ttdoc">RF position when leaving the ice: Longitude (using icemc model) </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc7/_truth_anita_event_8h_source.html#l00059">TruthAnitaEvent.h:59</a></div></div>
<div class="ttc" id="class_truth_anita_event_html_a973d4cb23f66fe77791e69dacbdbe20f"><div class="ttname"><a href="../../d7/dd8/class_truth_anita_event.html#a973d4cb23f66fe77791e69dacbdbe20f">TruthAnitaEvent::sourceAlt</a></div><div class="ttdeci">Double_t sourceAlt</div><div class="ttdoc">RF position when leaving the ice: Altitude (using icemc model) </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc7/_truth_anita_event_8h_source.html#l00061">TruthAnitaEvent.h:61</a></div></div>
<div class="ttc" id="class_chan_trigger_html_a0e009613e4c8712b28075a00427b5fc6"><div class="ttname"><a href="../../dd/d24/class_chan_trigger.html#a0e009613e4c8712b28075a00427b5fc6">ChanTrigger::TimeShiftAndSignalFluct</a></div><div class="ttdeci">void TimeShiftAndSignalFluct(Settings *settings1, Anita *anita1, int ilayer, int ifold, double volts_rx_rfcm_lab_e_all[48][512], double volts_rx_rfcm_lab_h_all[48][512])</div><div class="ttdoc">Time shift and fluctuate signal. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d47/_chan_trigger_8cc_source.html#l01146">ChanTrigger.cc:1146</a></div></div>
<div class="ttc" id="class_adu5_pat_html_a881469fddb163b232c688b82924232bd"><div class="ttname"><a href="../../d2/dbf/class_adu5_pat.html#a881469fddb163b232c688b82924232bd">Adu5Pat::longitude</a></div><div class="ttdeci">Float_t longitude</div><div class="ttdoc">In degrees. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d8e/_adu5_pat_8h_source.html#l00043">Adu5Pat.h:43</a></div></div>
<div class="ttc" id="class_chan_trigger_html_a25f076258aebe64f91b42e0769c4f81e"><div class="ttname"><a href="../../dd/d24/class_chan_trigger.html#a25f076258aebe64f91b42e0769c4f81e">ChanTrigger::volts_rx_forfft</a></div><div class="ttdeci">double volts_rx_forfft[2][5][Anita::HALFNFOUR]</div><div class="ttdoc">Array of time domain after the antenna gain. Indeces stand for [ipol][iband][itime]. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dee/_chan_trigger_8h_source.html#l00415">ChanTrigger.h:415</a></div></div>
<div class="ttc" id="class_adu5_pat_html_a4427ff546161494952d8843b98ba58c1"><div class="ttname"><a href="../../d2/dbf/class_adu5_pat.html#a4427ff546161494952d8843b98ba58c1">Adu5Pat::realTime</a></div><div class="ttdeci">UInt_t realTime</div><div class="ttdoc">Time from the GPS unit. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d8e/_adu5_pat_8h_source.html#l00037">Adu5Pat.h:37</a></div></div>
<div class="ttc" id="namespace_environment_variable_html_a064f876067320b15e34beb8c29c8ffdc"><div class="ttname"><a href="../../d4/d7f/namespace_environment_variable.html#a064f876067320b15e34beb8c29c8ffdc">EnvironmentVariable::ICEMC_SRC_DIR</a></div><div class="ttdeci">const char * ICEMC_SRC_DIR()</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd9/_environment_variable_8cc_source.html#l00056">EnvironmentVariable.cc:56</a></div></div>
<div class="ttc" id="class_truth_anita_event_html_a18bf3705078fec42385ee1b991f46e3a"><div class="ttname"><a href="../../d7/dd8/class_truth_anita_event.html#a18bf3705078fec42385ee1b991f46e3a">TruthAnitaEvent::n_component</a></div><div class="ttdeci">Double_t n_component[48]</div><div class="ttdoc">Normal comp along polarization. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc7/_truth_anita_event_8h_source.html#l00048">TruthAnitaEvent.h:48</a></div></div>
<div class="ttc" id="class_truth_anita_event_html_a4a509e49df3c70d5aeb24125f2e96481"><div class="ttname"><a href="../../d7/dd8/class_truth_anita_event.html#a4a509e49df3c70d5aeb24125f2e96481">TruthAnitaEvent::balloonPos</a></div><div class="ttdeci">Double_t balloonPos[3]</div><div class="ttdoc">Balloon position. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc7/_truth_anita_event_8h_source.html#l00036">TruthAnitaEvent.h:36</a></div></div>
<div class="ttc" id="class_raw_anita_header_html_a683cf2a794dee50d13dc8099d1659229"><div class="ttname"><a href="../../d0/dc4/class_raw_anita_header.html#a683cf2a794dee50d13dc8099d1659229">RawAnitaHeader::nadirL2TrigPattern</a></div><div class="ttdeci">UChar_t nadirL2TrigPattern</div><div class="ttdoc">8-bit trigger mask for L2 nadir triggers. Nadir L2 triggers are for the even phi sectors and are just...</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d0f/_raw_anita_header_8h_source.html#l00175">RawAnitaHeader.h:175</a></div></div>
<div class="ttc" id="class_chan_trigger_html_af874b19d040e267a525bc2777f57173b"><div class="ttname"><a href="../../dd/d24/class_chan_trigger.html#af874b19d040e267a525bc2777f57173b">ChanTrigger::saveTriggerWaveforms</a></div><div class="ttdeci">void saveTriggerWaveforms(Anita *anita1, double sig0[48], double sig1[48], double noise0[48], double noise1[48])</div><div class="ttdoc">Save signal and noise waveforms at trigger. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d47/_chan_trigger_8cc_source.html#l01943">ChanTrigger.cc:1943</a></div></div>
<div class="ttc" id="class_truth_anita_event_html_a741da86656dc04af0e574080dd1fe26b"><div class="ttname"><a href="../../d7/dd8/class_truth_anita_event.html#a741da86656dc04af0e574080dd1fe26b">TruthAnitaEvent::vmmhz</a></div><div class="ttdeci">Double_t vmmhz[128]</div><div class="ttdoc">V/m/MHz at balloon (128 frequency bins) </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc7/_truth_anita_event_8h_source.html#l00055">TruthAnitaEvent.h:55</a></div></div>
<div class="ttc" id="class_raw_anita_header_html"><div class="ttname"><a href="../../d0/dc4/class_raw_anita_header.html">RawAnitaHeader</a></div><div class="ttdoc">RawAnitaHeader  The Raw ANITA Event Header. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d0f/_raw_anita_header_8h_source.html#l00022">RawAnitaHeader.h:22</a></div></div>
<div class="ttc" id="class_chan_trigger_html"><div class="ttname"><a href="../../dd/d24/class_chan_trigger.html">ChanTrigger</a></div><div class="ttdoc">Class that handles the channel trigger. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dee/_chan_trigger_8h_source.html#l00018">ChanTrigger.h:18</a></div></div>
<div class="ttc" id="class_settings_html"><div class="ttname"><a href="../../db/d2b/class_settings.html">Settings</a></div><div class="ttdoc">Reads in and stores input settings for the run. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d4a/_settings_8h_source.html#l00037">Settings.h:37</a></div></div>
<div class="ttc" id="class_raw_anita_header_html_a56e3571b12bca1472a6b34f2db5e9a3b"><div class="ttname"><a href="../../d0/dc4/class_raw_anita_header.html#a56e3571b12bca1472a6b34f2db5e9a3b">RawAnitaHeader::run</a></div><div class="ttdeci">Int_t run</div><div class="ttdoc">Run number, assigned on ground. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d0f/_raw_anita_header_8h_source.html#l00045">RawAnitaHeader.h:45</a></div></div>
<div class="ttc" id="class_position_html"><div class="ttname"><a href="../../d7/d3b/class_position.html">Position</a></div><div class="ttdoc">This class is a 3-vector that represents a position on the Earth&amp;#39;s surface. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d18/position_8hh_source.html#l00026">position.hh:26</a></div></div>
<div class="ttc" id="class_secondaries_html"><div class="ttname"><a href="../../d6/d1a/class_secondaries.html">Secondaries</a></div><div class="ttdoc">Secondary interactions. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d99/secondaries_8hh_source.html#l00028">secondaries.hh:28</a></div></div>
<div class="ttc" id="class_chan_trigger_html_aa893bb77e40efd72317a10e4ed2a3880"><div class="ttname"><a href="../../dd/d24/class_chan_trigger.html#aa893bb77e40efd72317a10e4ed2a3880">ChanTrigger::saveDigitizerWaveforms</a></div><div class="ttdeci">void saveDigitizerWaveforms(Anita *anita1, double sig0[48], double sig1[48], double noise0[48], double noise1[48])</div><div class="ttdoc">Save signal and noise waveforms at digitizer. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d47/_chan_trigger_8cc_source.html#l01953">ChanTrigger.cc:1953</a></div></div>
<div class="ttc" id="class_chan_trigger_html_a321c3efd1737beef5af3d3bc31b26351"><div class="ttname"><a href="../../dd/d24/class_chan_trigger.html#a321c3efd1737beef5af3d3bc31b26351">ChanTrigger::getNoiseFromFlight</a></div><div class="ttdeci">void getNoiseFromFlight(Settings *settings1, Anita *anita1, int ant, bool also_digi=true)</div><div class="ttdoc">Add noise from ANITA-3 flight to the time domain waveforms. </div></div>
<div class="ttc" id="class_truth_anita_event_html_ad741e5ab6704918be298a67dfcca334b"><div class="ttname"><a href="../../d7/dd8/class_truth_anita_event.html#ad741e5ab6704918be298a67dfcca334b">TruthAnitaEvent::h_component</a></div><div class="ttdeci">Double_t h_component[48]</div><div class="ttdoc">H comp along polarization. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc7/_truth_anita_event_8h_source.html#l00047">TruthAnitaEvent.h:47</a></div></div>
<div class="ttc" id="class_truth_anita_event_html_a4cb34908e504793046832d7caa2a5136"><div class="ttname"><a href="../../d7/dd8/class_truth_anita_event.html#a4cb34908e504793046832d7caa2a5136">TruthAnitaEvent::realTime</a></div><div class="ttdeci">UInt_t realTime</div><div class="ttdoc">unixTime of readout </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc7/_truth_anita_event_8h_source.html#l00033">TruthAnitaEvent.h:33</a></div></div>
<div class="ttc" id="class_useful_anita_event_html"><div class="ttname"><a href="../../d9/d4a/class_useful_anita_event.html">UsefulAnitaEvent</a></div><div class="ttdoc">UsefulAnitaEvent  The Calibrated Useful Anita Event object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dca/_useful_anita_event_8h_source.html#l00031">UsefulAnitaEvent.h:31</a></div></div>
<div class="ttc" id="class_adu5_pat_html_a299db954c0d3dc3f5d38e155cf5638f3"><div class="ttname"><a href="../../d2/dbf/class_adu5_pat.html#a299db954c0d3dc3f5d38e155cf5638f3">Adu5Pat::altitude</a></div><div class="ttdeci">Float_t altitude</div><div class="ttdoc">In metres. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d8e/_adu5_pat_8h_source.html#l00044">Adu5Pat.h:44</a></div></div>
<div class="ttc" id="class_raw_anita_header_html_af2df2269147d5b08f68170d470dfb2f8"><div class="ttname"><a href="../../d0/dc4/class_raw_anita_header.html#af2df2269147d5b08f68170d470dfb2f8">RawAnitaHeader::phiTrigMask</a></div><div class="ttdeci">UShort_t phiTrigMask</div><div class="ttdoc">16-bit phi mask (from TURF) </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d0f/_raw_anita_header_8h_source.html#l00108">RawAnitaHeader.h:108</a></div></div>
<div class="ttc" id="class_truth_anita_event_html_a1dca83a359aa61b27d09ca2ae84016b6"><div class="ttname"><a href="../../d7/dd8/class_truth_anita_event.html#a1dca83a359aa61b27d09ca2ae84016b6">TruthAnitaEvent::hitangle_h</a></div><div class="ttdeci">Double_t hitangle_h[48]</div><div class="ttdoc">Hit angles rel. to h plane stored for each antenna. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc7/_truth_anita_event_8h_source.html#l00054">TruthAnitaEvent.h:54</a></div></div>
<div class="ttc" id="class_chan_trigger_html_a261ab5103931c402e8855a6f33922eb2"><div class="ttname"><a href="../../dd/d24/class_chan_trigger.html#a261ab5103931c402e8855a6f33922eb2">ChanTrigger::DigitizerPath</a></div><div class="ttdeci">void DigitizerPath(Settings *settings1, Anita *anita1, int ant, Balloon *bn1)</div><div class="ttdoc">Apply digitizer path. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d47/_chan_trigger_8cc_source.html#l01005">ChanTrigger.cc:1005</a></div></div>
<div class="ttc" id="class_raw_anita_event_html_a82b9c921a5b03e60eaf80fab14b9adf0"><div class="ttname"><a href="../../d6/d74/class_raw_anita_event.html#a82b9c921a5b03e60eaf80fab14b9adf0">RawAnitaEvent::chanId</a></div><div class="ttdeci">UChar_t chanId[12 *9]</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d66/_raw_anita_event_8h_source.html#l00039">RawAnitaEvent.h:39</a></div></div>
<div class="ttc" id="class_truth_anita_event_html"><div class="ttname"><a href="../../d7/dd8/class_truth_anita_event.html">TruthAnitaEvent</a></div><div class="ttdoc">TruthAnitaEvent  The Truth ANITA Event. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc7/_truth_anita_event_8h_source.html#l00026">TruthAnitaEvent.h:26</a></div></div>
<div class="ttc" id="class_truth_anita_event_html_a1f489ed5162c79e19f8b1ebd35fccbc0"><div class="ttname"><a href="../../d7/dd8/class_truth_anita_event.html#a1f489ed5162c79e19f8b1ebd35fccbc0">TruthAnitaEvent::e_component</a></div><div class="ttdeci">Double_t e_component[48]</div><div class="ttdoc">E comp along polarization. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc7/_truth_anita_event_8h_source.html#l00046">TruthAnitaEvent.h:46</a></div></div>
<div class="ttc" id="class_earth_model_html"><div class="ttname"><a href="../../d1/d3b/class_earth_model.html">EarthModel</a></div><div class="ttdoc">Shape of the earth, ice thicknesses, profiles of earth layers, densities, neutrino absorption...</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d26/earthmodel_8hh_source.html#l00040">earthmodel.hh:40</a></div></div>
<div class="ttc" id="class_anita_html_a6bc753f453f91e30ed38f3cc4c30fbc3"><div class="ttname"><a href="../../df/da2/class_anita.html#a6bc753f453f91e30ed38f3cc4c30fbc3">Anita::NLAYERS_MAX</a></div><div class="ttdeci">static const int NLAYERS_MAX</div><div class="ttdoc">max number of layers (in smex design, it&amp;#39;s 4) </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d52/anita_8hh_source.html#l00059">anita.hh:59</a></div></div>
<div class="ttc" id="class_raw_anita_header_html_af6439566d155c931907f0753968b5f09"><div class="ttname"><a href="../../d0/dc4/class_raw_anita_header.html#af6439566d155c931907f0753968b5f09">RawAnitaHeader::lowerL1TrigPattern</a></div><div class="ttdeci">UShort_t lowerL1TrigPattern</div><div class="ttdoc">Bit mask for lower ring l1 antenna triggers. eg. if the bit 1 (the lowest bit) is active it means the...</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d0f/_raw_anita_header_8h_source.html#l00168">RawAnitaHeader.h:168</a></div></div>
<div class="ttc" id="class_useful_anita_event_html_ad45b6e5aa9f0e9b7b1b7ab6d2ff4ef1a"><div class="ttname"><a href="../../d9/d4a/class_useful_anita_event.html#ad45b6e5aa9f0e9b7b1b7ab6d2ff4ef1a">UsefulAnitaEvent::fCapacitorNum</a></div><div class="ttdeci">int fCapacitorNum[12 *9][260]</div><div class="ttdoc">Array of capacitor numbers. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dca/_useful_anita_event_8h_source.html#l00081">UsefulAnitaEvent.h:81</a></div></div>
<div class="ttc" id="class_raw_anita_header_html_af363eb871304cc194b1e00172a0dfe71"><div class="ttname"><a href="../../d0/dc4/class_raw_anita_header.html#af363eb871304cc194b1e00172a0dfe71">RawAnitaHeader::eventNumber</a></div><div class="ttdeci">UInt_t eventNumber</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d0f/_raw_anita_header_8h_source.html#l00051">RawAnitaHeader.h:51</a></div></div>
<div class="ttc" id="class_truth_anita_event_html_a217f992ab0e6ad1a6e3d4fcfe750cfa5"><div class="ttname"><a href="../../d7/dd8/class_truth_anita_event.html#a217f992ab0e6ad1a6e3d4fcfe750cfa5">TruthAnitaEvent::nuDir</a></div><div class="ttdeci">Double_t nuDir[3]</div><div class="ttdoc">Neutrino direction. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc7/_truth_anita_event_8h_source.html#l00039">TruthAnitaEvent.h:39</a></div></div>
<div class="ttc" id="class_taumodel_html"><div class="ttname"><a href="../../d6/dc1/class_taumodel.html">Taumodel</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/dd9/_taumodel_8hh_source.html#l00029">Taumodel.hh:29</a></div></div>
<div class="ttc" id="namespace_anita_pol_html_af98f5337ced6b7416f396f5ae76a14d7ab0265e0d23894d3ebafa94a767fad35a"><div class="ttname"><a href="../../d4/df7/namespace_anita_pol.html#af98f5337ced6b7416f396f5ae76a14d7ab0265e0d23894d3ebafa94a767fad35a">AnitaPol::kVertical</a></div><div class="ttdoc">Vertical Polarisation. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df8/_anita_conventions_8h_source.html#l00198">AnitaConventions.h:198</a></div></div>
<div class="ttc" id="class_truth_anita_event_html_ad2e5a5b9cb38835922e9d33494a12dd1"><div class="ttname"><a href="../../d7/dd8/class_truth_anita_event.html#ad2e5a5b9cb38835922e9d33494a12dd1">TruthAnitaEvent::e_component_k</a></div><div class="ttdeci">Double_t e_component_k[48]</div><div class="ttdoc">Component of e-field along the rx e-plane. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc7/_truth_anita_event_8h_source.html#l00049">TruthAnitaEvent.h:49</a></div></div>
<div class="ttc" id="class_truth_anita_event_html_ad8a6a235c9c5096e477f0ff2d808910d"><div class="ttname"><a href="../../d7/dd8/class_truth_anita_event.html#ad8a6a235c9c5096e477f0ff2d808910d">TruthAnitaEvent::nuMom</a></div><div class="ttdeci">Double_t nuMom</div><div class="ttdoc">Neutrino momentum. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc7/_truth_anita_event_8h_source.html#l00040">TruthAnitaEvent.h:40</a></div></div>
<div class="ttc" id="class_useful_anita_event_html_ae86589d99938983649c75844d9853de8"><div class="ttname"><a href="../../d9/d4a/class_useful_anita_event.html#ae86589d99938983649c75844d9853de8">UsefulAnitaEvent::fNumPoints</a></div><div class="ttdeci">int fNumPoints[12 *9]</div><div class="ttdoc">Number of poins per channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dca/_useful_anita_event_8h_source.html#l00078">UsefulAnitaEvent.h:78</a></div></div>
<div class="ttc" id="class_balloon_html"><div class="ttname"><a href="../../d2/d24/class_balloon.html">Balloon</a></div><div class="ttdoc">Handles everything related to balloon positions, payload orientation over the course of a flight...</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/balloon_8hh_source.html#l00030">balloon.hh:30</a></div></div>
<div class="ttc" id="class_vector_html"><div class="ttname"><a href="../../d5/db2/class_vector.html">Vector</a></div><div class="ttdoc">This class represents a three-vector. Operators are overloaded to provide for the familiar operations...</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d61/vector_8hh_source.html#l00027">vector.hh:27</a></div></div>
<div class="ttc" id="class_raw_anita_header_html_a8a70ecfc9450638c1aa1af9dd9619b1d"><div class="ttname"><a href="../../d0/dc4/class_raw_anita_header.html#a8a70ecfc9450638c1aa1af9dd9619b1d">RawAnitaHeader::upperL2TrigPattern</a></div><div class="ttdeci">UShort_t upperL2TrigPattern</div><div class="ttdoc">Bit mask for upper ring l2 cluster triggers. eg. if the bit 1 (the lowest bit) is active it means the...</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d0f/_raw_anita_header_8h_source.html#l00169">RawAnitaHeader.h:169</a></div></div>
<div class="ttc" id="class_anita_html_af367aa78f54d08086f0f9c283ee3105e"><div class="ttname"><a href="../../df/da2/class_anita.html#af367aa78f54d08086f0f9c283ee3105e">Anita::NPHI_MAX</a></div><div class="ttdeci">static const int NPHI_MAX</div><div class="ttdoc">max number of antennas around in phi (in smex, 16) </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d52/anita_8hh_source.html#l00061">anita.hh:61</a></div></div>
<div class="ttc" id="namespace_anita_pol_html_af98f5337ced6b7416f396f5ae76a14d7ad43edda04c9c2e92af2204d77cf0278d"><div class="ttname"><a href="../../d4/df7/namespace_anita_pol.html#af98f5337ced6b7416f396f5ae76a14d7ad43edda04c9c2e92af2204d77cf0278d">AnitaPol::kHorizontal</a></div><div class="ttdoc">Horizontal Polarisation. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df8/_anita_conventions_8h_source.html#l00197">AnitaConventions.h:197</a></div></div>
<div class="ttc" id="class_adu5_pat_html_a8aca444bcebad17c7645ec7d65afb7e4"><div class="ttname"><a href="../../d2/dbf/class_adu5_pat.html#a8aca444bcebad17c7645ec7d65afb7e4">Adu5Pat::heading</a></div><div class="ttdeci">Float_t heading</div><div class="ttdoc">0 is facing north, 180 is facing south </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d8e/_adu5_pat_8h_source.html#l00045">Adu5Pat.h:45</a></div></div>
<div class="ttc" id="class_counting_html"><div class="ttname"><a href="../../d4/de2/class_counting.html">Counting</a></div><div class="ttdoc">Handles event counting as cuts are made. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d84/counting_8hh_source.html#l00010">counting.hh:10</a></div></div>
<div class="ttc" id="class_raw_anita_header_html_a057c7366e4ef9e485adc55860eedad2b"><div class="ttname"><a href="../../d0/dc4/class_raw_anita_header.html#a057c7366e4ef9e485adc55860eedad2b">RawAnitaHeader::realTime</a></div><div class="ttdeci">UInt_t realTime</div><div class="ttdoc">unixTime of readout </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d0f/_raw_anita_header_8h_source.html#l00046">RawAnitaHeader.h:46</a></div></div>
<div class="ttc" id="class_r_x_html"><div class="ttname"><a href="../../df/d22/class_r_x.html">RX</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/d57/rx_8hpp_source.html#l00023">rx.hpp:23</a></div></div>
<div class="ttc" id="class_raw_anita_header_html_a42809439d87cd10df266839871d2437b"><div class="ttname"><a href="../../d0/dc4/class_raw_anita_header.html#a42809439d87cd10df266839871d2437b">RawAnitaHeader::nadirL1TrigPattern</a></div><div class="ttdeci">UChar_t nadirL1TrigPattern</div><div class="ttdoc">8-bit trigger mask for L1 nadir triggers. Here bit 1 is antenna 33 (phi 1), bit 2 is antenna 34 (phi ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d0f/_raw_anita_header_8h_source.html#l00174">RawAnitaHeader.h:174</a></div></div>
<div class="ttc" id="class_anita_geom_tool_html_a1082689d96e9b03316b7625a9de37b44"><div class="ttname"><a href="../../d8/db1/class_anita_geom_tool.html#a1082689d96e9b03316b7625a9de37b44">AnitaGeomTool::Instance</a></div><div class="ttdeci">static AnitaGeomTool * Instance(int anita_version=0)</div><div class="ttdoc">Instance generator. If version_number == 0, uses AnitaVersion::get();. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d67/_anita_geom_tool_8cxx_source.html#l00431">AnitaGeomTool.cxx:431</a></div></div>
<div class="ttc" id="class_anita_geom_tool_html"><div class="ttname"><a href="../../d8/db1/class_anita_geom_tool.html">AnitaGeomTool</a></div><div class="ttdoc">AnitaGeomTool  The ANITA Geometry Tool. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/de8/_anita_geom_tool_8h_source.html#l00048">AnitaGeomTool.h:48</a></div></div>
<div class="ttc" id="class_truth_anita_event_html_a3a12546b0d51a79bfda21a5241cf6a35"><div class="ttname"><a href="../../d7/dd8/class_truth_anita_event.html#a3a12546b0d51a79bfda21a5241cf6a35">TruthAnitaEvent::eventNumber</a></div><div class="ttdeci">UInt_t eventNumber</div><div class="ttdoc">Software event number. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc7/_truth_anita_event_8h_source.html#l00034">TruthAnitaEvent.h:34</a></div></div>
<div class="ttc" id="class_truth_anita_event_html_afe9ea8167426bdf6806a7aff3fa677b7"><div class="ttname"><a href="../../d7/dd8/class_truth_anita_event.html#afe9ea8167426bdf6806a7aff3fa677b7">TruthAnitaEvent::nuPos</a></div><div class="ttdeci">Double_t nuPos[3]</div><div class="ttdoc">Neutrino position. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc7/_truth_anita_event_8h_source.html#l00038">TruthAnitaEvent.h:38</a></div></div>
<div class="ttc" id="class_ray_html"><div class="ttname"><a href="../../d2/d1f/class_ray.html">Ray</a></div><div class="ttdoc">Ray tracing. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da4/ray_8hh_source.html#l00020">ray.hh:20</a></div></div>
<div class="ttc" id="class_truth_anita_event_html_ac84b5c53e71e67af1dcd64809d929f4d"><div class="ttname"><a href="../../d7/dd8/class_truth_anita_event.html#ac84b5c53e71e67af1dcd64809d929f4d">TruthAnitaEvent::hitangle_e</a></div><div class="ttdeci">Double_t hitangle_e[48]</div><div class="ttdoc">Hit angles rel. to e plane stored for each antenna. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc7/_truth_anita_event_8h_source.html#l00053">TruthAnitaEvent.h:53</a></div></div>
<div class="ttc" id="class_truth_anita_event_html_a54781617ba9086e115ea859a4fbd86ff"><div class="ttname"><a href="../../d7/dd8/class_truth_anita_event.html#a54781617ba9086e115ea859a4fbd86ff">TruthAnitaEvent::run</a></div><div class="ttdeci">Int_t run</div><div class="ttdoc">Run number. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc7/_truth_anita_event_8h_source.html#l00032">TruthAnitaEvent.h:32</a></div></div>
<div class="ttc" id="class_raw_anita_header_html_a055774db95517a74290a7735576beeef"><div class="ttname"><a href="../../d0/dc4/class_raw_anita_header.html#a055774db95517a74290a7735576beeef">RawAnitaHeader::trigType</a></div><div class="ttdeci">UChar_t trigType</div><div class="ttdoc">Bit 0 is RF, 1 is ADU5, 2 is G12, 3 is software/external. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d0f/_raw_anita_header_8h_source.html#l00148">RawAnitaHeader.h:148</a></div></div>
<div class="ttc" id="class_raw_anita_header_html_aff1b80a19465ac1784e336e0023573f6"><div class="ttname"><a href="../../d0/dc4/class_raw_anita_header.html#aff1b80a19465ac1784e336e0023573f6">RawAnitaHeader::triggerTime</a></div><div class="ttdeci">UInt_t triggerTime</div><div class="ttdoc">Trigger time from TURF converted to unixTime. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d0f/_raw_anita_header_8h_source.html#l00176">RawAnitaHeader.h:176</a></div></div>
<div class="ttc" id="class_truth_anita_event_html_a26f272fa6d96cf9f2bca78b9d0662b63"><div class="ttname"><a href="../../d7/dd8/class_truth_anita_event.html#a26f272fa6d96cf9f2bca78b9d0662b63">TruthAnitaEvent::balloonDir</a></div><div class="ttdeci">Double_t balloonDir[3]</div><div class="ttdoc">Balloon direction. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc7/_truth_anita_event_8h_source.html#l00037">TruthAnitaEvent.h:37</a></div></div>
<div class="ttc" id="class_ice_model_html"><div class="ttname"><a href="../../de/d63/class_ice_model.html">IceModel</a></div><div class="ttdoc">Ice thicknesses and water depth. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dee/icemodel_8hh_source.html#l00103">icemodel.hh:103</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Apr 5 2021 19:55:41 for ANITA Software by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
